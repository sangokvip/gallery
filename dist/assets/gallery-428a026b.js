import{$ as ir,a0 as cr,r as n,a1 as _t,a2 as dr,a3 as xt,a4 as ur,w as ue,a5 as pr,a6 as fr,_ as R,U as Rt,a7 as hr,t as we,s as Ie,a8 as fe,j as e,u as ne,P as Fe,z as pe,G as gt,E as mt,v as Me,I as N,x as $e,y as ze,a9 as xr,aa as Pt,ab as gr,ac as mr,F as br,ad as vr,Y as q,Z as G,ae as yr,M as bt,af as Cr,ag as De,N as Ae,ah as Le,c as jr,R as Ft,B as k,b as K,e as H,T as Sr,A as kr,C as vt,a as wr,d as _e,f as yt,g as Ir,D as Mr,L as $r,h as me,i as be,k as ve,S as zr,p as _r,l as Ue,m as Ne,n as Ve,o as Ye,ai as Rr,q as Pr}from"./pixel-theme-2ec75c86.js";import{g as X,v as We,d as Ct,D as Fr,c as Dt,F as Dr,I as Ar,C as ye,T as Ce,a as Oe,b as Lr}from"./v4-90c90607.js";import{d as jt,a as qe,M as Ee}from"./Message-1b674550.js";import{d as St}from"./Female-a39f5a68.js";import{d as kt}from"./Male-a576a373.js";function Or(t,r,a,o,s){const[i,u]=n.useState(()=>s&&a?a(t).matches:o?o(t).matches:r);return _t(()=>{let m=!0;if(!a)return;const f=a(t),d=()=>{m&&u(f.matches)};return d(),f.addListener(d),()=>{m=!1,f.removeListener(d)}},[t,a]),i}const At=dr["useSyncExternalStore"];function Er(t,r,a,o,s){const i=n.useCallback(()=>r,[r]),u=n.useMemo(()=>{if(s&&a)return()=>a(t).matches;if(o!==null){const{matches:h}=o(t);return()=>h}return i},[i,t,o,s,a]),[m,f]=n.useMemo(()=>{if(a===null)return[i,()=>()=>{}];const h=a(t);return[()=>h.matches,j=>(h.addListener(j),()=>{h.removeListener(j)})]},[i,a,t]);return At(f,m,u)}function Re(t,r={}){const a=ir(),o=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:s=!1,matchMedia:i=o?window.matchMedia:null,ssrMatchMedia:u=null,noSsr:m=!1}=cr({name:"MuiUseMediaQuery",props:r,theme:a});let f=typeof t=="function"?t(a):t;return f=f.replace(/^@media( ?)/m,""),(At!==void 0?Er:Or)(f,s,i,u,m)}function Br(t,r=0,a=1){return ur(t,r,a)}function Wr(t){t=t.slice(1);const r=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let a=t.match(r);return a&&a[0].length===1&&(a=a.map(o=>o+o)),a?`rgb${a.length===4?"a":""}(${a.map((o,s)=>s<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function Lt(t){if(t.type)return t;if(t.charAt(0)==="#")return Lt(Wr(t));const r=t.indexOf("("),a=t.substring(0,r);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error(xt(9,t));let o=t.substring(r+1,t.length-1),s;if(a==="color"){if(o=o.split(" "),s=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(xt(10,s))}else o=o.split(",");return o=o.map(i=>parseFloat(i)),{type:a,values:o,colorSpace:s}}function Tr(t){const{type:r,colorSpace:a}=t;let{values:o}=t;return r.indexOf("rgb")!==-1?o=o.map((s,i)=>i<3?parseInt(s,10):s):r.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),r.indexOf("color")!==-1?o=`${a} ${o.join(" ")}`:o=`${o.join(", ")}`,`${r}(${o})`}function Hr(t,r){return t=Lt(t),r=Br(r),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${r}`:t.values[3]=r,Tr(t)}const Ur=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Nr=["component","slots","slotProps"],Vr=["component"];function wt(t,r){const{className:a,elementType:o,ownerState:s,externalForwardedProps:i,getSlotOwnerState:u,internalForwardedProps:m}=r,f=ue(r,Ur),{component:d,slots:h={[t]:void 0},slotProps:j={[t]:void 0}}=i,A=ue(i,Nr),L=h[t]||o,$=pr(j[t],s),D=fr(R({className:a},f,{externalForwardedProps:t==="root"?A:void 0,externalSlotProps:$})),{props:{component:P},internalRef:O}=D,g=ue(D.props,Vr),Z=Rt(O,$==null?void 0:$.ref,r.ref),l=u?u(g):{},x=R({},s,l),b=t==="root"?P||d:P,p=hr(L,R({},t==="root"&&!d&&!h[t]&&m,t!=="root"&&!h[t]&&m,g,b&&{as:b},{ref:Z}),x);return Object.keys(l).forEach(S=>{delete p[S]}),[L,p]}function Yr(t){return Ie("MuiAlert",t)}const qr=we("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),It=qr,Gr=fe(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Zr=fe(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Qr=fe(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Xr=fe(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),Kr=fe(e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Jr=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],eo=t=>{const{variant:r,color:a,severity:o,classes:s}=t,i={root:["root",`color${pe(a||o)}`,`${r}${pe(a||o)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return ze(i,Yr,s)},to=ne(Fe,{name:"MuiAlert",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:a}=t;return[r.root,r[a.variant],r[`${a.variant}${pe(a.color||a.severity)}`]]}})(({theme:t})=>{const r=t.palette.mode==="light"?gt:mt,a=t.palette.mode==="light"?mt:gt;return R({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,o])=>o.main&&o.light).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:r(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${o}StandardBg`]:a(t.palette[o].light,.9),[`& .${It.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(([,o])=>o.main&&o.light).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:r(t.palette[o].light,.6),border:`1px solid ${(t.vars||t).palette[o].light}`,[`& .${It.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(([,o])=>o.main&&o.dark).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:R({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${o}FilledColor`],backgroundColor:t.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)})}))]})}),ro=ne("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,r)=>r.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),oo=ne("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,r)=>r.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),Mt=ne("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,r)=>r.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),$t={success:e.jsx(Gr,{fontSize:"inherit"}),warning:e.jsx(Zr,{fontSize:"inherit"}),error:e.jsx(Qr,{fontSize:"inherit"}),info:e.jsx(Xr,{fontSize:"inherit"})},ao=n.forwardRef(function(r,a){const o=Me({props:r,name:"MuiAlert"}),{action:s,children:i,className:u,closeText:m="Close",color:f,components:d={},componentsProps:h={},icon:j,iconMapping:A=$t,onClose:L,role:$="alert",severity:D="success",slotProps:P={},slots:O={},variant:g="standard"}=o,Z=ue(o,Jr),l=R({},o,{color:f,severity:D,variant:g,colorSeverity:f||D}),x=eo(l),b={slots:R({closeButton:d.CloseButton,closeIcon:d.CloseIcon},O),slotProps:R({},h,P)},[p,S]=wt("closeButton",{elementType:N,externalForwardedProps:b,ownerState:l}),[C,_]=wt("closeIcon",{elementType:Kr,externalForwardedProps:b,ownerState:l});return e.jsxs(to,R({role:$,elevation:0,ownerState:l,className:$e(x.root,u),ref:a},Z,{children:[j!==!1?e.jsx(ro,{ownerState:l,className:x.icon,children:j||A[D]||$t[D]}):null,e.jsx(oo,{ownerState:l,className:x.message,children:i}),s!=null?e.jsx(Mt,{ownerState:l,className:x.action,children:s}):null,s==null&&L?e.jsx(Mt,{ownerState:l,className:x.action,children:e.jsx(p,R({size:"small","aria-label":m,title:m,color:"inherit",onClick:L},S,{children:e.jsx(C,R({fontSize:"small"},_))}))}):null]}))}),so=ao;function no(t){return Ie("MuiCard",t)}we("MuiCard",["root"]);const lo=["className","raised"],io=t=>{const{classes:r}=t;return ze({root:["root"]},no,r)},co=ne(Fe,{name:"MuiCard",slot:"Root",overridesResolver:(t,r)=>r.root})(()=>({overflow:"hidden"})),uo=n.forwardRef(function(r,a){const o=Me({props:r,name:"MuiCard"}),{className:s,raised:i=!1}=o,u=ue(o,lo),m=R({},o,{raised:i}),f=io(m);return e.jsx(co,R({className:$e(f.root,s),elevation:i?8:void 0,ref:a,ownerState:m},u))}),po=uo;function fo(t){return Ie("PrivateSwitchBase",t)}we("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const ho=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],xo=t=>{const{classes:r,checked:a,disabled:o,edge:s}=t,i={root:["root",a&&"checked",o&&"disabled",s&&`edge${pe(s)}`],input:["input"]};return ze(i,fo,r)},go=ne(xr)(({ownerState:t})=>R({padding:9,borderRadius:"50%"},t.edge==="start"&&{marginLeft:t.size==="small"?-3:-12},t.edge==="end"&&{marginRight:t.size==="small"?-3:-12})),mo=ne("input",{shouldForwardProp:Pt})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),bo=n.forwardRef(function(r,a){const{autoFocus:o,checked:s,checkedIcon:i,className:u,defaultChecked:m,disabled:f,disableFocusRipple:d=!1,edge:h=!1,icon:j,id:A,inputProps:L,inputRef:$,name:D,onBlur:P,onChange:O,onFocus:g,readOnly:Z,required:l=!1,tabIndex:x,type:b,value:p}=r,S=ue(r,ho),[C,_]=gr({controlled:s,default:!!m,name:"SwitchBase",state:"checked"}),z=mr(),ee=B=>{g&&g(B),z&&z.onFocus&&z.onFocus(B)},T=B=>{P&&P(B),z&&z.onBlur&&z.onBlur(B)},V=B=>{if(B.nativeEvent.defaultPrevented)return;const te=B.target.checked;_(te),O&&O(B,te)};let E=f;z&&typeof E>"u"&&(E=z.disabled);const ae=b==="checkbox"||b==="radio",y=R({},r,{checked:C,disabled:E,disableFocusRipple:d,edge:h}),Y=xo(y);return e.jsxs(go,R({component:"span",className:$e(Y.root,u),centerRipple:!0,focusRipple:!d,disabled:E,tabIndex:null,role:void 0,onFocus:ee,onBlur:T,ownerState:y,ref:a},S,{children:[e.jsx(mo,R({autoFocus:o,checked:s,defaultChecked:m,className:Y.input,disabled:E,id:ae?A:void 0,name:D,onChange:V,readOnly:Z,ref:$,required:l,ownerState:y,tabIndex:x,type:b},b==="checkbox"&&p===void 0?{}:{value:p},L)),C?i:j]}))}),vo=bo,yo=fe(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Co=fe(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),jo=fe(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function So(t){return Ie("MuiCheckbox",t)}const ko=we("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Be=ko,wo=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Io=t=>{const{classes:r,indeterminate:a,color:o,size:s}=t,i={root:["root",a&&"indeterminate",`color${pe(o)}`,`size${pe(s)}`]},u=ze(i,So,r);return R({},r,u)},Mo=ne(vo,{shouldForwardProp:t=>Pt(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:a}=t;return[r.root,a.indeterminate&&r.indeterminate,r[`size${pe(a.size)}`],a.color!=="default"&&r[`color${pe(a.color)}`]]}})(({theme:t,ownerState:r})=>R({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${r.color==="default"?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:br(r.color==="default"?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},r.color!=="default"&&{[`&.${Be.checked}, &.${Be.indeterminate}`]:{color:(t.vars||t).palette[r.color].main},[`&.${Be.disabled}`]:{color:(t.vars||t).palette.action.disabled}})),$o=e.jsx(Co,{}),zo=e.jsx(yo,{}),_o=e.jsx(jo,{}),Ro=n.forwardRef(function(r,a){var o,s;const i=Me({props:r,name:"MuiCheckbox"}),{checkedIcon:u=$o,color:m="primary",icon:f=zo,indeterminate:d=!1,indeterminateIcon:h=_o,inputProps:j,size:A="medium",className:L}=i,$=ue(i,wo),D=d?h:f,P=d?h:u,O=R({},i,{color:m,indeterminate:d,size:A}),g=Io(O);return e.jsx(Mo,R({type:"checkbox",inputProps:R({"data-indeterminate":d},j),icon:n.cloneElement(D,{fontSize:(o=D.props.fontSize)!=null?o:A}),checkedIcon:n.cloneElement(P,{fontSize:(s=P.props.fontSize)!=null?s:A}),ownerState:O,ref:a,className:$e(g.root,L)},$,{classes:g}))}),Po=Ro,Fo=(t,r)=>R({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},r&&!t.vars&&{colorScheme:t.palette.mode}),Do=t=>R({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),Ao=(t,r=!1)=>{var a;const o={};r&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([u,m])=>{var f;o[t.getColorSchemeSelector(u).replace(/\s*&/,"")]={colorScheme:(f=m.palette)==null?void 0:f.mode}});let s=R({html:Fo(t,r),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:R({margin:0},Do(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},o);const i=(a=t.components)==null||(a=a.MuiCssBaseline)==null?void 0:a.styleOverrides;return i&&(s=[s,i]),s};function Lo(t){const r=Me({props:t,name:"MuiCssBaseline"}),{children:a,enableColorScheme:o=!1}=r;return e.jsxs(n.Fragment,{children:[e.jsx(vr,{styles:s=>Ao(s,o)}),a]})}var Ge={},Oo=G;Object.defineProperty(Ge,"__esModule",{value:!0});var Ot=Ge.default=void 0,Eo=Oo(q()),Bo=e;Ot=Ge.default=(0,Eo.default)((0,Bo.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info");var Ze={},Wo=G;Object.defineProperty(Ze,"__esModule",{value:!0});var Pe=Ze.default=void 0,To=Wo(q()),Ho=e;Pe=Ze.default=(0,To.default)((0,Ho.jsx)("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8zM5 19l3-4 2 3 3-4 4 5z"}),"AddPhotoAlternate");var Qe={},Uo=G;Object.defineProperty(Qe,"__esModule",{value:!0});var Et=Qe.default=void 0,No=Uo(q()),Vo=e;Et=Qe.default=(0,No.default)((0,Vo.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");var Xe={},Yo=G;Object.defineProperty(Xe,"__esModule",{value:!0});var Bt=Xe.default=void 0,qo=Yo(q()),zt=e;Bt=Xe.default=(0,qo.default)([(0,zt.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),(0,zt.jsx)("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")],"ZoomIn");var Ke={},Go=G;Object.defineProperty(Ke,"__esModule",{value:!0});var Je=Ke.default=void 0,Zo=Go(q()),Qo=e;Je=Ke.default=(0,Zo.default)((0,Qo.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var et={},Xo=G;Object.defineProperty(et,"__esModule",{value:!0});var Wt=et.default=void 0,Ko=Xo(q()),Jo=e;Wt=et.default=(0,Ko.default)((0,Jo.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel");var tt={},ea=G;Object.defineProperty(tt,"__esModule",{value:!0});var Tt=tt.default=void 0,ta=ea(q()),ra=e;Tt=tt.default=(0,ta.default)((0,ra.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");var rt={},oa=G;Object.defineProperty(rt,"__esModule",{value:!0});var Ht=rt.default=void 0,aa=oa(q()),sa=e;Ht=rt.default=(0,aa.default)((0,sa.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var ot={},na=G;Object.defineProperty(ot,"__esModule",{value:!0});var Ut=ot.default=void 0,la=na(q()),ia=e;Ut=ot.default=(0,la.default)((0,ia.jsx)("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"}),"RestartAlt");var at={},ca=G;Object.defineProperty(at,"__esModule",{value:!0});var Nt=at.default=void 0,da=ca(q()),ua=e;Nt=at.default=(0,da.default)((0,ua.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var st={},pa=G;Object.defineProperty(st,"__esModule",{value:!0});var Vt=st.default=void 0,fa=pa(q()),ha=e;Vt=st.default=(0,fa.default)((0,ha.jsx)("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"CheckBoxOutlineBlank");var nt={},xa=G;Object.defineProperty(nt,"__esModule",{value:!0});var Yt=nt.default=void 0,ga=xa(q()),ma=e;Yt=nt.default=(0,ga.default)((0,ma.jsx)("path",{d:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3zM14 5h-3l-1-1H6L5 5H2v2h12z"}),"DeleteSweep");function ba(t){return Ie("MuiMasonry",t)}we("MuiMasonry",["root"]);const va=["children","className","component","columns","spacing","sequential","defaultColumns","defaultHeight","defaultSpacing"],de=t=>Number(t.replace("px","")),ya={flexBasis:"100%",width:0,margin:0,padding:0},Ca=t=>{const{classes:r}=t;return ze({root:["root"]},ba,r)},ja=({ownerState:t,theme:r})=>{let a={width:"100%",display:"flex",flexFlow:"column wrap",alignContent:"flex-start",boxSizing:"border-box","& > *":{boxSizing:"border-box"}};const o={};if(t.isSSR){const d={},h=de(r.spacing(t.defaultSpacing));for(let j=1;j<=t.defaultColumns;j+=1)d[`&:nth-of-type(${t.defaultColumns}n+${j%t.defaultColumns})`]={order:j};return o.height=t.defaultHeight,o.margin=-(h/2),o["& > *"]=R({},a["& > *"],d,{margin:h/2,width:`calc(${(100/t.defaultColumns).toFixed(2)}% - ${h}px)`}),R({},a,o)}const s=bt({values:t.spacing,breakpoints:r.breakpoints.values}),i=Cr(r);a=De(a,Ae({theme:r},s,d=>{let h;if(typeof d=="string"&&!Number.isNaN(Number(d))||typeof d=="number"){const j=Number(d);h=Le(i,j)}else h=d;return R({margin:`calc(0px - (${h} / 2))`,"& > *":{margin:`calc(${h} / 2)`}},t.maxColumnHeight&&{height:typeof h=="number"?Math.ceil(t.maxColumnHeight+de(h)):`calc(${t.maxColumnHeight}px + ${h})`})}));const m=bt({values:t.columns,breakpoints:r.breakpoints.values});return a=De(a,Ae({theme:r},m,d=>{const j=`${(100/Number(d)).toFixed(2)}%`,A=typeof s=="string"&&!Number.isNaN(Number(s))||typeof s=="number"?Le(i,Number(s)):"0px";return{"& > *":{width:`calc(${j} - ${A})`}}})),typeof s=="object"&&(a=De(a,Ae({theme:r},s,(d,h)=>{if(h){const j=Number(d),A=Object.keys(m).pop(),L=Le(i,j);return{"& > *":{width:`calc(${`${(100/(typeof m=="object"?m[h]||m[A]:m)).toFixed(2)}%`} - ${L})`}}}return null}))),a},Sa=ne("div",{name:"MuiMasonry",slot:"Root",overridesResolver:(t,r)=>[r.root]})(ja),ka=n.forwardRef(function(r,a){const o=Me({props:r,name:"MuiMasonry"}),{children:s,className:i,component:u="div",columns:m=4,spacing:f=1,sequential:d=!1,defaultColumns:h,defaultHeight:j,defaultSpacing:A}=o,L=ue(o,va),$=n.useRef(),[D,P]=n.useState(),O=!D&&j&&h!==void 0&&A!==void 0,[g,Z]=n.useState(O?h-1:0),l=R({},o,{spacing:f,columns:m,maxColumnHeight:D,defaultColumns:h,defaultHeight:j,defaultSpacing:A,isSSR:O}),x=Ca(l),b=n.useCallback(C=>{if(!$.current||!C||C.length===0)return;const _=$.current,z=$.current.firstChild,ee=_.clientWidth,T=z.clientWidth;if(ee===0||T===0)return;const V=window.getComputedStyle(z),E=de(V.marginLeft),ae=de(V.marginRight),y=Math.round(ee/(T+E+ae)),Y=new Array(y).fill(0);let B=!1,te=1;_.childNodes.forEach(U=>{if(U.nodeType!==Node.ELEMENT_NODE||U.dataset.class==="line-break"||B)return;const re=window.getComputedStyle(U),xe=de(re.marginTop),le=de(re.marginBottom),se=de(re.height)?Math.ceil(de(re.height))+xe+le:0;if(se===0){B=!0;return}for(let w=0;w<U.childNodes.length;w+=1){const M=U.childNodes[w];if(M.tagName==="IMG"&&M.clientHeight===0){B=!0;break}}if(!B)if(d)Y[te-1]+=se,U.style.order=te,te+=1,te>y&&(te=1);else{const w=Y.indexOf(Math.min(...Y));Y[w]+=se;const M=w+1;U.style.order=M}}),B||yr.flushSync(()=>{P(Math.max(...Y)),Z(y>0?y-1:0)})},[d]);_t(()=>{if(typeof ResizeObserver>"u")return;let C;const _=new ResizeObserver(()=>{C=requestAnimationFrame(b)});return $.current&&$.current.childNodes.forEach(z=>{_.observe(z)}),()=>{C&&window.cancelAnimationFrame(C),_&&_.disconnect()}},[m,f,s,b]);const p=Rt(a,$),S=new Array(g).fill("").map((C,_)=>e.jsx("span",{"data-class":"line-break",style:R({},ya,{order:_+1})},_));return e.jsxs(Sa,R({as:u,className:$e(x.root,i),ref:p,ownerState:l},L,{children:[s,S]}))}),wa=ka;var lt={},Ia=G;Object.defineProperty(lt,"__esModule",{value:!0});var qt=lt.default=void 0,Ma=Ia(q()),$a=e;qt=lt.default=(0,Ma.default)((0,$a.jsx)("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"}),"ThumbUp");var it={},za=G;Object.defineProperty(it,"__esModule",{value:!0});var Gt=it.default=void 0,_a=za(q()),Ra=e;Gt=it.default=(0,_a.default)((0,Ra.jsx)("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m4 0v12h4V3z"}),"ThumbDown");var ct={},Pa=G;Object.defineProperty(ct,"__esModule",{value:!0});var Te=ct.default=void 0,Fa=Pa(q()),Da=e;Te=ct.default=(0,Fa.default)((0,Da.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");var dt={},Aa=G;Object.defineProperty(dt,"__esModule",{value:!0});var He=dt.default=void 0,La=Aa(q()),Oa=e;He=dt.default=(0,La.default)((0,Oa.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward");var ut={},Ea=G;Object.defineProperty(ut,"__esModule",{value:!0});var Zt=ut.default=void 0,Ba=Ea(q()),Wa=e;Zt=ut.default=(0,Ba.default)((0,Wa.jsx)("path",{d:"M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2m2 10H3v4c0 1.1.9 2 2 2h4v-2H5zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2"}),"CropFree");const ke=jr({palette:{primary:{main:"#f97316",light:"#fb923c",dark:"#ea580c"},secondary:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},background:{default:"#fffbf5",paper:"#ffffff"},text:{primary:"#111827",secondary:"#4b5563"},accent:{pink:"#ec4899",green:"#10b981",yellow:"#f59e0b",red:"#ef4444"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},info:{main:"#f97316",light:"#fb923c",dark:"#ea580c"},success:{main:"#10b981",light:"#34d399",dark:"#059669"}},typography:{fontFamily:'"Inter", "SF Pro Display", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,letterSpacing:"-0.025em"},h2:{fontWeight:700,letterSpacing:"-0.025em"},h3:{fontWeight:600,letterSpacing:"-0.025em"},h4:{fontWeight:600,letterSpacing:"-0.025em"},h5:{fontWeight:600,letterSpacing:"-0.025em"},h6:{fontWeight:600,letterSpacing:"-0.025em"},button:{fontWeight:500,textTransform:"none"},body1:{fontSize:"1rem",lineHeight:1.5},body2:{fontSize:"0.875rem",lineHeight:1.5}},shape:{borderRadius:12},shadows:["none","0 1px 2px 0 rgba(0, 0, 0, 0.05)","0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)","0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)","0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)","0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)"],components:{MuiPaper:{styleOverrides:{root:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out","&:hover":{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"}}}},MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 16px",transition:"all 0.2s ease",fontWeight:500},contained:{boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)","&:hover":{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transform:"translateY(-1px)"},"&:active":{boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",transform:"translateY(1px)"}},outlined:{borderWidth:"1.5px","&:hover":{borderWidth:"1.5px",transform:"translateY(-1px)"}}}},MuiCard:{styleOverrides:{root:{overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"}}}},MuiIconButton:{styleOverrides:{root:{borderRadius:8,transition:"all 0.2s ease","&:hover":{backgroundColor:Hr("#2563eb",.08),transform:"translateY(-1px)"}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8,transition:"all 0.2s ease","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#60a5fa"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderWidth:2}}}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)"}}},MuiChip:{styleOverrides:{root:{borderRadius:8,fontWeight:500}}},MuiAlert:{styleOverrides:{root:{borderRadius:8}}},MuiLink:{styleOverrides:{root:{textDecoration:"none",transition:"color 0.2s ease",fontWeight:500,"&:hover":{textDecoration:"underline"}}}}}}),Ta=`
  @keyframes titleGlow {
    0% {
      text-shadow: 0 0 5px rgba(37, 99, 235, 0.5),
                   0 0 10px rgba(37, 99, 235, 0.3),
                   0 0 15px rgba(37, 99, 235, 0.2);
    }
    50% {
      text-shadow: 0 0 10px rgba(37, 99, 235, 0.8),
                   0 0 20px rgba(37, 99, 235, 0.5),
                   0 0 30px rgba(37, 99, 235, 0.3);
    }
    100% {
      text-shadow: 0 0 5px rgba(37, 99, 235, 0.5),
                   0 0 10px rgba(37, 99, 235, 0.3),
                   0 0 15px rgba(37, 99, 235, 0.2);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes pulse {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.9;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  .main-title {
    position: relative;
    display: inline-block;
    background: linear-gradient(45deg, #2563eb, #8b5cf6);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    animation: titleGlow 3s ease-in-out infinite;
    letter-spacing: -0.025em;
  }

  .fade-in {
    animation: fadeIn 0.5s ease-out forwards;
  }
  
  .image-loading {
    opacity: 0;
    transform: scale(0.98);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  
  .image-loaded {
    opacity: 1;
    transform: scale(1);
  }
  
  .hover-scale {
    transition: transform 0.3s ease;
  }
  
  .hover-scale:hover {
    transform: scale(1.03);
  }
  
  .pulse-animation {
    animation: pulse 2s infinite;
  }
`,pt=document.createElement("style");pt.type="text/css";pt.innerText=Ta;document.head.appendChild(pt);const Ha=({image:t,onView:r,onDelete:a,onEdit:o,isAdmin:s,isSelected:i,isSelectionMode:u,onSelect:m,userId:f})=>{const[d,h]=n.useState(null),[j,A]=n.useState(!1),[L,$]=n.useState(!1);n.useState(!1);const[D,P]=n.useState(t.likes_count||0),[O,g]=n.useState(t.dislikes_count||0),[Z,l]=n.useState(!1),[x,b]=n.useState({width:0,height:0}),[p,S]=n.useState(!1),[C,_]=n.useState(!1),[z,ee]=n.useState(!1),[T,V]=n.useState(!1),E=t.image_url||(t.image_path?X.storage.from("gallery").getPublicUrl(t.image_path).data.publicUrl:""),ae=t.user_id===f;n.useEffect(()=>{f&&(async()=>{try{const M=await X.getImageVoteStatus(t.id,f);M!==null&&h(M)}catch(M){console.error("获取投票状态失败:",M)}})()},[t.id,f]);const y=async w=>{if(w.stopPropagation(),!p)try{S(!0);const M=await X.updateImageLikes(t.id,f,!0);M.action==="added"?(P(W=>W+1),h(!0)):M.action==="removed"?(P(W=>W-1),h(null)):M.action==="changed"&&(P(W=>W+1),g(W=>W-1),h(!0))}catch(M){console.error("点赞失败:",M)}finally{S(!1)}},Y=async w=>{if(w.stopPropagation(),!p)try{S(!0);const M=await X.updateImageLikes(t.id,f,!1);M.action==="added"?(g(W=>W+1),h(!1)):M.action==="removed"?(g(W=>W-1),h(null)):M.action==="changed"&&(g(W=>W+1),P(W=>W-1),h(!1))}catch(M){console.error("点踩失败:",M)}finally{S(!1)}},B=async()=>{try{S(!0),await X.adminUpdateVotes(t.id,D,O),P(D),g(O),_(!1),setSnackbarMessage("点赞数量已更新"),setSnackbarSeverity("success"),setSnackbarOpen(!0)}catch(w){console.error("更新点赞数量失败:",w),setSnackbarMessage(w.message),setSnackbarSeverity("error"),setSnackbarOpen(!0)}finally{S(!1)}},te=s||t.user_id===f,U=w=>{const M=w.target,{naturalWidth:W,naturalHeight:ie}=M;b({width:W,height:ie}),l(ie>W*1.5),A(!0),$(!1)},re=async w=>{w.stopPropagation();try{await X.pinImage(t.id),window.location.reload()}catch(M){console.error("置顶失败:",M)}},xe=()=>{V(!0)},le=()=>{V(!1)},se=w=>{const M=new Date,W=new Date(w),ie=Math.floor((M-W)/1e3);if(ie<60)return`${ie}秒前`;const je=Math.floor(ie/60);if(je<60)return`${je}分钟前`;const ge=Math.floor(je/60);if(ge<24)return`${ge}小时前`;const Se=Math.floor(ge/24);if(Se<30)return`${Se}天前`;const ce=Math.floor(Se/30);return ce<12?`${ce}个月前`:`${Math.floor(ce/12)}年前`};return e.jsxs(po,{sx:{display:"flex",flexDirection:"column",width:"100%",borderRadius:"16px",overflow:"hidden",boxShadow:i?"0 0 0 3px #2563eb, 0 10px 15px -3px rgba(0, 0, 0, 0.1)":"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",opacity:u&&!i?.7:1,backgroundColor:"background.paper",transition:"all 0.3s ease",position:"relative",transform:T&&!u?"translateY(-8px)":"translateY(0)","&:hover":{boxShadow:i?"0 0 0 3px #2563eb, 0 20px 25px -5px rgba(0, 0, 0, 0.1)":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}},onMouseEnter:xe,onMouseLeave:le,children:[ae&&e.jsx(k,{sx:{position:"absolute",top:"12px",left:"12px",backgroundColor:"primary.main",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.75rem",fontWeight:"600",zIndex:2,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",border:"1.5px solid rgba(255,255,255,0.8)",animation:"pulse 2s infinite"},children:"我的图片"}),e.jsx(k,{sx:{position:"absolute",bottom:"12px",left:"12px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.7rem",fontWeight:"500",zIndex:2,opacity:T?1:0,transform:T?"translateY(0)":"translateY(8px)",transition:"all 0.3s ease"},children:se(t.created_at)}),e.jsxs(k,{sx:{position:"relative",width:"100%",paddingTop:Z?"140%":"100%",backgroundColor:"rgba(0, 0, 0, 0.05)",borderRadius:"12px 12px 0 0",overflow:"hidden",cursor:u?"default":"pointer"},onClick:()=>!u&&r(t),children:[!j&&!L&&e.jsx(k,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.03)"},children:e.jsx(ye,{size:30,sx:{color:"primary.main"}})}),e.jsx(k,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:C?"none":"auto"},children:e.jsx("img",{src:E,alt:t.title||"图片",onLoad:U,onError:()=>$(!0),className:j?"image-loaded":"image-loading",style:{width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.5s ease-out",transform:T&&!u?"scale(1.05)":"scale(1)"}})}),e.jsx(k,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:T?"linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.3) 30%, rgba(0,0,0,0) 60%)":"linear-gradient(0deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0) 40%)",opacity:1,transition:"all 0.3s ease"}}),e.jsx(k,{sx:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"16px",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:2},children:s&&C?e.jsxs(k,{sx:{display:"flex",gap:1,width:"100%"},children:[e.jsx(Ce,{size:"small",type:"number",value:D,onChange:w=>P(Math.max(0,parseInt(w.target.value)||0)),sx:{width:"70px","& .MuiInputBase-input":{color:"white",fontSize:"0.875rem",padding:"8px 12px"},"& .MuiOutlinedInput-root":{backgroundColor:"rgba(0, 0, 0, 0.4)","& fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused fieldset":{borderColor:"primary.main"}}}}),e.jsx(Ce,{size:"small",type:"number",value:O,onChange:w=>g(Math.max(0,parseInt(w.target.value)||0)),sx:{width:"70px","& .MuiInputBase-input":{color:"white",fontSize:"0.875rem",padding:"8px 12px"},"& .MuiOutlinedInput-root":{backgroundColor:"rgba(0, 0, 0, 0.4)","& fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused fieldset":{borderColor:"primary.main"}}}}),e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),B()},disabled:p,sx:{color:"success.main",bgcolor:"rgba(0, 0, 0, 0.4)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.6)"}},children:e.jsx(Je,{})}),e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),_(!1),P(t.likes_count||0),g(t.dislikes_count||0)},sx:{color:"error.main",bgcolor:"rgba(0, 0, 0, 0.4)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.6)"}},children:e.jsx(Wt,{})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(N,{size:"small",onClick:y,disabled:p,sx:{color:d===!0?"primary.light":"white",backgroundColor:d===!0?"rgba(37, 99, 235, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:d===!0?"rgba(37, 99, 235, 0.3)":"rgba(0, 0, 0, 0.5)"},width:36,height:36},children:e.jsx(qt,{sx:{fontSize:"1.2rem"}})}),e.jsx(K,{variant:"caption",sx:{color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:D})]}),e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(N,{size:"small",onClick:Y,disabled:p,sx:{color:d===!1?"error.light":"white",backgroundColor:d===!1?"rgba(239, 68, 68, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:d===!1?"rgba(239, 68, 68, 0.3)":"rgba(0, 0, 0, 0.5)"},width:36,height:36},children:e.jsx(Gt,{sx:{fontSize:"1.2rem"}})}),e.jsx(K,{variant:"caption",sx:{color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:O})]})]}),e.jsxs(k,{sx:{display:"flex",gap:1},children:[s&&e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),_(!0)},sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"},width:36,height:36},children:e.jsx(Oe,{sx:{fontSize:"1.2rem"}})}),te&&e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),o(t)},sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"},width:36,height:36,display:{xs:"none",sm:"flex"}},children:e.jsx(Oe,{sx:{fontSize:"1.2rem"}})}),s&&e.jsx(N,{size:"small",onClick:re,sx:{color:t.is_pinned?"warning.light":"white",backgroundColor:t.is_pinned?"rgba(245, 158, 11, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:t.is_pinned?"rgba(245, 158, 11, 0.3)":"rgba(0, 0, 0, 0.6)"},width:36,height:36},children:e.jsx(Lr,{sx:{fontSize:"1.2rem"}})})]})]})}),s&&!t.is_approved&&e.jsx(k,{sx:{position:"absolute",top:"12px",right:"12px",backgroundColor:"error.main",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.75rem",fontWeight:"600",zIndex:2,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"待审核"}),u&&e.jsx(Po,{checked:i,onChange:w=>m(t.id),sx:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:"4px",zIndex:3,"&.Mui-checked":{color:"primary.main"},"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"}}}),T&&!u&&(ae||s)&&e.jsxs(k,{sx:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:1,zIndex:3},children:[e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),o(t)},sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",color:"text.primary","&:hover":{backgroundColor:"white"},width:36,height:36,boxShadow:2},children:e.jsx(Oe,{fontSize:"small"})}),e.jsx(N,{size:"small",onClick:w=>{w.stopPropagation(),ee(!0)},sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",color:"error.main","&:hover":{backgroundColor:"white",color:"error.dark"},width:36,height:36,boxShadow:2},children:e.jsx(Dt,{fontSize:"small"})})]}),e.jsxs(Ue,{open:z,onClose:()=>ee(!1),PaperProps:{sx:{borderRadius:3,p:1,boxShadow:3,maxWidth:"400px",width:"90%"}},children:[e.jsx(Ne,{sx:{pb:1,fontWeight:600},children:"确认删除"}),e.jsx(Ve,{children:e.jsx(K,{variant:"body1",children:"确定要删除这张图片吗？此操作无法撤销。"})}),e.jsxs(Ye,{sx:{p:2,pt:1},children:[e.jsx(H,{onClick:()=>ee(!1),variant:"outlined",size:"medium",children:"取消"}),e.jsx(H,{onClick:()=>{ee(!1),a(t.id)},variant:"contained",color:"error",size:"medium",sx:{ml:1},children:"删除"})]})]})]})]})},Ua=({open:t,image:r,onClose:a,images:o,currentIndex:s,onPrevious:i,onNext:u})=>{const[m,f]=n.useState(1),[d,h]=n.useState(!0),[j,A]=n.useState(!0);n.useState(window.innerWidth<=768);const[L,$]=n.useState(null),[D,P]=n.useState(0),[O,g]=n.useState(!1),Z=n.useRef(null),{canShowPrevious:l,canShowNext:x}=n.useMemo(()=>({canShowPrevious:s>0,canShowNext:Array.isArray(o)&&s<o.length-1}),[s,o]),b=()=>{h(!1)},p=()=>{f(y=>Math.min(y+.2,3))},S=()=>{f(y=>Math.max(y-.2,.5))},C=()=>{f(1)},_=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),g(!1)):(document.documentElement.requestFullscreen().catch(y=>{console.error(`Error attempting to enable full-screen mode: ${y.message}`)}),g(!0))},z=y=>{P(y.touches[0].clientX)},ee=y=>{if(!D)return;const Y=y.touches[0].clientX,B=D-Y;B>50?$("left"):B<-50?$("right"):$(null)},T=()=>{L==="left"&&x?u==null||u():L==="right"&&l&&(i==null||i()),P(0),$(null)},V=n.useCallback(y=>{y.key==="ArrowLeft"?i==null||i():y.key==="ArrowRight"?u==null||u():y.key==="Escape"?a==null||a():y.key==="+"||y.key==="="?p():y.key==="-"?S():y.key==="0"?C():y.key==="f"&&_()},[i,u,a]);if(n.useEffect(()=>{if(t)return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[t,V]),n.useEffect(()=>{t&&(f(1),h(!0),g(!1))},[t,r]),n.useEffect(()=>{const y=()=>{g(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",y),()=>document.removeEventListener("fullscreenchange",y)},[]),!t||!r)return null;const E=(r==null?void 0:r.image_url)||(r!=null&&r.image_path?X.storage.from("gallery").getPublicUrl(r.image_path).data.publicUrl:null);if(!E)return null;const ae=y=>{if(!y)return"";const Y=new Date(y);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(Y)};return e.jsx(Rr,{open:t,onClose:a,closeAfterTransition:!0,sx:{display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)"},children:e.jsxs(k,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1300,display:"flex",flexDirection:"column",overflow:"hidden"},onMouseMove:()=>A(!0),onMouseLeave:()=>setTimeout(()=>A(!1),2e3),onClick:()=>A(!0),onTouchStart:z,onTouchMove:ee,onTouchEnd:T,children:[e.jsxs(k,{sx:{position:"absolute",top:0,left:0,right:0,padding:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(10px)",zIndex:5,transform:j?"translateY(0)":"translateY(-100%)",transition:"transform 0.3s ease"},children:[e.jsxs(K,{variant:"subtitle1",sx:{color:"white",fontWeight:600,fontSize:{xs:"0.9rem",sm:"1rem"},opacity:.9},children:[s+1," / ",(o==null?void 0:o.length)||1]}),e.jsxs(k,{sx:{display:"flex",gap:1},children:[e.jsx(N,{onClick:_,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:O?e.jsx(Zt,{}):e.jsx(Bt,{})}),e.jsx(N,{onClick:a,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(qe,{})})]})]}),e.jsxs(k,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},children:[e.jsx(k,{sx:{position:"absolute",top:0,bottom:0,left:0,width:"80px",display:"flex",alignItems:"center",justifyContent:"center",opacity:j&&l?1:0,transition:"opacity 0.3s ease",zIndex:4,cursor:l?"pointer":"default"},onClick:y=>{y.stopPropagation(),l&&(i==null||i())},children:l&&e.jsx(N,{sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)",transform:"scale(1.1)"},width:48,height:48,transition:"all 0.2s ease"},children:e.jsx(Te,{fontSize:"large"})})}),e.jsx(k,{sx:{position:"absolute",top:0,bottom:0,right:0,width:"80px",display:"flex",alignItems:"center",justifyContent:"center",opacity:j&&x?1:0,transition:"opacity 0.3s ease",zIndex:4,cursor:x?"pointer":"default"},onClick:y=>{y.stopPropagation(),x&&(u==null||u())},children:x&&e.jsx(N,{sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)",transform:"scale(1.1)"},width:48,height:48,transition:"all 0.2s ease"},children:e.jsx(He,{fontSize:"large"})})}),d&&e.jsx(k,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:3},children:e.jsx(ye,{sx:{color:"primary.main"},size:40})}),e.jsx(k,{ref:Z,sx:{width:"100%",height:"100%",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center",padding:2},children:e.jsx("img",{src:E,alt:r.description||"",onLoad:b,style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",objectFit:"contain",transform:`scale(${m})`,transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:d?"none":"block"}})}),L&&e.jsx(k,{sx:{position:"absolute",top:"50%",left:L==="right"?"10%":"auto",right:L==="left"?"10%":"auto",transform:"translateY(-50%)",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)",borderRadius:"50%",width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center",zIndex:3},children:L==="left"?e.jsx(He,{sx:{color:"white",fontSize:30}}):e.jsx(Te,{sx:{color:"white",fontSize:30}})})]}),e.jsxs(k,{sx:{position:"absolute",bottom:0,left:0,right:0,padding:"16px",backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(10px)",display:"flex",flexDirection:"column",gap:1,transform:j?"translateY(0)":"translateY(100%)",transition:"transform 0.3s ease",zIndex:5},children:[e.jsxs(K,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.8)",fontSize:"0.8rem"},children:["上传于 ",ae(r.created_at)]}),r.description&&e.jsx(K,{variant:"body2",sx:{color:"white",opacity:.9,fontSize:"0.9rem",maxHeight:"60px",overflow:"auto"},children:r.description}),e.jsxs(k,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2,mt:1},children:[e.jsx(N,{onClick:S,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Tt,{})}),e.jsxs(K,{variant:"caption",sx:{color:"white",fontSize:"0.85rem",minWidth:"60px",textAlign:"center"},children:[Math.round(m*100),"%"]}),e.jsx(N,{onClick:p,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Ht,{})}),e.jsx(N,{onClick:C,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Ut,{})})]})]})]})})},Na=({open:t,image:r,onClose:a,onSave:o})=>{const[s,i]=n.useState(""),[u,m]=n.useState("");n.useEffect(()=>{r&&(i(r.title||""),m(r.description||""))},[r]);const f=()=>{o({id:r==null?void 0:r.id,title:s,description:u})};return e.jsxs(Ue,{open:t,onClose:a,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Ne,{children:"编辑图片信息"}),e.jsxs(Ve,{children:[e.jsx(Ce,{autoFocus:!0,margin:"dense",label:"标题",type:"text",fullWidth:!0,value:s,onChange:d=>i(d.target.value),variant:"outlined",sx:{mb:2}}),e.jsx(Ce,{label:"描述",multiline:!0,rows:4,value:u,onChange:d=>m(d.target.value),fullWidth:!0,variant:"outlined"})]}),e.jsxs(Ye,{children:[e.jsx(H,{onClick:a,color:"primary",children:"取消"}),e.jsx(H,{onClick:f,color:"primary",children:"保存"})]})]})},Va=({open:t,onClose:r,onUpload:a,isAdmin:o})=>{const[s,i]=n.useState([]),[u,m]=n.useState(!1),[f,d]=n.useState({}),[h,j]=n.useState(0),A=n.useRef(null),L=()=>{i([]),d({}),m(!1),j(0)},$=()=>{u||(L(),r())},D=l=>{const b=Array.from(l.target.files).map(p=>({file:p,id:We(),title:p.name,description:"",preview:null}));b.forEach(p=>{const S=new FileReader;S.onloadend=()=>{i(C=>C.map(_=>_.id===p.id?{..._,preview:S.result}:_))},S.readAsDataURL(p.file)}),i(p=>[...p,...b])},P=l=>{i(x=>x.filter(b=>b.id!==l)),d(x=>{const b={...x};return delete b[l],b})},O=(l,x)=>{i(b=>b.map(p=>p.id===l?{...p,title:x}:p))},g=(l,x)=>{i(b=>b.map(p=>p.id===l?{...p,description:x}:p))},Z=async()=>{if(s.length!==0){m(!0),j(0),s.length;try{if(o&&s.length>1){const l=s.map(S=>S.file),x=s.map(S=>({title:S.title,description:S.description})),b=await a(l,x,(S,C)=>{if(C!==void 0){const _=s[C].id;d(z=>({...z,[_]:{status:"uploading",progress:S}})),S===100&&j(z=>z+1)}});b.forEach((S,C)=>{const _=s[C].id;S.success?d(z=>({...z,[_]:{status:"success",progress:100}})):d(z=>({...z,[_]:{status:"error",error:S.error}}))}),b.filter(S=>S.success).length===s.length&&setTimeout(()=>{$()},1e3)}else for(const l of s)try{d(x=>({...x,[l.id]:{status:"uploading",progress:0}})),await a(l.file,{title:l.title,description:l.description},x=>{d(b=>({...b,[l.id]:{status:"uploading",progress:x}}))}),d(x=>({...x,[l.id]:{status:"success",progress:100}})),j(x=>x+1),setTimeout(()=>{$()},1e3)}catch(x){console.error("上传失败:",x),d(b=>({...b,[l.id]:{status:"error",error:x.message}}))}}catch(l){console.error("批量上传失败:",l),s.forEach(x=>{d(b=>({...b,[x.id]:{status:"error",error:l.message}}))})}finally{m(!1)}}};return e.jsxs(Ue,{open:t,onClose:$,fullWidth:!0,maxWidth:o?"md":"sm",PaperProps:{sx:{bgcolor:"background.paper",backgroundImage:"none",border:"4px solid #2196f3",boxShadow:"8px 8px 0 rgba(33, 150, 243, 0.3)",borderRadius:0}},children:[e.jsx(Ne,{sx:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"1rem",color:"#2196f3"},children:o?"批量上传测评报告图片":"上传测评报告图片"}),e.jsxs(Ve,{children:[e.jsx(k,{sx:{mb:2,mt:1},children:e.jsxs(H,{variant:"outlined",component:"label",startIcon:e.jsx(Pe,{className:"pixel-icon"}),disabled:u,fullWidth:!0,className:"pixel-button",children:[o?"选择多张图片":"选择图片",e.jsx("input",{ref:A,type:"file",hidden:!0,accept:"image/*",multiple:o,onChange:D,disabled:u})]})}),s.length>0&&e.jsx(k,{sx:{display:"grid",gridTemplateColumns:o?"repeat(auto-fill, minmax(200px, 1fr))":"1fr",gap:2,mb:2},children:s.map(l=>{var x,b,p;return e.jsxs(Fe,{sx:{p:2,position:"relative",bgcolor:"background.paper",backgroundImage:"none",border:"2px solid #2196f3",borderRadius:0,transition:"all 0.3s ease","&:hover":{borderColor:"#64b5f6",transform:"translateY(-2px)"}},children:[l.preview&&e.jsxs(k,{sx:{width:"100%",height:150,mb:1,position:"relative",borderRadius:1,overflow:"hidden"},children:[e.jsx("img",{src:l.preview,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}}),f[l.id]&&e.jsxs(k,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},children:[f[l.id].status==="uploading"&&e.jsx(ye,{variant:"determinate",value:f[l.id].progress,size:40}),f[l.id].status==="success"&&e.jsx(Je,{color:"success",sx:{fontSize:40}}),f[l.id].status==="error"&&e.jsx(Nt,{color:"error",sx:{fontSize:40}})]})]}),e.jsx(Ce,{size:"small",label:"标题",value:l.title,onChange:S=>O(l.id,S.target.value),fullWidth:!0,sx:{mb:1,"& .MuiInputLabel-root":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.7rem"},"& .MuiInputBase-input":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.8rem"}},disabled:u||((x=f[l.id])==null?void 0:x.status)==="success"}),e.jsx(Ce,{size:"small",label:"描述",value:l.description,onChange:S=>g(l.id,S.target.value),fullWidth:!0,multiline:!0,rows:2,sx:{"& .MuiInputLabel-root":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.7rem"},"& .MuiInputBase-input":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.8rem"}},disabled:u||((b=f[l.id])==null?void 0:b.status)==="success"}),!u&&((p=f[l.id])==null?void 0:p.status)!=="success"&&e.jsx(N,{size:"small",onClick:()=>P(l.id),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.5)","&:hover":{bgcolor:"rgba(0,0,0,0.7)",animation:"pixelHover 0.5s infinite"}},children:e.jsx(qe,{sx:{fontSize:"1rem",color:"white"},className:"pixel-icon"})})]},l.id)})})]}),e.jsxs(Ye,{children:[e.jsx(H,{onClick:$,disabled:u,className:"pixel-button",children:"取消"}),e.jsx(H,{onClick:Z,disabled:s.length===0||u||s.every(l=>{var x;return((x=f[l.id])==null?void 0:x.status)==="success"}),variant:"contained",startIcon:u?e.jsx(ye,{size:20}):e.jsx(Et,{className:"pixel-icon"}),className:"pixel-button",children:u?`上传中 (${h}/${s.length})`:"上传"})]})]})};class Ya extends Ft.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("GalleryApp错误:",r),console.error("错误详情:",a),this.setState({error:r,errorInfo:a})}render(){var r;return this.state.hasError?e.jsxs(k,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#1a1a1a",padding:3,color:"#fff"},children:[e.jsx(K,{variant:"h6",sx:{color:"#ff69b4",marginBottom:2},children:"页面加载出错了"}),e.jsxs(K,{variant:"body1",sx:{marginBottom:2,maxWidth:600,textAlign:"center"},children:["错误信息: ",((r=this.state.error)==null?void 0:r.message)||"未知错误"]}),e.jsx(H,{variant:"contained",onClick:()=>window.location.reload(),sx:{backgroundColor:"#ff69b4","&:hover":{backgroundColor:"#ff8dc3"}},children:"刷新页面"}),!1]}):this.props.children}}function qa(){const[t,r]=n.useState([]),[a,o]=n.useState(0),[s,i]=n.useState(0),[u]=n.useState(20),[m,f]=n.useState(!0),[d,h]=n.useState(!0);n.useState(null);const[j,A]=n.useState(null),[L,$]=n.useState(!1);n.useState(!1);const[D,P]=n.useState(!1),[O,g]=n.useState(!1),[Z,l]=n.useState(""),[x,b]=n.useState("info"),[p,S]=n.useState(null),[C,_]=n.useState(()=>localStorage.getItem("isAdmin")==="true"),[z,ee]=n.useState("all"),[T,V]=n.useState(new Set),[E,ae]=n.useState(!1),[y,Y]=n.useState(!1),[B,te]=n.useState(!1),[U,re]=n.useState(-1),[xe,le]=n.useState(null),se=n.useRef(),w=n.useCallback(c=>{m||y||(se.current&&se.current.disconnect(),se.current=new IntersectionObserver(v=>{v[0].isIntersecting&&d&&i(I=>I+1)}),c&&se.current.observe(c))},[m,y,d]),M=n.useRef(null),W=Re(ke.breakpoints.only("xs")),ie=Re(ke.breakpoints.only("sm")),je=Re(ke.breakpoints.only("md")),ge=Re(ke.breakpoints.only("lg")),Se=()=>W?1:ie?2:je?3:ge?4:ge&&window.innerWidth>=1440?5:6,ce=n.useCallback(async(c=!1)=>{if(!p){console.log("等待用户ID初始化...");return}c?Y(!0):f(!0);try{const v=s*u;console.log("开始获取图片列表:",{page:s,limit:u,offset:v,filter:z,userId:p});const{data:I,count:F,hasMore:oe}=await X.getImages(u,v);if(!I){console.log("没有获取到图片数据"),c||(r([]),o(0)),h(!1);return}console.log("获取到原始图片数据:",{count:F,dataLength:I==null?void 0:I.length});let J=I||[];z==="approved"?J=J.filter(Q=>Q.is_approved):z==="pending"&&(J=J.filter(Q=>!Q.is_approved)),J=J.map(Q=>({...Q,current_user_id:p})),J.sort((Q,he)=>Q.user_id===p&&he.user_id!==p?-1:Q.user_id!==p&&he.user_id===p?1:new Date(he.created_at)-new Date(Q.created_at)),console.log("过滤并排序后的图片数据:",{filteredCount:J.length,filter:z,firstImage:J[0]}),r(Q=>c?[...Q,...J]:J),o(F),h(oe)}catch(v){console.error("获取图片失败:",v),l(`获取图片失败: ${v.message||"未知错误"}`),b("error"),g(!0),c||(r([]),o(0))}finally{c?Y(!1):f(!1)}},[p,s,u,z]);n.useEffect(()=>{M.current=ce},[ce]),n.useEffect(()=>{p&&(i(0),h(!0),ce(!1))},[p,z]),n.useEffect(()=>{s>0&&ce(!0)},[s]);const ft=()=>{const c=prompt("请输入管理员密码：");c==="Sangok#3"?(_(!0),localStorage.setItem("isAdmin","true"),l("管理员登录成功！"),g(!0)):c!==null&&(l("密码错误！"),g(!0))},ht=()=>{_(!1),localStorage.removeItem("isAdmin"),l("已退出管理员模式！"),g(!0)};n.useEffect(()=>{var c;try{console.log("开始初始化用户ID...");let v=(c=document.cookie.match(/userId=([^;]+)/))==null?void 0:c[1],I;const F=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;if(v){let oe=v;oe.startsWith("user_")&&(console.log("移除 'user_' 前缀:",oe),oe=oe.substring(5)),F.test(oe)?(I=oe,console.log("使用cookie中的有效UUID:",I)):(console.log("Cookie中的UUID格式无效，生成新的UUID"),I=We())}else console.log("Cookie中未找到UUID，生成新的UUID"),I=We();document.cookie=`userId=${I};path=/;max-age=31536000;SameSite=Lax`,console.log("设置用户ID:",I),S(I)}catch(v){console.error("初始化用户ID失败:",v),l("初始化用户ID失败，请刷新页面重试"),g(!0)}},[]),n.useCallback(async(c,v)=>{try{await X.approveImage(c,v),l(`图片已${v?"通过审核":"取消审核"}`),g(!0),M.current&&M.current()}catch(I){console.error("审核图片失败:",I),l(`审核失败: ${I.message}`),g(!0)}},[]);const Qt=n.useCallback(async(c,v,I)=>{try{if(C&&Array.isArray(c)){console.log("开始批量上传:",{fileCount:c.length,metadata:v});const F=await X.uploadImages(c,p,v,I);console.log("批量上传结果:",F);const oe=F.filter(he=>he.success).length,J=F.length-oe;let Q;return J>0?(Q=`上传完成：${oe}张成功，${J}张失败`,console.error("部分图片上传失败:",F.filter(he=>!he.success))):Q="所有图片上传成功！",l(Q),g(!0),M.current&&M.current(),F}else{const F=await X.uploadImage(c,p,v,I);return l("图片上传成功！"),g(!0),M.current&&M.current(),F}}catch(F){throw console.error("上传图片失败:",F),l(`上传失败: ${F.message}`),g(!0),F}},[C,p]),Xt=n.useCallback(async c=>{if(window.confirm("确定要删除这张图片吗？此操作无法撤销。"))try{await X.deleteImage(c,p,C),l("图片已删除"),g(!0),window.location.reload()}catch(v){console.error("删除图片失败:",v),l(`删除失败: ${v.message}`),g(!0)}},[p,C]),Kt=c=>{if(!(c!=null&&c.id)||!(t!=null&&t.length))return;const v=t.findIndex(I=>I.id===c.id);console.log("Opening image:",{imageId:c.id,index:v,totalImages:t.length,imagesArray:t.map(I=>I.id)}),v!==-1&&(re(v),le(c))},Jt=c=>{A(c),P(!0)},er=n.useCallback(async c=>{try{const{id:v,title:I,description:F}=c;await X.updateImageInfo(v,p,{title:I,description:F},C),l("图片信息已更新"),g(!0),P(!1),M.current&&M.current()}catch(v){console.error("更新图片信息失败:",v),l(`更新失败: ${v.message}`),g(!0)}},[p,C]),tr=n.useCallback(c=>{V(v=>{const I=new Set(v);return I.has(c)?I.delete(c):I.add(c),I})},[]),rr=n.useCallback(()=>{T.size===t.length?V(new Set):V(new Set(t.map(c=>c.id)))},[t,T.size]),or=async()=>{const c=Array.from(T);if(c.length===0){l("请先选择要删除的图片"),b("warning"),g(!0);return}f(!0);try{const{successful:v,failed:I}=await X.deleteImages(c,p);let F="";v>0&&I===0?(F=`成功删除 ${v} 张图片`,b("success")):v>0&&I>0?(F=`${v} 张图片删除成功，${I} 张删除失败`,b("warning")):(F="删除失败",b("error")),l(F),g(!0),V(new Set),window.location.reload()}catch(v){console.error("批量删除失败:",v),l("批量删除失败: "+(v.message||"未知错误")),b("error"),g(!0)}finally{f(!1)}},ar=n.useCallback(async()=>{if(window.confirm("确定要清空所有图片吗？此操作无法撤销。"))try{f(!0);const c=await Promise.allSettled(t.map(F=>X.deleteImage(F.id,p,C))),v=c.filter(F=>F.status==="fulfilled").length,I=c.filter(F=>F.status==="rejected").length;l(`清空完成：${v}张成功，${I}张失败`),g(!0),window.location.reload()}catch(c){console.error("清空图片失败:",c),l(`清空图片失败: ${c.message}`),g(!0)}finally{f(!1)}},[t,p,C]),sr=n.useCallback(()=>{if(t!=null&&t.length&&U>0){const c=U-1;console.log("Moving to previous image:",{newIndex:c,currentIndex:U,totalImages:t.length}),re(c),le(t[c])}},[U,t]),nr=n.useCallback(()=>{if(t!=null&&t.length&&U<t.length-1){const c=U+1;console.log("Moving to next image:",{newIndex:c,currentIndex:U,totalImages:t.length}),re(c),le(t[c])}},[U,t]),lr=n.useCallback(()=>{le(null),re(-1)},[]);return e.jsx(Ya,{children:e.jsxs(Sr,{theme:ke,children:[e.jsx(Lo,{}),e.jsxs(k,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(kr,{position:"sticky",sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",borderBottom:"1px solid rgba(229, 231, 235, 0.8)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.05)",marginBottom:"2rem"},elevation:0,children:e.jsx(vt,{maxWidth:"lg",children:e.jsxs(wr,{sx:{justifyContent:"space-between",py:1},children:[e.jsxs(k,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(_e,{sx:{color:"primary.main",mr:1.5,fontSize:{xs:24,sm:28}}}),e.jsx(K,{variant:"h6",sx:{color:"text.primary",fontWeight:700,fontSize:{xs:"1.1rem",sm:"1.3rem"},backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"M-Profile Lab"})]}),e.jsxs(k,{sx:{display:{xs:"none",md:"flex"},gap:1.5,"& .MuiButton-root":{borderRadius:"8px",minWidth:"auto",px:2,py:.75,transition:"all 0.2s ease"}},children:[C&&e.jsx(H,{color:"error",variant:"outlined",startIcon:e.jsx(Ct,{}),onClick:ht,size:"small",sx:{fontWeight:500},children:"退出管理"}),e.jsx(H,{color:"primary",variant:"text",startIcon:e.jsx(St,{}),href:"./female.html",size:"small",children:"女M版"}),e.jsx(H,{color:"primary",variant:"text",startIcon:e.jsx(kt,{}),href:"./male.html",size:"small",children:"男M版"}),e.jsx(H,{color:"primary",variant:"text",startIcon:e.jsx(_e,{}),href:"./s.html",size:"small",children:"S版"}),e.jsx(H,{color:"primary",variant:"text",startIcon:e.jsx(jt,{}),href:"./message.html",size:"small",children:"留言板"}),e.jsx(H,{color:"primary",variant:"contained",startIcon:e.jsx(yt,{}),href:"./index.html",size:"small",sx:{boxShadow:1,"&:hover":{boxShadow:2}},children:"返回首页"})]}),e.jsx(N,{sx:{display:{xs:"flex",md:"none"},color:"primary.main",backgroundColor:"rgba(249, 115, 22, 0.05)","&:hover":{backgroundColor:"rgba(249, 115, 22, 0.1)"},width:40,height:40},onClick:()=>te(!0),children:e.jsx(Ir,{})})]})})}),e.jsxs(Mr,{anchor:"right",open:B,onClose:()=>te(!1),PaperProps:{sx:{backgroundColor:"#ffffff",width:280,boxShadow:"-4px 0 15px rgba(0, 0, 0, 0.05)",pt:2,"& .MuiListItem-root":{borderRadius:1.5,mx:2,mb:1}}},children:[e.jsxs(k,{sx:{px:3,pb:2,display:"flex",alignItems:"center"},children:[e.jsx(_e,{sx:{color:"primary.main",mr:1.5}}),e.jsx(K,{variant:"h6",sx:{fontWeight:700,backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"M-Profile Lab"})]}),e.jsx(Fr,{sx:{mb:2}}),e.jsxs($r,{children:[C&&e.jsxs(me,{button:!0,onClick:ht,sx:{backgroundColor:"rgba(239, 68, 68, 0.08)","&:hover":{backgroundColor:"rgba(239, 68, 68, 0.15)"}},children:[e.jsx(be,{children:e.jsx(Ct,{sx:{color:"error.main"}})}),e.jsx(ve,{primary:"退出管理",primaryTypographyProps:{fontWeight:500,color:"error.main"}})]}),e.jsxs(me,{button:!0,component:"a",href:"./female.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(be,{children:e.jsx(St,{sx:{color:"primary.main"}})}),e.jsx(ve,{primary:"女M版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(me,{button:!0,component:"a",href:"./male.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(be,{children:e.jsx(kt,{sx:{color:"primary.main"}})}),e.jsx(ve,{primary:"男M版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(me,{button:!0,component:"a",href:"./s.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(be,{children:e.jsx(_e,{sx:{color:"primary.main"}})}),e.jsx(ve,{primary:"S版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(me,{button:!0,component:"a",href:"./message.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(be,{children:e.jsx(jt,{sx:{color:"primary.main"}})}),e.jsx(ve,{primary:"留言板",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(me,{button:!0,component:"a",href:"./index.html",sx:{backgroundColor:"rgba(249, 115, 22, 0.08)","&:hover":{backgroundColor:"rgba(249, 115, 22, 0.15)"},mt:2},children:[e.jsx(be,{children:e.jsx(yt,{sx:{color:"primary.main"}})}),e.jsx(ve,{primary:"返回首页",primaryTypographyProps:{fontWeight:500}})]})]})]}),e.jsxs(vt,{maxWidth:"xl",sx:{px:{xs:2,sm:3,md:4},pt:4},children:[e.jsxs(k,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",mb:6},className:"fade-in",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
                  .force-orange-title {
                    color: #f97316 !important;
                    text-shadow: 0 0 15px rgba(249, 115, 22, 0.5), 2px 2px 0 rgba(249, 115, 22, 0.3) !important;
                    font-weight: 800 !important;
                    animation: float-title 3s ease-in-out infinite !important;
                  }
                  
                  @keyframes float-title {
                    0% { transform: translateY(0); }
                    50% { transform: translateY(-10px); }
                    100% { transform: translateY(0); }
                  }
                `}}),e.jsx(K,{variant:"h2",component:"h1",className:"pixel-title-orange force-orange-title",sx:{fontSize:{xs:"2rem",sm:"2.5rem",md:"3rem"},textAlign:"center",mb:2,color:"#f97316 !important",textShadow:"0 0 15px rgba(249, 115, 22, 0.5), 2px 2px 0 rgba(249, 115, 22, 0.3)",background:"transparent",WebkitTextFillColor:"#f97316",filter:"drop-shadow(0 0 8px rgba(249, 115, 22, 0.5))",position:"relative",animation:"float 3s ease-in-out infinite","@keyframes float":{"0%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"},"100%":{transform:"translateY(0)"}}},onDoubleClick:ft,children:"Report Gallery"}),e.jsx(K,{variant:"body1",color:"text.secondary",sx:{maxWidth:"600px",textAlign:"center",mb:4,fontSize:{xs:"0.9rem",sm:"1rem"}},children:"浏览、分享和点评各种测评报告，记录你的测评经历"}),e.jsxs(k,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:2,mb:4,width:"100%",maxWidth:"800px"},children:[e.jsx(H,{variant:"contained",startIcon:e.jsx(Pe,{}),onClick:()=>$(!0),size:"large",sx:{px:3,py:1.5,fontSize:"1rem",fontWeight:600,boxShadow:3,"&:hover":{boxShadow:4},backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)"},children:"上传图片"}),C&&e.jsx(H,{variant:E?"contained":"outlined",color:E?"secondary":"primary",startIcon:E?e.jsx(qe,{}):e.jsx(Vt,{}),onClick:()=>{ae(!E),V(new Set)},size:"large",sx:{px:3,py:1.5,fontSize:"1rem",backgroundColor:E?"rgba(245, 158, 11, 0.9)":"transparent"},children:E?"退出选择":"选择图片"})]}),C&&E&&e.jsxs(k,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:2,mb:4,className:"fade-in"},children:[e.jsx(H,{variant:"outlined",color:"primary",onClick:rr,size:"medium",children:T.size===t.length?"取消全选":"全选"}),e.jsxs(H,{variant:"contained",color:"error",startIcon:e.jsx(Dt,{}),onClick:or,disabled:T.size===0,size:"medium",children:["删除选中 (",T.size,")"]}),e.jsx(H,{variant:"outlined",color:"error",startIcon:e.jsx(Yt,{}),onClick:ar,size:"medium",children:"清空图片"})]}),C&&e.jsxs(Dr,{size:"small",sx:{width:{xs:"100%",sm:"auto"},minWidth:150,mt:E?0:2,"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"background.paper",boxShadow:1,borderColor:"primary.main"}},children:[e.jsx(Ar,{children:"筛选图片"}),e.jsxs(zr,{value:z,label:"筛选图片",onChange:c=>ee(c.target.value),children:[e.jsx(Ee,{value:"all",children:"全部图片"}),e.jsx(Ee,{value:"approved",children:"已审核"}),e.jsx(Ee,{value:"pending",children:"待审核"})]})]})]}),m?e.jsx(k,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(ye,{color:"primary"})}):t&&t.length>0?e.jsx(k,{sx:{width:"100%",minHeight:400},children:e.jsx(wa,{columns:Se(),spacing:3,sx:{width:"auto"},children:t.map((c,v)=>e.jsx("div",{ref:v===t.length-1?w:null,children:e.jsx(Ha,{image:c,onView:Kt,onDelete:Xt,onEdit:Jt,isAdmin:C,isSelected:T.has(c.id),isSelectionMode:E,onSelect:()=>tr(c.id),userId:p})},c.id))})}):e.jsxs(Fe,{sx:{p:4,textAlign:"center",backgroundColor:"background.paper",borderRadius:2},children:[e.jsx(Ot,{sx:{fontSize:40,color:"primary.main",mb:2}}),e.jsx(K,{variant:"h6",sx:{mb:2},children:"暂无图片"}),e.jsx(K,{variant:"body1",sx:{mb:3,color:"text.secondary"},children:z!=="all"?"当前筛选条件下没有找到图片":"目前还没有上传的测评报告图片，快来分享你的测评结果吧！"}),e.jsx(H,{variant:"contained",startIcon:e.jsx(Pe,{}),onClick:()=>$(!0),color:"primary",children:"上传图片"})]}),y&&e.jsx(k,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(ye,{color:"primary"})}),e.jsx(Va,{open:L,onClose:()=>$(!1),onUpload:Qt,isAdmin:C}),e.jsx(Ua,{open:!!xe,image:xe,onClose:lr,images:t,currentIndex:U,onPrevious:sr,onNext:nr}),e.jsx(Na,{open:D,image:j,onClose:()=>P(!1),onSave:er}),e.jsx(_r,{open:O,autoHideDuration:5e3,onClose:()=>g(!1),children:e.jsx(so,{onClose:()=>g(!1),severity:x,variant:"filled",children:Z})})]})]})]})})}Pr.createRoot(document.getElementById("root")).render(e.jsx(Ft.StrictMode,{children:e.jsx(qa,{})}));

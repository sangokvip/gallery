import{l as Ae,m as Ie,a8 as jr,s as K,q as Y,_ as S,a9 as Tr,r as x,u as we,n as ye,j as h,o as be,p as xe,v as as,aa as ls,a1 as pt,ab as cs,ac as Yt,ad as us,ae as Ot,af as At,Q as hs,ag as ds,S as fs,ah as ps,ai as gs,aj as ms,x as Q,y as X,a6 as Pe,a7 as vs,a5 as J,c as _s,R as Er,B as R,b as U,d as ce,T as ws,A as ys,C as er,a as bs,e as xs,P as tt,D as ks,f as Ss,g as js,h as Ts,i as Es,I as se,k as $s}from"./pixel-theme-a82dff61.js";function Cs(s){return Ae("MuiCircularProgress",s)}Ie("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Rs=["className","color","disableShrink","size","style","thickness","value","variant"];let rt=s=>s,tr,rr,sr,ir;const oe=44,Ps=jr(tr||(tr=rt`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Os=jr(rr||(rr=rt`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),As=s=>{const{classes:e,variant:t,color:r,disableShrink:i}=s,n={root:["root",t,`color${Y(r)}`],svg:["svg"],circle:["circle",`circle${Y(t)}`,i&&"circleDisableShrink"]};return xe(n,Cs,e)},Is=K("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.root,e[t.variant],e[`color${Y(t.color)}`]]}})(({ownerState:s,theme:e})=>S({display:"inline-block"},s.variant==="determinate"&&{transition:e.transitions.create("transform")},s.color!=="inherit"&&{color:(e.vars||e).palette[s.color].main}),({ownerState:s})=>s.variant==="indeterminate"&&Tr(sr||(sr=rt`
      animation: ${0} 1.4s linear infinite;
    `),Ps)),Ds=K("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(s,e)=>e.svg})({display:"block"}),Ls=K("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.circle,e[`circle${Y(t.variant)}`],t.disableShrink&&e.circleDisableShrink]}})(({ownerState:s,theme:e})=>S({stroke:"currentColor"},s.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},s.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:s})=>s.variant==="indeterminate"&&!s.disableShrink&&Tr(ir||(ir=rt`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Os)),Us=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiCircularProgress"}),{className:i,color:n="primary",disableShrink:o=!1,size:a=40,style:l,thickness:c=3.6,value:u=0,variant:d="indeterminate"}=r,f=ye(r,Rs),g=S({},r,{color:n,disableShrink:o,size:a,thickness:c,value:u,variant:d}),m=As(g),_={},v={},E={};if(d==="determinate"){const P=2*Math.PI*((oe-c)/2);_.strokeDasharray=P.toFixed(3),E["aria-valuenow"]=Math.round(u),_.strokeDashoffset=`${((100-u)/100*P).toFixed(3)}px`,v.transform="rotate(-90deg)"}return h.jsx(Is,S({className:be(m.root,i),style:S({width:a,height:a},v,l),ownerState:g,ref:t,role:"progressbar"},E,f,{children:h.jsx(Ds,{className:m.svg,ownerState:g,viewBox:`${oe/2} ${oe/2} ${oe} ${oe}`,children:h.jsx(Ls,{className:m.circle,style:_,ownerState:g,cx:oe,cy:oe,r:(oe-c)/2,fill:"none",strokeWidth:c})})}))}),nr=Us,Ms=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],Fs=s=>{const{absolute:e,children:t,classes:r,flexItem:i,light:n,orientation:o,textAlign:a,variant:l}=s;return xe({root:["root",e&&"absolute",l,n&&"light",o==="vertical"&&"vertical",i&&"flexItem",t&&"withChildren",t&&o==="vertical"&&"withChildrenVertical",a==="right"&&o!=="vertical"&&"textAlignRight",a==="left"&&o!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",o==="vertical"&&"wrapperVertical"]},ls,r)},qs=K("div",{name:"MuiDivider",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.root,t.absolute&&e.absolute,e[t.variant],t.light&&e.light,t.orientation==="vertical"&&e.vertical,t.flexItem&&e.flexItem,t.children&&e.withChildren,t.children&&t.orientation==="vertical"&&e.withChildrenVertical,t.textAlign==="right"&&t.orientation!=="vertical"&&e.textAlignRight,t.textAlign==="left"&&t.orientation!=="vertical"&&e.textAlignLeft]}})(({theme:s,ownerState:e})=>S({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(s.vars||s).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:s.vars?`rgba(${s.vars.palette.dividerChannel} / 0.08)`:as(s.palette.divider,.08)},e.variant==="inset"&&{marginLeft:72},e.variant==="middle"&&e.orientation==="horizontal"&&{marginLeft:s.spacing(2),marginRight:s.spacing(2)},e.variant==="middle"&&e.orientation==="vertical"&&{marginTop:s.spacing(1),marginBottom:s.spacing(1)},e.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:s})=>S({},s.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:s,ownerState:e})=>S({},e.children&&e.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(s.vars||s).palette.divider}`,borderTopStyle:"inherit"}}),({theme:s,ownerState:e})=>S({},e.children&&e.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(s.vars||s).palette.divider}`,borderLeftStyle:"inherit"}}),({ownerState:s})=>S({},s.textAlign==="right"&&s.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},s.textAlign==="left"&&s.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),zs=K("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.wrapper,t.orientation==="vertical"&&e.wrapperVertical]}})(({theme:s,ownerState:e})=>S({display:"inline-block",paddingLeft:`calc(${s.spacing(1)} * 1.2)`,paddingRight:`calc(${s.spacing(1)} * 1.2)`},e.orientation==="vertical"&&{paddingTop:`calc(${s.spacing(1)} * 1.2)`,paddingBottom:`calc(${s.spacing(1)} * 1.2)`})),$r=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiDivider"}),{absolute:i=!1,children:n,className:o,component:a=n?"div":"hr",flexItem:l=!1,light:c=!1,orientation:u="horizontal",role:d=a!=="hr"?"separator":void 0,textAlign:f="center",variant:g="fullWidth"}=r,m=ye(r,Ms),_=S({},r,{absolute:i,component:a,flexItem:l,light:c,orientation:u,role:d,textAlign:f,variant:g}),v=Fs(_);return h.jsx(qs,S({as:a,className:be(v.root,o),role:d,ref:t,ownerState:_},m,{children:n?h.jsx(zs,{className:v.wrapper,ownerState:_,children:n}):null}))});$r.muiSkipListHighlight=!0;const Ns=$r;function Bs(s){return Ae("MuiFormControl",s)}Ie("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Hs=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Ws=s=>{const{classes:e,margin:t,fullWidth:r}=s,i={root:["root",t!=="none"&&`margin${Y(t)}`,r&&"fullWidth"]};return xe(i,Bs,e)},Js=K("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:s},e)=>S({},e.root,e[`margin${Y(s.margin)}`],s.fullWidth&&e.fullWidth)})(({ownerState:s})=>S({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},s.margin==="normal"&&{marginTop:16,marginBottom:8},s.margin==="dense"&&{marginTop:8,marginBottom:4},s.fullWidth&&{width:"100%"})),Vs=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiFormControl"}),{children:i,className:n,color:o="primary",component:a="div",disabled:l=!1,error:c=!1,focused:u,fullWidth:d=!1,hiddenLabel:f=!1,margin:g="none",required:m=!1,size:_="medium",variant:v="outlined"}=r,E=ye(r,Hs),P=S({},r,{color:o,component:a,disabled:l,error:c,fullWidth:d,hiddenLabel:f,margin:g,required:m,size:_,variant:v}),A=Ws(P),[y,O]=x.useState(()=>{let V=!1;return i&&x.Children.forEach(i,M=>{if(!pt(M,["Input","Select"]))return;const q=pt(M,["Select"])?M.props.input:M;q&&cs(q.props)&&(V=!0)}),V}),[ee,I]=x.useState(()=>{let V=!1;return i&&x.Children.forEach(i,M=>{pt(M,["Input","Select"])&&(Yt(M.props,!0)||Yt(M.props.inputProps,!0))&&(V=!0)}),V}),[ne,fe]=x.useState(!1);l&&ne&&fe(!1);const F=u!==void 0&&!l?u:ne;let te;const Se=x.useMemo(()=>({adornedStart:y,setAdornedStart:O,color:o,disabled:l,error:c,filled:ee,focused:F,fullWidth:d,hiddenLabel:f,size:_,onBlur:()=>{fe(!1)},onEmpty:()=>{I(!1)},onFilled:()=>{I(!0)},onFocus:()=>{fe(!0)},registerEffect:te,required:m,variant:v}),[y,o,l,c,ee,F,d,f,te,m,_,v]);return h.jsx(us.Provider,{value:Se,children:h.jsx(Js,S({as:a,ownerState:P,className:be(A.root,n),ref:t},E,{children:i}))})}),Gs=Vs;function Ks(s){return Ae("MuiFormHelperText",s)}const Qs=Ie("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),or=Qs;var ar;const Xs=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Zs=s=>{const{classes:e,contained:t,size:r,disabled:i,error:n,filled:o,focused:a,required:l}=s,c={root:["root",i&&"disabled",n&&"error",r&&`size${Y(r)}`,t&&"contained",a&&"focused",o&&"filled",l&&"required"]};return xe(c,Ks,e)},Ys=K("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.root,t.size&&e[`size${Y(t.size)}`],t.contained&&e.contained,t.filled&&e.filled]}})(({theme:s,ownerState:e})=>S({color:(s.vars||s).palette.text.secondary},s.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${or.disabled}`]:{color:(s.vars||s).palette.text.disabled},[`&.${or.error}`]:{color:(s.vars||s).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),ei=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiFormHelperText"}),{children:i,className:n,component:o="p"}=r,a=ye(r,Xs),l=Ot(),c=At({props:r,muiFormControl:l,states:["variant","size","disabled","error","filled","focused","required"]}),u=S({},r,{component:o,contained:c.variant==="filled"||c.variant==="outlined",variant:c.variant,size:c.size,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),d=Zs(u);return h.jsx(Ys,S({as:o,ownerState:u,className:be(d.root,n),ref:t},a,{children:i===" "?ar||(ar=h.jsx("span",{className:"notranslate",children:"​"})):i}))}),ti=ei;function ri(s){return Ae("MuiFormLabel",s)}const si=Ie("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),qe=si,ii=["children","className","color","component","disabled","error","filled","focused","required"],ni=s=>{const{classes:e,color:t,focused:r,disabled:i,error:n,filled:o,required:a}=s,l={root:["root",`color${Y(t)}`,i&&"disabled",n&&"error",o&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",n&&"error"]};return xe(l,ri,e)},oi=K("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:s},e)=>S({},e.root,s.color==="secondary"&&e.colorSecondary,s.filled&&e.filled)})(({theme:s,ownerState:e})=>S({color:(s.vars||s).palette.text.secondary},s.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${qe.focused}`]:{color:(s.vars||s).palette[e.color].main},[`&.${qe.disabled}`]:{color:(s.vars||s).palette.text.disabled},[`&.${qe.error}`]:{color:(s.vars||s).palette.error.main}})),ai=K("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(s,e)=>e.asterisk})(({theme:s})=>({[`&.${qe.error}`]:{color:(s.vars||s).palette.error.main}})),li=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiFormLabel"}),{children:i,className:n,component:o="label"}=r,a=ye(r,ii),l=Ot(),c=At({props:r,muiFormControl:l,states:["color","required","focused","disabled","error","filled"]}),u=S({},r,{color:c.color||"primary",component:o,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),d=ni(u);return h.jsxs(oi,S({as:o,ownerState:u,className:be(d.root,n),ref:t},a,{children:[i,c.required&&h.jsxs(ai,{ownerState:u,"aria-hidden":!0,className:d.asterisk,children:[" ","*"]})]}))}),ci=li;function ui(s){return Ae("MuiInputLabel",s)}Ie("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const hi=["disableAnimation","margin","shrink","variant","className"],di=s=>{const{classes:e,formControl:t,size:r,shrink:i,disableAnimation:n,variant:o,required:a}=s,l={root:["root",t&&"formControl",!n&&"animated",i&&"shrink",r&&r!=="normal"&&`size${Y(r)}`,o],asterisk:[a&&"asterisk"]},c=xe(l,ui,e);return S({},e,c)},fi=K(ci,{shouldForwardProp:s=>hs(s)||s==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[{[`& .${qe.asterisk}`]:e.asterisk},e.root,t.formControl&&e.formControl,t.size==="small"&&e.sizeSmall,t.shrink&&e.shrink,!t.disableAnimation&&e.animated,t.focused&&e.focused,e[t.variant]]}})(({theme:s,ownerState:e})=>S({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:s.transitions.create(["color","transform","max-width"],{duration:s.transitions.duration.shorter,easing:s.transitions.easing.easeOut})},e.variant==="filled"&&S({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&S({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&S({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),pi=x.forwardRef(function(e,t){const r=we({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:n,className:o}=r,a=ye(r,hi),l=Ot();let c=n;typeof c>"u"&&l&&(c=l.filled||l.focused||l.adornedStart);const u=At({props:r,muiFormControl:l,states:["size","variant","required","focused"]}),d=S({},r,{disableAnimation:i,formControl:l,shrink:c,size:u.size,variant:u.variant,required:u.required,focused:u.focused}),f=di(d);return h.jsx(fi,S({"data-shrink":c,ownerState:d,ref:t,className:be(f.root,o)},a,{classes:f}))}),gi=pi;function mi(s){return Ae("MuiTextField",s)}Ie("MuiTextField",["root"]);const vi=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],_i={standard:ps,filled:gs,outlined:ms},wi=s=>{const{classes:e}=s;return xe({root:["root"]},mi,e)},yi=K(Gs,{name:"MuiTextField",slot:"Root",overridesResolver:(s,e)=>e.root})({}),bi=x.forwardRef(function(e,t){const r=we({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:n=!1,children:o,className:a,color:l="primary",defaultValue:c,disabled:u=!1,error:d=!1,FormHelperTextProps:f,fullWidth:g=!1,helperText:m,id:_,InputLabelProps:v,inputProps:E,InputProps:P,inputRef:A,label:y,maxRows:O,minRows:ee,multiline:I=!1,name:ne,onBlur:fe,onChange:F,onFocus:te,placeholder:Se,required:V=!1,rows:M,select:q=!1,SelectProps:pe,type:ut,value:Ve,variant:je="outlined"}=r,ht=ye(r,vi),Ge=S({},r,{autoFocus:n,color:l,disabled:u,error:d,fullWidth:g,multiline:I,required:V,select:q,variant:je}),dt=wi(Ge),ge={};je==="outlined"&&(v&&typeof v.shrink<"u"&&(ge.notched=v.shrink),ge.label=y),q&&((!pe||!pe.native)&&(ge.id=void 0),ge["aria-describedby"]=void 0);const re=ds(_),Ue=m&&re?`${re}-helper-text`:void 0,Ke=y&&re?`${re}-label`:void 0,ft=_i[je],p=h.jsx(ft,S({"aria-describedby":Ue,autoComplete:i,autoFocus:n,defaultValue:c,fullWidth:g,multiline:I,name:ne,rows:M,maxRows:O,minRows:ee,type:ut,value:Ve,id:re,inputRef:A,onBlur:fe,onChange:F,onFocus:te,placeholder:Se,inputProps:E},ge,P));return h.jsxs(yi,S({className:be(dt.root,a),disabled:u,error:d,fullWidth:g,ref:t,required:V,color:l,variant:je,ownerState:Ge},ht,{children:[y!=null&&y!==""&&h.jsx(gi,S({htmlFor:re,id:Ke},v,{children:y})),q?h.jsx(fs,S({"aria-describedby":Ue,id:re,labelId:Ke,value:Ve,input:p},pe,{children:o})):p,m&&h.jsx(ti,S({id:Ue},f,{children:m}))]}))}),xt=bi;var It={},xi=X;Object.defineProperty(It,"__esModule",{value:!0});var Cr=It.default=void 0,ki=xi(Q()),Si=h;Cr=It.default=(0,ki.default)((0,Si.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");var Dt={},ji=X;Object.defineProperty(Dt,"__esModule",{value:!0});var Lt=Dt.default=void 0,Ti=ji(Q()),Ei=h;Lt=Dt.default=(0,Ti.default)((0,Ei.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var Ut={},$i=X;Object.defineProperty(Ut,"__esModule",{value:!0});var Rr=Ut.default=void 0,Ci=$i(Q()),Ri=h;Rr=Ut.default=(0,Ci.default)((0,Ri.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout");var Mt={},Pi=X;Object.defineProperty(Mt,"__esModule",{value:!0});var Ft=Mt.default=void 0,Oi=Pi(Q()),Ai=h;Ft=Mt.default=(0,Oi.default)((0,Ai.jsx)("path",{d:"M9 21h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.58 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2M9 9l4.34-4.34L12 10h9v2l-3 7H9zM1 9h4v12H1z"}),"ThumbUpOutlined");var qt={},Ii=X;Object.defineProperty(qt,"__esModule",{value:!0});var zt=qt.default=void 0,Di=Ii(Q()),Li=h;zt=qt.default=(0,Di.default)((0,Li.jsx)("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m0 12-4.34 4.34L12 14H3v-2l3-7h9zm4-12h4v12h-4z"}),"ThumbDownOutlined");var Nt={},Ui=X;Object.defineProperty(Nt,"__esModule",{value:!0});var Pr=Nt.default=void 0,Mi=Ui(Q()),Fi=h;Pr=Nt.default=(0,Mi.default)((0,Fi.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents");var Bt={},qi=X;Object.defineProperty(Bt,"__esModule",{value:!0});var Or=Bt.default=void 0,zi=qi(Q()),Ni=h;Or=Bt.default=(0,zi.default)((0,Ni.jsx)("path",{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3"}),"PushPin");var Ht={},Bi=X;Object.defineProperty(Ht,"__esModule",{value:!0});var Ar=Ht.default=void 0,Hi=Bi(Q()),Wi=h;Ar=Ht.default=(0,Hi.default)((0,Wi.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m0 14H6l-2 2V4h16z"}),"ChatBubbleOutline");var Wt={},Ji=X;Object.defineProperty(Wt,"__esModule",{value:!0});var Ir=Wt.default=void 0,Vi=Ji(Q()),Gi=h;Ir=Wt.default=(0,Vi.default)((0,Gi.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var Jt={},Ki=X;Object.defineProperty(Jt,"__esModule",{value:!0});var Dr=Jt.default=void 0,Qi=Ki(Q()),Xi=h;Dr=Jt.default=(0,Qi.default)((0,Xi.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");var Vt={},Zi=X;Object.defineProperty(Vt,"__esModule",{value:!0});var kt=Vt.default=void 0,Yi=Zi(Q()),en=h;kt=Vt.default=(0,Yi.default)((0,en.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");const tn=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Pe(()=>Promise.resolve().then(()=>De),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Gt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class rn extends Gt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sn extends Gt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class nn extends Gt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var St;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(St||(St={}));var on=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class an{constructor(e,{headers:t={},customFetch:r,region:i=St.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=tn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return on(this,void 0,void 0,function*(){try{const{headers:i,method:n,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(m=>{throw new rn(m)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new sn(u);if(!u.ok)throw new nn(u);let f=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return f==="application/json"?g=yield u.json():f==="application/octet-stream"?g=yield u.blob():f==="text/event-stream"?g=u:f==="multipart/form-data"?g=yield u.formData():g=yield u.text(),{data:g,error:null}}catch(i){return{data:null,error:i}}})}}var B={},Kt={},st={},We={},it={},nt={},ln=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Oe=ln();const cn=Oe.fetch,Lr=Oe.fetch.bind(Oe),Ur=Oe.Headers,un=Oe.Request,hn=Oe.Response,De=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ur,Request:un,Response:hn,default:Lr,fetch:cn},Symbol.toStringTag,{value:"Module"})),dn=vs(De);var ot={};Object.defineProperty(ot,"__esModule",{value:!0});let fn=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ot.default=fn;var Mr=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(nt,"__esModule",{value:!0});const pn=Mr(dn),gn=Mr(ot);let mn=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=pn.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{var o,a,l;let c=null,u=null,d=null,f=n.status,g=n.statusText;if(n.ok){if(this.method!=="HEAD"){const E=await n.text();E===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=E:u=JSON.parse(E))}const _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=n.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,f=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const _=await n.text();try{c=JSON.parse(_),Array.isArray(c)&&n.status===404&&(u=[],c=null,f=200,g="OK")}catch{n.status===404&&_===""?(f=204,g="No Content"):c={message:_}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,f=200,g="OK"),c&&this.shouldThrowOnError)throw new gn.default(c)}return{error:c,data:u,count:d,status:f,statusText:g}});return this.shouldThrowOnError||(i=i.catch(n=>{var o,a,l;return{error:{message:`${(o=n==null?void 0:n.name)!==null&&o!==void 0?o:"FetchError"}: ${n==null?void 0:n.message}`,details:`${(a=n==null?void 0:n.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=n==null?void 0:n.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};nt.default=mn;var vn=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(it,"__esModule",{value:!0});const _n=vn(nt);let wn=class extends _n.default{select(e){let t=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:n=i}={}){const o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){const n=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:n=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};it.default=wn;var yn=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(We,"__esModule",{value:!0});const bn=yn(it);let xn=class extends bn.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let n="";i==="plain"?n="pl":i==="phrase"?n="ph":i==="websearch"&&(n="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};We.default=xn;var kn=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(st,"__esModule",{value:!0});const Me=kn(We);let Sn=class{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){const i=t?"HEAD":"GET";let n=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Me.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const i="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Me.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:n=!0}={}){const o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Me.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new Me.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Me.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};st.default=Sn;var at={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.version=void 0;lt.version="0.0.0-automated";Object.defineProperty(at,"__esModule",{value:!0});at.DEFAULT_HEADERS=void 0;const jn=lt;at.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${jn.version}`};var Fr=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Kt,"__esModule",{value:!0});const Tn=Fr(st),En=Fr(We),$n=at;let Cn=class qr{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},$n.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new Tn.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new qr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:n}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;r||i?(o=r?"HEAD":"GET",Object.entries(t).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(o="POST",l=t);const c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new En.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Kt.default=Cn;var Le=J&&J.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(B,"__esModule",{value:!0});B.PostgrestError=B.PostgrestBuilder=B.PostgrestTransformBuilder=B.PostgrestFilterBuilder=B.PostgrestQueryBuilder=B.PostgrestClient=void 0;const zr=Le(Kt);B.PostgrestClient=zr.default;const Nr=Le(st);B.PostgrestQueryBuilder=Nr.default;const Br=Le(We);B.PostgrestFilterBuilder=Br.default;const Hr=Le(it);B.PostgrestTransformBuilder=Hr.default;const Wr=Le(nt);B.PostgrestBuilder=Wr.default;const Jr=Le(ot);B.PostgrestError=Jr.default;var Rn=B.default={PostgrestClient:zr.default,PostgrestQueryBuilder:Nr.default,PostgrestFilterBuilder:Br.default,PostgrestTransformBuilder:Hr.default,PostgrestBuilder:Wr.default,PostgrestError:Jr.default};const{PostgrestClient:Pn,PostgrestQueryBuilder:Aa,PostgrestFilterBuilder:Ia,PostgrestTransformBuilder:Da,PostgrestBuilder:La,PostgrestError:Ua}=Rn,On="2.11.2",An={"X-Client-Info":`realtime-js/${On}`},In="1.0.0",Vr=1e4,Dn=1e3;var Re;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Re||(Re={}));var H;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(H||(H={}));var G;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(G||(G={}));var jt;(function(s){s.websocket="websocket"})(jt||(jt={}));var _e;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(_e||(_e={}));class Ln{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const i=t.getUint8(1),n=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+i));o=o+i;const l=r.decode(e.slice(o,o+n));o=o+n;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class Gr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var $;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})($||($={}));const lr=(s,e,t={})=>{var r;const i=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((n,o)=>(n[o]=Un(o,s,e,i),n),{})},Un=(s,e,t,r)=>{const i=e.find(a=>a.name===s),n=i==null?void 0:i.type,o=t[s];return n&&!r.includes(n)?Kr(n,o):Tt(o)},Kr=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return zn(e,t)}switch(s){case $.bool:return Mn(e);case $.float4:case $.float8:case $.int2:case $.int4:case $.int8:case $.numeric:case $.oid:return Fn(e);case $.json:case $.jsonb:return qn(e);case $.timestamp:return Nn(e);case $.abstime:case $.date:case $.daterange:case $.int4range:case $.int8range:case $.money:case $.reltime:case $.text:case $.time:case $.timestamptz:case $.timetz:case $.tsrange:case $.tstzrange:return Tt(e);default:return Tt(e)}},Tt=s=>s,Mn=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Fn=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},qn=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},zn=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let n;const o=s.slice(1,t);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(a=>Kr(e,a))}return s},Nn=s=>typeof s=="string"?s.replace(" ","T"):s,Qr=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class gt{constructor(e,t,r={},i=Vr){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var cr;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(cr||(cr={}));class ze{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:n,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ze.syncState(this.state,i,n,o),this.pendingDiffs.forEach(l=>{this.state=ze.syncDiff(this.state,l,n,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},i=>{const{onJoin:n,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ze.syncDiff(this.state,i,n,o),a())}),this.onJoin((i,n,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:n,newPresences:o})}),this.onLeave((i,n,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){const n=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(n,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const d=n[c];if(d){const f=u.map(v=>v.presence_ref),g=d.map(v=>v.presence_ref),m=u.filter(v=>g.indexOf(v.presence_ref)<0),_=d.filter(v=>f.indexOf(v.presence_ref)<0);m.length>0&&(a[c]=m),_.length>0&&(l[c]=_)}else a[c]=u}),this.syncDiff(n,{joins:a,leaves:l},r,i)}static syncDiff(e,t,r,i){const{joins:n,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(n,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(g=>g.presence_ref),f=u.filter(g=>d.indexOf(g.presence_ref)<0);e[a].unshift(...f)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const i=e[r];return"metas"in i?t[r]=i.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ur;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ur||(ur={}));var hr;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(hr||(hr={}));var ie;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(ie||(ie={}));class Qt{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=H.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new gt(this,G.join,this.params,this.timeout),this.rejoinTimer=new Gr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=H.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=H.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=H.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=H.errored,this.rejoinTimer.scheduleTimeout())}),this._on(G.reply,{},(i,n)=>{this._trigger(this._replyEventName(n),i)}),this.presence=new ze(this),this.broadcastEndpointURL=Qr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:n,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(ie.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ie.CLOSED));const l={},c={broadcast:n,presence:o,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(ie.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,g=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,m=[];for(let _=0;_<g;_++){const v=f[_],{filter:{event:E,schema:P,table:A,filter:y}}=v,O=u&&u[_];if(O&&O.event===E&&O.schema===P&&O.table===A&&O.filter===y)m.push(Object.assign(Object.assign({},v),{id:O.id}));else{this.unsubscribe(),e==null||e(ie.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(ie.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(ie.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ie.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:n,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&n("ok"),c.receive("ok",()=>n("ok")),c.receive("error",()=>n("error")),c.receive("timeout",()=>n("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=H.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(G.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new gt(this,G.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const i=new AbortController,n=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new gt(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,n;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=G;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(g=>{var m,_,v;return((m=g.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(_=g.filter)===null||_===void 0?void 0:_.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(g=>g.callback(f,r)):(n=this.bindings[o])===null||n===void 0||n.filter(g=>{var m,_,v,E,P,A;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const y=g.id,O=(m=g.filter)===null||m===void 0?void 0:m.event;return y&&((_=t.ids)===null||_===void 0?void 0:_.includes(y))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const y=(P=(E=g==null?void 0:g.filter)===null||E===void 0?void 0:E.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return y==="*"||y===((A=t==null?void 0:t.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:_,table:v,commit_timestamp:E,type:P,errors:A}=m;f=Object.assign(Object.assign({},{schema:_,table:v,commit_timestamp:E,eventType:P,new:{},old:{},errors:A}),this._getPayloadRecords(m))}g.callback(f,r)})}_isClosed(){return this.state===H.closed}_isJoined(){return this.state===H.joined}_isJoining(){return this.state===H.joining}_isLeaving(){return this.state===H.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var n;return!(((n=i.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===r&&Qt.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(G.close,{},e)}_onError(e){this._on(G.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=H.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=lr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=lr(e.columns,e.old_record)),t}}const Bn=()=>{},Hn=typeof WebSocket<"u",Wn=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jn{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=An,this.params={},this.timeout=Vr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Bn,this.conn=null,this.sendBuffer=[],this.serializer=new Ln,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...a)=>Pe(()=>Promise.resolve().then(()=>De),void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${jt.websocket}`,this.httpEndpoint=Qr(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(n,o)=>o(JSON.stringify(n)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Hn){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Vn(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Pe(()=>import("./browser-f2715c94.js").then(e=>e.b),["./browser-f2715c94.js","./pixel-theme-a82dff61.js","./pixel-theme-52d61dc0.css"],import.meta.url).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:In}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Re.connecting:return _e.Connecting;case Re.open:return _e.Open;case Re.closing:return _e.Closing;default:return _e.Closed}}isConnected(){return this.connectionState()===_e.Open}channel(e,t={config:{}}){const r=new Qt(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:i,ref:n}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${n})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(G.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Dn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:i,payload:n,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${r} ${i} ${o&&"("+o+")"||""}`,n),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(i,n,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(G.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Wn],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Vn{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Re.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Xt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function D(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Gn extends Xt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Et extends Xt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Kn=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const Xr=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Pe(()=>Promise.resolve().then(()=>De),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Qn=()=>Kn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Pe(()=>Promise.resolve().then(()=>De),void 0,import.meta.url)).Response:Response}),$t=s=>{if(Array.isArray(s))return s.map(t=>$t(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const i=t.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));e[i]=$t(r)}),e};var ke=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const mt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Xn=(s,e,t)=>ke(void 0,void 0,void 0,function*(){const r=yield Qn();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(i=>{e(new Gn(mt(i),s.status||500))}).catch(i=>{e(new Et(mt(i),i))}):e(new Et(mt(s),s))}),Zn=(s,e,t,r)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),t))};function Je(s,e,t,r,i,n){return ke(this,void 0,void 0,function*(){return new Promise((o,a)=>{s(t,Zn(e,r,i,n)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Xn(l,a,r))})})}function et(s,e,t,r){return ke(this,void 0,void 0,function*(){return Je(s,"GET",e,t,r)})}function ue(s,e,t,r,i){return ke(this,void 0,void 0,function*(){return Je(s,"POST",e,r,i,t)})}function Yn(s,e,t,r,i){return ke(this,void 0,void 0,function*(){return Je(s,"PUT",e,r,i,t)})}function eo(s,e,t,r){return ke(this,void 0,void 0,function*(){return Je(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Zr(s,e,t,r,i){return ke(this,void 0,void 0,function*(){return Je(s,"DELETE",e,r,i,t)})}var N=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const to={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},dr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ro{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Xr(i)}uploadOrUpdate(e,t,r,i){return N(this,void 0,void 0,function*(){try{let n;const o=Object.assign(Object.assign({},dr),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l)),n.append("",r)):typeof FormData<"u"&&r instanceof FormData?(n=r,n.append("cacheControl",o.cacheControl),l&&n.append("metadata",this.encodeMetadata(l))):(n=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:n,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(n){if(D(n))return{data:null,error:n};throw n}})}upload(e,t,r){return N(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return N(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:dr.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),f=yield d.json();return d.ok?{data:{path:n,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(D(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return N(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const n=yield ue(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new Xt("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}update(e,t,r){return N(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return N(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(D(i))return{data:null,error:i};throw i}})}copy(e,t,r){return N(this,void 0,void 0,function*(){try{return{data:{path:(yield ue(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(D(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,r){return N(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield ue(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(i){if(D(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,r){return N(this,void 0,void 0,function*(){try{const i=yield ue(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(i){if(D(i))return{data:null,error:i};throw i}})}download(e,t){return N(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=n?`?${n}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield et(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(D(a))return{data:null,error:a};throw a}})}info(e){return N(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield et(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:$t(r),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}exists(e){return N(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield eo(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(D(r)&&r instanceof Et){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),i=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&i.push(n);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return N(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}list(e,t,r){return N(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},to),t),{prefix:e||""});return{data:yield ue(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(D(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const so="2.7.1",io={"X-Client-Info":`storage-js/${so}`};var Te=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class no{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},io),t),this.fetch=Xr(r)}listBuckets(){return Te(this,void 0,void 0,function*(){try{return{data:yield et(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}getBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield et(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Te(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Te(this,void 0,void 0,function*(){try{return{data:yield Yn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Te(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}}class oo extends no{constructor(e,t={},r){super(e,t,r)}from(e){return new ro(this.url,this.headers,e,this.fetch)}}const ao="2.49.4";let Fe="";typeof Deno<"u"?Fe="deno":typeof document<"u"?Fe="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fe="react-native":Fe="node";const lo={"X-Client-Info":`supabase-js-${Fe}/${ao}`},co={headers:lo},uo={schema:"public"},ho={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fo={};var po=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const go=s=>{let e;return s?e=s:typeof fetch>"u"?e=Lr:e=fetch,(...t)=>e(...t)},mo=()=>typeof Headers>"u"?Ur:Headers,vo=(s,e,t)=>{const r=go(t),i=mo();return(n,o)=>po(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:s;let c=new i(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",s),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(n,Object.assign(Object.assign({},o),{headers:c}))})};var _o=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};function wo(s){return s.replace(/\/$/,"")}function yo(s,e){const{db:t,auth:r,realtime:i,global:n}=s,{db:o,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),n),accessToken:()=>_o(this,void 0,void 0,function*(){return""})};return s.accessToken?u.accessToken=s.accessToken:delete u.accessToken,u}const Yr="2.69.1",Ce=30*1e3,Ct=3,vt=Ct*Ce,bo="http://localhost:9999",xo="supabase.auth.token",ko={"X-Client-Info":`gotrue-js/${Yr}`},Rt="X-Supabase-Api-Version",es={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},So=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jo=6e5;class Zt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function b(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class To extends Zt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Eo(s){return b(s)&&s.name==="AuthApiError"}class ts extends Zt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class de extends Zt{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class ae extends de{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $o(s){return b(s)&&s.name==="AuthSessionMissingError"}class _t extends de{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qe extends de{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Xe extends de{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Co(s){return b(s)&&s.name==="AuthImplicitGrantRedirectError"}class fr extends de{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pt extends de{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function wt(s){return b(s)&&s.name==="AuthRetryableFetchError"}class pr extends de{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Ne extends de{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const gr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),mr=` 	
\r=`.split(""),Ro=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<mr.length;e+=1)s[mr[e].charCodeAt(0)]=-2;for(let e=0;e<gr.length;e+=1)s[gr[e].charCodeAt(0)]=e;return s})();function rs(s,e,t){const r=Ro[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function vr(s){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=o=>{Ao(o,r,t)};for(let o=0;o<s.length;o+=1)rs(s.charCodeAt(o),i,n);return e.join("")}function Po(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function Oo(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}Po(r,e)}}function Ao(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if(!(s>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Io(s){const e=[],t={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<s.length;i+=1)rs(s.charCodeAt(i),t,r);return new Uint8Array(e)}function Do(s){const e=[];return Oo(s,t=>e.push(t)),new Uint8Array(e)}function Lo(s){return Math.round(Date.now()/1e3)+s}function Uo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const Z=()=>typeof window<"u"&&typeof document<"u",me={tested:!1,writable:!1},Be=()=>{if(!Z())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(me.tested)return me.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),me.tested=!0,me.writable=!0}catch{me.tested=!0,me.writable=!1}return me.writable};function Mo(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,n)=>{e[n]=i})}catch{}return t.searchParams.forEach((r,i)=>{e[i]=r}),e}const ss=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Pe(()=>Promise.resolve().then(()=>De),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Fo=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",is=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Ze=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ye=async(s,e)=>{await s.removeItem(e)};class ct{constructor(){this.promise=new ct.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ct.promiseConstructor=Promise;function yt(s){const e=s.split(".");if(e.length!==3)throw new Ne("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!So.test(e[r]))throw new Ne("JWT not in base64url format");return{header:JSON.parse(vr(e[0])),payload:JSON.parse(vr(e[1])),signature:Io(e[2]),raw:{header:e[0],payload:e[1]}}}async function qo(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function zo(s,e){return new Promise((r,i)=>{(async()=>{for(let n=0;n<1/0;n++)try{const o=await s(n);if(!e(n,null,o)){r(o);return}}catch(o){if(!e(n,o)){i(o);return}}})()})}function No(s){return("0"+s.toString(16)).substr(-2)}function Bo(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let i="";for(let n=0;n<56;n++)i+=t.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,No).join("")}async function Ho(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(r);return Array.from(i).map(n=>String.fromCharCode(n)).join("")}async function Wo(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Ho(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ee(s,e,t=!1){const r=Bo();let i=r;t&&(i+="/PASSWORD_RECOVERY"),await is(s,`${e}-code-verifier`,i);const n=await Wo(r);return[n,r===n?"plain":"s256"]}const Jo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Vo(s){const e=s.headers.get(Rt);if(!e||!e.match(Jo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Go(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function Ko(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Qo=globalThis&&globalThis.__rest||function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(s);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(s,r[i])&&(t[r[i]]=s[r[i]]);return t};const ve=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Xo=[502,503,504];async function _r(s){var e;if(!Fo(s))throw new Pt(ve(s),0);if(Xo.includes(s.status))throw new Pt(ve(s),s.status);let t;try{t=await s.json()}catch(n){throw new ts(ve(n),n)}let r;const i=Vo(s);if(i&&i.getTime()>=es["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new pr(ve(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ae}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0))throw new pr(ve(t),s.status,t.weak_password.reasons);throw new To(ve(t),s.status||500,r)}const Zo=(s,e,t,r)=>{const i={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),t))};async function j(s,e,t,r){var i;const n=Object.assign({},r==null?void 0:r.headers);n[Rt]||(n[Rt]=es["2024-01-01"].name),r!=null&&r.jwt&&(n.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Yo(s,e,t+a,{headers:n,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Yo(s,e,t,r,i,n){const o=Zo(e,r,i,n);let a;try{a=await s(t,Object.assign({},o))}catch(l){throw console.error(l),new Pt(ve(l),0)}if(a.ok||await _r(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await _r(l)}}function le(s){var e;let t=null;sa(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=Lo(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function wr(s){const e=le(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function he(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function ea(s){return{data:s,error:null}}function ta(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:n}=s,o=Qo(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:n},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function ra(s){return s}function sa(s){return s.access_token&&s.refresh_token&&s.expires_in}var ia=globalThis&&globalThis.__rest||function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(s);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(s,r[i])&&(t[r[i]]=s[r[i]]);return t};class na{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ss(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await j(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await j(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:he})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=ia(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await j(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:ta,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(b(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await j(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:he})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,i,n,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await j(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(n=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:ra});if(u.error)throw u.error;const d=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return g.length>0&&(g.forEach(m=>{const _=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=_}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(b(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await j(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:he})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await j(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:he})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await j(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:he})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await j(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:r}}catch(t){if(b(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await j(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}}const oa={getItem:s=>Be()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{Be()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{Be()&&globalThis.localStorage.removeItem(s)}};function yr(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function aa(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $e={debug:!!(globalThis&&Be()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ns extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class la extends ns{}async function ca(s,e,t){$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),$e.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return await t()}finally{$e.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}}else{if(e===0)throw $e.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new la(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if($e.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}aa();const ua={url:bo,storageKey:xo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ko,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function br(s,e,t){return await t()}class He{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=He.nextInstanceID,He.nextInstanceID+=1,this.instanceID>0&&Z()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},ua),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new na({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=ss(i.fetch),this.lock=i.lock||br,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Z()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=ca:this.lock=br,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Be()?this.storage=oa:(this.memoryStorage={},this.storage=yr(this.memoryStorage)):(this.memoryStorage={},this.storage=yr(this.memoryStorage)),Z()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async n=>{this._debug("received broadcast notification from other tab or client",n),await this._notifyAllSubscribers(n.data.event,n.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Mo(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Z()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:n}=await this._getSessionFromURL(t,r);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),Co(n)){const l=(e=n.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return b(t)?{error:t}:{error:new ts("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{const n=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:le}),{data:o,error:a}=n;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(b(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,r,i;try{let n;if("email"in e){const{email:u,password:d,options:f}=e;let g=null,m=null;this.flowType==="pkce"&&([g,m]=await Ee(this.storage,this.storageKey)),n=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:m},xform:le})}else if("phone"in e){const{phone:u,password:d,options:f}=e;n=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:le})}else throw new Qe("You must provide either an email or phone number and a password");const{data:o,error:a}=n;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(b(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:o,options:a}=e;t=await j(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:wr})}else if("phone"in e){const{phone:n,password:o,options:a}=e;t=await j(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:wr})}else throw new Qe("You must provide either an email or phone number and a password");const{data:r,error:i}=t;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new _t}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(n=e.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ze(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(t??"").split("/");try{const{data:n,error:o}=await j(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:le});if(await Ye(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!n||!n.session||!n.user?{data:{user:null,session:null,redirectType:null},error:new _t}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign(Object.assign({},n),{redirectType:i??null}),error:o})}catch(n){if(b(n))return{data:{user:null,session:null,redirectType:null},error:n};throw n}}async signInWithIdToken(e){try{const{options:t,provider:r,token:i,access_token:n,nonce:o}=e,a=await j(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:n,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:le}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new _t}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,i,n,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ee(this.storage,this.storageKey));const{error:d}=await j(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await j(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Qe("You must provide either an email or phone number.")}catch(a){if(b(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let i,n;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,n=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await j(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:le});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,r,i;try{let n=null,o=null;return this.flowType==="pkce"&&([n,o]=await Ee(this.storage,this.storageKey)),await j(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:o}),headers:this.headers,xform:ea})}catch(n){if(b(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ae;const{error:i}=await j(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(b(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:n}=e,{error:o}=await j(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},redirectTo:n==null?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:n}=e,{data:o,error:a}=await j(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Qe("You must provide either an email or phone number and a type")}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ze(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<vt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await j(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:he}):await this._useSession(async t=>{var r,i,n;const{data:o,error:a}=t;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ae}:await j(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0,xform:he})})}catch(t){if(b(t))return $o(t)&&(await this._removeSession(),await Ye(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:i,error:n}=r;if(n)throw n;if(!i.session)throw new ae;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ee(this.storage,this.storageKey));const{data:c,error:u}=await j(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:he});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ae;const t=Date.now()/1e3;let r=t,i=!0,n=null;const{payload:o}=yt(e.access_token);if(o.exp&&(r=o.exp,i=r<=t),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};n=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;n={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(b(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ae;const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Z())throw new Xe("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xe(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new fr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Xe("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new fr("No code detected.");const{data:P,error:A}=await this._exchangeCodeForSession(e.code);if(A)throw A;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:n,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!n||!a||!o||!c)throw new Xe("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let f=u+d;l&&(f=parseInt(l));const g=f-u;g*1e3<=Ce&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${d}s`);const m=f-d;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,u);const{data:_,error:v}=await this._getUser(n);if(v)throw v;const E={provider_token:r,provider_refresh_token:i,access_token:n,expires_in:d,expires_at:f,refresh_token:o,token_type:c,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:e.type},error:null}}catch(r){if(b(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ze(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:i,error:n}=t;if(n)return{error:n};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Eo(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Ye(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Uo(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{const{data:{session:n},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(n){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Ee(this.storage,this.storageKey,!0));try{return await j(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(b(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:i}=await this._useSession(async n=>{var o,a,l,c,u;const{data:d,error:f}=n;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await j(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Z()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(b(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;const{data:n,error:o}=t;if(o)throw o;return await j(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await zo(async i=>(i>0&&await qo(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await j(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:le})),(i,n)=>{const o=200*Math.pow(2,i);return n&&wt(n)&&Date.now()+o-r<Ce})}catch(r){if(this._debug(t,"error",r),b(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Z()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Ze(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<vt;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${vt}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:n}=await this._callRefreshToken(r.refresh_token);n&&(console.error(n),wt(n)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",n),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ae;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new ct;const{data:n,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!n.session)throw new ae;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const a={session:n.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(n){if(this._debug(i,"error",n),b(n)){const o={session:null,error:n};return wt(n)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(n),n}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){n.push(l)}});if(await Promise.all(o),n.length>0){for(let a=0;a<n.length;a+=1)console.error(n[a]);throw n[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await is(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ye(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Z()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ce);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Ce);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ce}ms, refresh threshold is ${Ct} ticks`),i<=Ct&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ns)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Z()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const i=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[n,o]=await Ee(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(r!=null&&r.queryParams){const n=new URLSearchParams(r.queryParams);i.push(n.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:i,error:n}=t;return n?{data:null,error:n}:await j(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;const{data:n,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await j(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:n}=t;if(n)return{data:null,error:n};const{data:o,error:a}=await j(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:n}=t;return n?{data:null,error:n}:await j(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),n=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=yt(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(t=i.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+jo>Date.now()))return r;const{data:i,error:n}=await j(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;if(!i.keys||i.keys.length===0)throw new Ne("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),r=i.keys.find(o=>o.kid===e),!r)throw new Ne("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:g,error:m}=await this.getSession();if(m||!g.session)return{data:null,error:m};r=g.session.access_token}const{header:i,payload:n,signature:o,raw:{header:a,payload:l}}=yt(r);if(Go(n.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:n,header:i,signature:o},error:null}}const c=Ko(i.alg),u=await this.fetchJwk(i.kid,t),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,Do(`${a}.${l}`)))throw new Ne("Invalid JWT signature");return{data:{claims:n,header:i,signature:o},error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}}He.nextInstanceID=0;const ha=He;class da extends ha{constructor(e){super(e)}}var fa=globalThis&&globalThis.__awaiter||function(s,e,t,r){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?n(u.value):i(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class pa{constructor(e,t,r){var i,n,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=wo(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:uo,realtime:fo,auth:Object.assign(Object.assign({},ho),{storageKey:l}),global:co},u=yo(r??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(n=u.global.headers)!==null&&n!==void 0?n:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=vo(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Pn(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new an(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new oo(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return fa(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:n,flowType:o,lock:a,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new da({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Jn(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ga=(s,e,t)=>new pa(s,e,t),os="https://xnknzqyhdvthchbmbqop.supabase.co",ma="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhua256cXloZHZ0aGNoYm1icW9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4NTUwODEsImV4cCI6MjA2MDQzMTA4MX0.5xAG3BEZcWP71lNB6Gh1HgIiLDR6oaAJ2NNnQ50s0i4";console.log("Initializing Supabase client with URL:",os);const C=ga(os,ma),W={async getMessages(){console.log("正在获取消息列表...");try{const{data:s,error:e}=await C.from("messages").select(`
          id,
          text,
          original_text,
          user_id,
          created_at,
          is_pinned
        `).order("created_at",{ascending:!1});if(e)throw console.error("获取消息失败:",e),e;if(!s)return console.log("没有找到任何消息"),[];console.log("成功获取原始消息:",s.length,"条");const t=await Promise.all(s.map(async i=>{try{const{data:n,error:o}=await C.from("message_reactions").select("id").eq("message_id",i.id).eq("is_like",!0);if(o)return console.error(`获取消息 ${i.id} 的点赞数失败:`,o),{...i,reactions:{likes:0,dislikes:0},reply_count:0};const{data:a,error:l}=await C.from("message_reactions").select("id").eq("message_id",i.id).eq("is_like",!1);if(l)return console.error(`获取消息 ${i.id} 的点踩数失败:`,l),{...i,reactions:{likes:0,dislikes:0},reply_count:0};const{data:c,error:u}=await C.from("message_replies").select("id").eq("message_id",i.id);return u?(console.error(`获取消息 ${i.id} 的回复数失败:`,u),{...i,reactions:{likes:(n==null?void 0:n.length)||0,dislikes:(a==null?void 0:a.length)||0},reply_count:0}):{...i,reactions:{likes:(n==null?void 0:n.length)||0,dislikes:(a==null?void 0:a.length)||0},reply_count:(c==null?void 0:c.length)||0}}catch(n){return console.error(`处理消息 ${i.id} 的数据时出错:`,n),{...i,reactions:{likes:0,dislikes:0},reply_count:0}}}));console.log("成功获取所有消息的反应数据");const r=t.sort((i,n)=>{var l,c;if(i.user_id==="admin"&&n.user_id!=="admin")return-1;if(i.user_id!=="admin"&&n.user_id==="admin")return 1;if(i.user_id==="admin"&&n.user_id==="admin")return new Date(n.created_at)-new Date(i.created_at);if(i.is_pinned&&!n.is_pinned)return-1;if(!i.is_pinned&&n.is_pinned)return 1;const o=((l=i.reactions)==null?void 0:l.likes)||0,a=((c=n.reactions)==null?void 0:c.likes)||0;return o!==a?a-o:new Date(n.created_at)-new Date(i.created_at)});return console.log(`成功获取并排序 ${r.length} 条消息`),r}catch(s){throw console.error("获取消息时发生错误:",s),new Error("获取消息失败: "+(s.message||"未知错误"))}},async getTopMessages(){console.log("正在获取热门消息...");try{const{data:s,error:e}=await C.from("messages").select("*");if(e)throw console.error("获取热门消息失败:",e),e;const r=(await Promise.all(s.map(async i=>{const{data:n,error:o}=await C.from("message_reactions").select("id").eq("message_id",i.id).eq("is_like",!0),{data:a,error:l}=await C.from("message_reactions").select("id").eq("message_id",i.id).eq("is_like",!1);return o&&console.error("获取点赞数失败:",o),l&&console.error("获取点踩数失败:",l),{...i,likes:(n==null?void 0:n.length)||0,dislikes:(a==null?void 0:a.length)||0}}))).sort((i,n)=>n.likes-i.likes).slice(0,3);return console.log("成功获取热门消息:",r),r}catch(s){throw console.error("获取热门消息时发生错误:",s),new Error("获取热门消息失败: "+(s.message||"未知错误"))}},async checkUserReactionLimit(s){console.log("正在检查用户24小时内的反应次数:",s);try{const e=new Date(Date.now()-864e5).toISOString(),{count:t,error:r}=await C.from("message_reactions").select("*",{count:"exact",head:!0}).eq("user_id",s).gte("created_at",e);if(r)throw console.error("检查反应次数失败:",r),r;return console.log("用户24小时内的反应次数:",t),t||0}catch(e){throw console.error("检查反应次数时发生错误:",e),new Error("检查反应次数失败: "+(e.message||"未知错误"))}},async addReaction(s,e,t){console.log("正在添加反应:",{messageId:s,userId:e,isLike:t});try{if(await this.checkUserReactionLimit(e)>=50)throw new Error("您在24小时内的点赞/点踩次数已达到上限(50次)");const{error:i}=await C.from("message_reactions").insert([{message_id:s,user_id:e,is_like:t,created_at:new Date().toISOString()}]);if(i)throw i;return{action:"added"}}catch(r){throw console.error("添加反应时发生错误:",r),new Error(r.message||"添加反应失败: 未知错误")}},async getMessageReactions(s){console.log("正在获取消息反应统计:",s);try{const{data:e,error:t}=await C.from("message_reactions").select("is_like").eq("message_id",s);if(t)throw console.error("获取反应统计失败:",t),t;const r=e.filter(n=>n.is_like).length,i=e.filter(n=>!n.is_like).length;return{likes:r,dislikes:i,total:r+i}}catch(e){throw console.error("获取反应统计时发生错误:",e),new Error("获取反应统计失败: "+(e.message||"未知错误"))}},async checkDuplicateMessage(s,e){console.log("正在检查是否存在重复消息:",{userId:e});try{const{data:t,error:r}=await C.from("messages").select("*").eq("text",s).eq("user_id",e).limit(1);if(r)throw console.error("检查重复消息失败:",r),r;return t&&t.length>0}catch(t){throw console.error("检查重复消息时发生错误:",t),new Error("检查重复消息失败: "+(t.message||"未知错误"))}},async createMessage({text:s,userId:e,originalText:t}){var r;console.log("正在创建新消息:",{text:s,userId:e});try{if(await this.checkDuplicateMessage(s,e))throw new Error("您已经发送过相同的留言了");const{data:n,error:o}=await C.from("messages").insert([{text:s,user_id:e,original_text:t,created_at:new Date().toISOString()}]).select();if(o)throw console.error("创建消息失败:",o),o;return console.log("消息创建成功:",(r=n==null?void 0:n[0])==null?void 0:r.id),n[0]}catch(i){throw console.error("创建消息时发生错误:",i),new Error(i.message||"创建消息失败")}},async deleteMessage(s,e,t){console.log("正在删除消息:",{messageId:s,userId:e,isAdmin:t});try{const{data:r,error:i}=await C.from("messages").select("*").eq("id",s).single();if(i)throw console.error("查找消息失败:",i),new Error("查找消息时出错");if(!r)throw console.error("消息不存在:",s),new Error("消息不存在");if(!t&&r.user_id!==e)throw console.error("无权限删除:",{messageUserId:r.user_id,userId:e}),new Error("您没有权限删除此消息");const{error:n}=await C.from("messages").delete().eq("id",s);if(n)throw console.error("删除消息失败:",n),new Error("删除消息时出错");return console.log("消息删除成功:",s),!0}catch(r){throw console.error("删除消息时发生错误:",r),new Error("删除消息失败: "+(r.message||"未知错误"))}},async countUserMessagesInLast24Hours(s){console.log("正在统计用户24小时内的留言数:",s);try{const e=new Date(Date.now()-864e5).toISOString(),{count:t,error:r}=await C.from("messages").select("*",{count:"exact",head:!0}).eq("user_id",s).gte("created_at",e);if(r)throw console.error("统计消息数量失败:",r),r;return console.log("用户24小时内的留言数:",t),t||0}catch(e){return console.error("统计消息数量时发生错误:",e),1/0}},async toggleMessagePin(s,e){console.log("正在切换消息置顶状态:",{messageId:s,isPinned:e});try{const{data:t,error:r}=await C.from("messages").update({is_pinned:e}).eq("id",s).select().single();if(r)throw console.error("切换置顶状态失败:",r),r;return console.log("消息置顶状态已更新:",t),t}catch(t){throw console.error("切换置顶状态时发生错误:",t),new Error("切换置顶状态失败: "+(t.message||"未知错误"))}},async getMessageReplies(s){console.log("正在获取消息回复:",s);try{const{data:e,error:t}=await C.from("message_replies").select(`
          id,
          message_id,
          user_id,
          text,
          original_text,
          created_at,
          is_admin
        `).eq("message_id",s).order("created_at",{ascending:!0});return t?(console.error("获取回复失败:",t),[]):e||[]}catch(e){return console.error("获取回复时发生错误:",e),[]}},async createReply({messageId:s,userId:e,text:t,originalText:r}){var i;console.log("正在创建回复:",{messageId:s,userId:e});try{if(e!=="admin"&&await this.countUserMessagesAndRepliesInLast24Hours(e)>=6)throw new Error("您在24小时内的留言和回复总数已达到上限(6条)");const{data:n,error:o}=await C.from("message_replies").insert([{message_id:s,user_id:e,text:t,original_text:r,is_admin:e==="admin",created_at:new Date().toISOString()}]).select();if(o)throw console.error("创建回复失败:",o),o;return console.log("回复创建成功:",(i=n==null?void 0:n[0])==null?void 0:i.id),n[0]}catch(n){throw console.error("创建回复时发生错误:",n),new Error(n.message||"创建回复失败")}},async deleteReply(s,e,t){console.log("正在删除回复:",{replyId:s,userId:e,isAdmin:t});try{const{data:r,error:i}=await C.from("message_replies").select("*").eq("id",s).single();if(i)throw console.error("查找回复失败:",i),new Error("查找回复时出错");if(!r)throw console.error("回复不存在:",s),new Error("回复不存在");if(!t&&r.user_id!==e)throw console.error("无权限删除:",{replyUserId:r.user_id,userId:e}),new Error("您没有权限删除此回复");const{error:n}=await C.from("message_replies").delete().eq("id",s);if(n)throw console.error("删除回复失败:",n),new Error("删除回复时出错");return console.log("回复删除成功:",s),!0}catch(r){throw console.error("删除回复时发生错误:",r),new Error("删除回复失败: "+(r.message||"未知错误"))}},async countUserMessagesAndRepliesInLast24Hours(s){console.log("正在统计用户24小时内的留言和回复数:",s);try{const e=new Date(Date.now()-864e5).toISOString(),{count:t,error:r}=await C.from("messages").select("*",{count:"exact",head:!0}).eq("user_id",s).gte("created_at",e);if(r)throw r;const{count:i,error:n}=await C.from("message_replies").select("*",{count:"exact",head:!0}).eq("user_id",s).gte("created_at",e);if(n)throw n;const o=(t||0)+(i||0);return console.log("用户24小时内的总数:",o),o}catch(e){return console.error("统计留言和回复数量时发生错误:",e),1/0}},async updateReactionCount(s,e,t){console.log(`正在更新消息 ${s} 的${e==="likes"?"点赞":"点踩"}数量为 ${t}`);try{if(!s)throw new Error("消息ID不能为空");if(t<0)throw new Error("反应数量不能为负数");const{data:r,error:i}=await C.from("messages").select("id").eq("id",s).single();if(i)throw console.error("获取消息失败:",i),new Error("获取消息失败");if(!r)throw new Error("消息不存在");const{error:n}=await C.from("message_reactions").delete().eq("message_id",s).eq("is_like",e==="likes");if(n)throw console.error("删除现有反应失败:",n),new Error("更新反应数量失败");if(t>0){const o=Array.from({length:t},(l,c)=>({message_id:s,user_id:`admin_reaction_${c}`,is_like:e==="likes",created_at:new Date().toISOString()})),{error:a}=await C.from("message_reactions").insert(o);if(a)throw console.error("添加新反应失败:",a),new Error("更新反应数量失败")}return console.log(`成功更新${e==="likes"?"点赞":"点踩"}数量为 ${t}`),!0}catch(r){throw console.error(`更新${e==="likes"?"点赞":"点踩"}数量失败:`,r),new Error(`更新${e==="likes"?"点赞":"点踩"}数量失败: ${r.message||"未知错误"}`)}}},L=[];for(let s=0;s<256;++s)L.push((s+256).toString(16).slice(1));function va(s,e=0){return(L[s[e+0]]+L[s[e+1]]+L[s[e+2]]+L[s[e+3]]+"-"+L[s[e+4]]+L[s[e+5]]+"-"+L[s[e+6]]+L[s[e+7]]+"-"+L[s[e+8]]+L[s[e+9]]+"-"+L[s[e+10]]+L[s[e+11]]+L[s[e+12]]+L[s[e+13]]+L[s[e+14]]+L[s[e+15]]).toLowerCase()}let bt;const _a=new Uint8Array(16);function wa(){if(!bt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");bt=crypto.getRandomValues.bind(crypto)}return bt(_a)}const ya=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xr={randomUUID:ya};function kr(s,e,t){var i;if(xr.randomUUID&&!e&&!s)return xr.randomUUID();s=s||{};const r=s.random??((i=s.rng)==null?void 0:i.call(s))??wa();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[t+n]=r[n];return e}return va(r)}const ba=_s({palette:{primary:{main:"#ff69b4",light:"#ff8dc3",dark:"#c13b86"},secondary:{main:"#4a148c",light:"#7c43bd",dark:"#12005e"},background:{default:"#fce4ec",paper:"#ffffff"}},typography:{fontFamily:"inherit",h3:{fontFamily:'"Press Start 2P", cursive',fontWeight:700,color:"#ff69b4",textShadow:"2px 2px 0 #4a148c",textAlign:"center",marginBottom:"2rem"}},components:{MuiPaper:{styleOverrides:{root:{borderRadius:"12px",border:"4px solid #ff69b4",boxShadow:"4px 4px 0 rgba(74, 20, 140, 0.5)",transition:"transform 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)"}}}},MuiButton:{styleOverrides:{root:{fontFamily:"inherit",border:"3px solid #ff69b4",boxShadow:"3px 3px 0 rgba(74, 20, 140, 0.5)","&:hover":{transform:"translate(-2px, -2px)",boxShadow:"5px 5px 0 rgba(74, 20, 140, 0.5)"},"&:active":{transform:"translate(2px, 2px)",boxShadow:"1px 1px 0 rgba(74, 20, 140, 0.5)"}}}}}}),Sr=s=>{const e=/1[3-9]\d{9}/g,t=new RegExp("(?<![a-zA-Z0-9])[a-zA-Z][a-zA-Z0-9_-]{5,19}","g"),r=new RegExp("(?<!\\d)[1-9][0-9]{4,10}(?!\\d)","g"),i=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,n=["王晓然","wangxiaoran","wang xiaoran","王晓玥","wangxiaoyue","wang xiaoyue","SOAP","soap","Soap","女装","nvzhuang","nu zhuang","塔罗牌","taluopai","taluo pai","tarot","宏程","hongcheng","hong cheng","王老师","wanglaoshi","wang laoshi"];let o=s;return o=o.replace(e,a=>"*".repeat(a.length)),o=o.replace(t,a=>"*".repeat(a.length)),o=o.replace(r,a=>"*".repeat(a.length)),o=o.replace(i,a=>"*".repeat(a.length)),n.forEach(a=>{const l=new RegExp(a,"gi");o=o.replace(l,c=>"*".repeat(c.length))}),o},xa=({reply:s,onDelete:e,isOwner:t,isAdminMessage:r})=>h.jsxs(tt,{sx:{p:{xs:1,sm:1.5},ml:{xs:2,sm:3},mb:1,backgroundColor:r?"#4a148c":"#fff0f5",border:`2px solid ${r?"#7c43bd":"#ff69b4"}`,boxShadow:"2px 2px 0 rgba(255, 105, 180, 0.3)",position:"relative","&::before":{content:'""',position:"absolute",left:"-10px",top:"10px",width:"0",height:"0",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderRight:`10px solid ${r?"#4a148c":"#ff69b4"}`}},children:[h.jsx(U,{variant:"body2",sx:{wordBreak:"break-word",color:r?"#ffffff":"inherit",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:s.text}),t&&h.jsx(se,{onClick:e,size:"small",sx:{position:"absolute",right:4,top:4,padding:.5,color:r?"#ffffff":"#ff69b4","&:hover":{color:"#ff8dc3"}},children:h.jsx(Lt,{sx:{fontSize:"0.875rem"}})})]}),ka=({message:s,originalText:e,onDelete:t,isOwner:r,isAdminMessage:i,onReact:n,reactions:o,isPinned:a,onTogglePin:l,isAdmin:c,onReply:u,replies:d=[],onDeleteReply:f,currentUserId:g,onEditReactions:m,messageId:_})=>{const[v,E]=x.useState(!1),[P,A]=x.useState(""),[y,O]=x.useState(!1),ee=I=>{I.preventDefault(),P.trim()&&(u(P.trim()),A(""),O(!1))};return h.jsxs(tt,{className:`pixel-bubble ${i?"admin-bubble":""} ${a?"pinned-bubble":""}`,sx:{p:{xs:1.5,sm:2},height:"auto",display:"flex",flexDirection:"column",position:"relative",animation:"float 3s ease-in-out infinite",animationDelay:`${Math.random()*2}s`,...i&&{backgroundColor:"#4a148c !important",border:"4px solid #7c43bd",boxShadow:"4px 4px 0 rgba(255, 105, 180, 0.5)","& .MuiTypography-root:not(.reaction-count)":{color:"#ff8dc3",fontWeight:"bold",position:"relative"}},...a&&{border:"2px solid #ff69b4","&::before":{content:'"📌"',position:"absolute",top:"-10px",right:"-10px",fontSize:"20px",transform:"rotate(45deg)"}}},children:[h.jsxs(R,{sx:{flex:1},children:[h.jsx(U,{variant:"body1",sx:{wordBreak:"break-word",fontSize:{xs:"0.875rem",sm:"1rem"}},children:s}),i&&e!==s&&h.jsxs(U,{variant:"caption",sx:{display:"block",mt:1,color:"#ff69b4",fontStyle:"italic",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:["原文: ",e]})]}),h.jsxs(R,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:{xs:1.5,sm:2},pt:{xs:1,sm:1},borderTop:"1px solid rgba(0,0,0,0.1)"},children:[h.jsxs(R,{sx:{display:"flex",gap:{xs:1,sm:2}},children:[h.jsxs(R,{sx:{display:"flex",alignItems:"center"},children:[h.jsx(se,{size:"small",onClick:()=>n(!0),sx:{color:"#ff69b4",padding:{xs:.5,sm:1},"&:hover":{color:"#ff8dc3",transform:"scale(1.1)"},transition:"transform 0.2s ease, color 0.2s ease",...i&&{color:"#ffffff","&:hover":{color:"#ff8dc3",transform:"scale(1.1)"}}},title:"点赞",children:h.jsx(Ft,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}})}),h.jsx(U,{variant:"caption",className:"reaction-count",sx:{ml:.5,color:i?"#ffffff":"#ff69b4",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:(o==null?void 0:o.likes)||0}),c&&h.jsx(se,{size:"small",onClick:()=>m(_,"likes",(o==null?void 0:o.likes)||0),sx:{color:i?"#ffffff":"#ff69b4",padding:{xs:.2,sm:.5},ml:.5,"&:hover":{color:"#ff8dc3",transform:"scale(1.1)"}},title:"修改点赞数",children:h.jsx(kt,{sx:{fontSize:{xs:"0.75rem",sm:"1rem"}}})})]}),h.jsxs(R,{sx:{display:"flex",alignItems:"center"},children:[h.jsx(se,{size:"small",onClick:()=>n(!1),sx:{color:"#ff69b4",padding:{xs:.5,sm:1},"&:hover":{color:"#ff8dc3",transform:"scale(1.1)"},transition:"transform 0.2s ease, color 0.2s ease",...i&&{color:"#ffffff","&:hover":{color:"#ff8dc3",transform:"scale(1.1)"}}},title:"点踩",children:h.jsx(zt,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}})}),h.jsx(U,{variant:"caption",className:"reaction-count",sx:{ml:.5,color:i?"#ffffff":"#ff69b4",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:(o==null?void 0:o.dislikes)||0}),c&&h.jsx(se,{size:"small",onClick:()=>m(_,"dislikes",(o==null?void 0:o.dislikes)||0),sx:{color:i?"#ffffff":"#ff69b4",padding:{xs:.2,sm:.5},ml:.5,"&:hover":{color:"#ff8dc3",transform:"scale(1.1)"}},title:"修改点踩数",children:h.jsx(kt,{sx:{fontSize:{xs:"0.75rem",sm:"1rem"}}})})]}),h.jsxs(se,{size:"small",onClick:()=>O(!y),sx:{color:"#ff69b4",padding:{xs:.5,sm:1},"&:hover":{color:"#ff8dc3",transform:"scale(1.1)"},transition:"transform 0.2s ease, color 0.2s ease",...i&&{color:"#ffffff","&:hover":{color:"#ff8dc3",transform:"scale(1.1)"}}},title:"回复",children:[h.jsx(Ar,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}}),h.jsx(U,{variant:"caption",className:"reaction-count",sx:{ml:.5,color:i?"#ffffff":"#ff69b4",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:d.length})]})]}),h.jsxs(R,{sx:{display:"flex",gap:{xs:.5,sm:1}},children:[d.length>0&&h.jsx(se,{size:"small",onClick:()=>E(!v),sx:{padding:{xs:.5,sm:1},color:i?"#ffffff":"#ff69b4","&:hover":{color:"#ff8dc3"}},children:v?h.jsx(Dr,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}}):h.jsx(Ir,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}})}),c&&!i&&h.jsx(se,{size:"small",onClick:()=>l(!a),sx:{padding:{xs:.5,sm:1},color:a?"#ff69b4":"inherit","&:hover":{color:"#ff69b4"}},children:h.jsx(Or,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"},transform:a?"rotate(45deg)":"none",transition:"transform 0.3s ease"}})}),r&&h.jsx(se,{onClick:t,size:"small",sx:{padding:{xs:.5,sm:1},color:i?"#ffffff":"#ff69b4","&:hover":{color:i?"#ff69b4":"#ff8dc3",transform:"scale(1.1)"}},children:h.jsx(Lt,{sx:{fontSize:{xs:"1rem",sm:"1.25rem"}}})})]})]}),y&&h.jsxs(R,{component:"form",onSubmit:ee,sx:{mt:2,display:"flex",gap:1,borderTop:"1px solid rgba(0,0,0,0.1)",pt:2},children:[h.jsx(xt,{size:"small",fullWidth:!0,value:P,onChange:I=>A(I.target.value),placeholder:"回复...",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#ff69b4",borderWidth:"2px"},"&:hover fieldset":{borderColor:"#ff69b4"},"&.Mui-focused fieldset":{borderColor:"#ff69b4"}}}}),h.jsx(ce,{type:"submit",variant:"contained",size:"small",sx:{minWidth:"unset",backgroundColor:"#ff69b4",color:"white","&:hover":{backgroundColor:"#ff8dc3"}},children:"发送"})]}),v&&d.length>0&&h.jsx(R,{sx:{mt:2},children:d.map(I=>h.jsx(xa,{reply:I,onDelete:()=>f(I.id),isOwner:c||I.user_id===g,isAdminMessage:I.is_admin},I.id))})]})},Sa=({messages:s})=>h.jsxs(tt,{sx:{p:2,width:"100%",boxSizing:"border-box",margin:0,"& > *:last-child":{marginBottom:0}},className:"pixel-theme-pink",elevation:0,children:[h.jsxs(R,{sx:{display:"flex",alignItems:"center",mb:2},children:[h.jsx(Pr,{sx:{color:"#ff69b4",mr:1}}),h.jsx(U,{variant:"h6",sx:{color:"#ff69b4"},children:"热门留言榜"})]}),h.jsx(Ns,{sx:{mb:2}}),h.jsxs(R,{sx:{display:"flex",flexDirection:"column",gap:2},children:[s.map((e,t)=>h.jsxs(R,{sx:{p:1.5,borderRadius:1,backgroundColor:"rgba(255, 105, 180, 0.1)",border:"2px solid rgba(255, 105, 180, 0.2)",position:"relative","&:hover":{backgroundColor:"rgba(255, 105, 180, 0.15)"}},children:[h.jsx(R,{sx:{position:"absolute",top:-10,left:-10,width:24,height:24,borderRadius:"50%",backgroundColor:"#ff69b4",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"0.8rem",fontWeight:"bold",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:t+1}),h.jsxs(U,{variant:"subtitle2",sx:{color:"#ff69b4",mb:.5,display:"flex",alignItems:"center",gap:1},children:[h.jsxs(R,{sx:{display:"flex",alignItems:"center",gap:.5},children:[h.jsx(Ft,{sx:{fontSize:16}}),e.likes||0]}),h.jsxs(R,{sx:{display:"flex",alignItems:"center",gap:.5},children:[h.jsx(zt,{sx:{fontSize:16}}),e.dislikes||0]})]}),h.jsx(U,{variant:"body2",sx:{color:"text.secondary",...e.user_id==="admin"&&{color:"#4a148c",fontWeight:"bold"}},children:e.text})]},e.id)),s.length===0&&h.jsx(U,{variant:"body2",sx:{color:"text.secondary",textAlign:"center",py:2},children:"暂无热门留言"})]})]});class ja extends Er.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("MessageApp错误:",e,t)}render(){return this.state.hasError?h.jsxs(R,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#fce4ec",padding:3},children:[h.jsx(U,{variant:"h6",sx:{color:"#ff69b4",marginBottom:2},children:"页面加载出错了"}),h.jsx(ce,{variant:"contained",onClick:()=>window.location.reload(),sx:{backgroundColor:"#ff69b4","&:hover":{backgroundColor:"#ff8dc3"}},children:"刷新页面"})]}):this.props.children}}function Ta(){const[s,e]=x.useState([]),[t,r]=x.useState([]),[i,n]=x.useState(""),[o,a]=x.useState(!1),[l,c]=x.useState(""),[u,d]=x.useState(!1),[f,g]=x.useState(null),[m,_]=x.useState({}),[v,E]=x.useState({}),[P,A]=x.useState(!0),[y,O]=x.useState(!1),[ee,I]=x.useState(null),[ne,fe]=x.useState(!1),[F,te]=x.useState({open:!1,messageId:null,type:"likes",count:0}),[Se,V]=x.useState(0);x.useEffect(()=>(console.log("组件挂载"),O(!0),()=>{console.log("组件卸载"),O(!1)}),[]);const M=x.useCallback(async p=>{if(!f||!y){console.log("跳过获取回复：",{messageId:p,userId:!!f,isMounted:y});return}try{console.log("开始获取消息回复:",p);const w=await W.getMessageReplies(p);if(!y){console.log("组件已卸载，取消更新回复状态");return}console.log("成功获取回复:",p,(w==null?void 0:w.length)||0,"条"),E(k=>({...k,[p]:w||[]}))}catch(w){if(!y)return;console.error("获取回复失败:",p,w),E(k=>({...k,[p]:[]}))}},[f,y]),q=x.useCallback(async()=>{if(!f||!y){console.log("跳过获取消息：",{userId:!!f,isMounted:y});return}try{I(null),A(!0),console.log("开始获取消息列表...");const p=await W.getMessages();if(!y){console.log("组件已卸载，取消更新消息状态");return}console.log("获取到消息数据:",(p==null?void 0:p.length)||0,"条"),Array.isArray(p)?(e(p),p.forEach(w=>{console.log("准备获取消息回复:",w.id),M(w.id)})):(console.warn("获取到的消息数据格式不正确:",p),e([]))}catch(p){if(!y)return;console.error("获取消息失败:",p),I(p.message||"加载留言失败，请检查网络连接"),c(`加载留言失败：${p.message||"请检查网络连接"}`),a(!0),e([])}finally{y&&A(!1)}},[f,y,M]),pe=x.useCallback(async()=>{if(!f||!y){console.log("跳过获取热门消息：",{userId:!!f,isMounted:y});return}try{console.log("开始获取热门消息...");const p=await W.getTopMessages();if(!y){console.log("组件已卸载，取消更新热门消息状态");return}console.log("获取到热门消息:",(p==null?void 0:p.length)||0,"条"),r(p||[])}catch(p){if(!y){console.log("组件已卸载，取消更新热门消息错误状态");return}console.error("获取热门消息失败:",p),r([])}},[f,y]);x.useCallback(async p=>{try{const w=await W.getMessageReactions(p);_(k=>({...k,[p]:w}))}catch(w){console.error("获取消息反应失败:",w)}},[]),x.useEffect(()=>{var p;try{console.log("开始初始化用户ID...");let w=(p=document.cookie.match(/userId=([^;]+)/))==null?void 0:p[1],k;const T=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;if(w){let z=w;z.startsWith("user_")&&(console.log("移除 'user_' 前缀:",z),z=z.substring(5)),T.test(z)?(k=z,console.log("使用cookie中的有效UUID:",k)):(console.log("Cookie中的UUID格式无效，生成新的UUID"),k=kr())}else console.log("Cookie中未找到UUID，生成新的UUID"),k=kr();document.cookie=`userId=${k};path=/;max-age=31536000;SameSite=Lax`,console.log("设置用户ID:",k),g(k),fe(!0)}catch(w){console.error("初始化用户ID失败:",w),I("初始化用户ID失败，请刷新页面重试")}},[]),x.useEffect(()=>{f&&y&&ne&&(console.log("用户ID已设置，开始加载消息"),q(),pe())},[f,y,ne,q,pe]);const ut=async p=>{if(p.preventDefault(),i.trim()){if(i.trim().length>200){c("留言不能超过200字"),a(!0);return}if(!u)try{if(await W.countUserMessagesInLast24Hours(f)>=6){c("您今天留言已达上限（6条）"),a(!0);return}}catch(T){console.error("Error checking message limit:",T),c("检查留言频率时出错，请稍后再试"),a(!0);return}const k={text:u?i.trim():Sr(i.trim()),userId:u?"admin":f,originalText:i.trim()};try{await W.createMessage(k)?(await q(),n(""),c("留言成功！"),a(!0)):(c("留言似乎成功，但服务器未返回确认信息"),a(!0))}catch(T){if(console.error("详细错误信息:",T),T.message.includes("相同的留言"))c("您已经发送过相同的留言了");else{const z=(T==null?void 0:T.details)||(T==null?void 0:T.message)||(T==null?void 0:T.error_description)||"未知错误";c(`留言失败：${z}`)}a(!0)}}},Ve=()=>{const p=prompt("请输入管理员密码：");p==="Sangok#3"?(d(!0),c("管理员登录成功！"),a(!0)):p!==null&&(c("密码错误！"),a(!0))},je=async(p,w)=>{try{await W.addReaction(p,f,w),e(k=>k.map(T=>{if(T.id===p){const z={...T.reactions};return w?z.likes=(z.likes||0)+1:z.dislikes=(z.dislikes||0)+1,{...T,reactions:z}}return T})),r(k=>k.map(T=>T.id===p?w?{...T,likes:(T.likes||0)+1}:{...T,dislikes:(T.dislikes||0)+1}:T))}catch(k){console.error("反应操作失败:",k),c(k.message||"操作失败，请稍后重试"),a(!0)}},ht=async(p,w)=>{try{await W.toggleMessagePin(p,w),await q(),c(w?"消息已置顶":"消息已取消置顶"),a(!0)}catch(k){c(k.message||"操作失败"),a(!0)}},Ge=async(p,w)=>{try{const k=u?w:Sr(w);await W.createReply({messageId:p,userId:u?"admin":f,text:k,originalText:w}),await M(p),c("回复成功！"),a(!0)}catch(k){c(k.message||"回复失败"),a(!0)}},dt=async p=>{try{await W.deleteReply(p,f,u),s.forEach(w=>M(w.id)),c("回复删除成功！"),a(!0)}catch(w){c(w.message||"删除回复失败"),a(!0)}},ge=async(p,w)=>{console.log("Handling delete:",{messageId:p,messageUserId:w,userId:f,isAdmin:u});try{c("正在删除..."),a(!0);const k=await W.deleteMessage(p,f,u);console.log("Message deleted, success:",k),k&&(await q(),c("删除成功！"))}catch(k){console.error("删除消息时出错:",k),c(`删除失败：${k.message}`)}finally{a(!0)}},re=()=>{d(!1),c("已退出管理员模式！"),a(!0)},Ue=(p,w,k)=>{te({open:!0,messageId:p,type:w,count:k}),V(k)},Ke=async()=>{try{await W.updateReactionCount(F.messageId,F.type,Se)?(await q(),await pe(),c(`成功修改${F.type==="likes"?"点赞":"点踩"}数量`)):c("修改反应数量失败")}catch(p){console.error("修改反应数量失败:",p),c(p.message||"修改反应数量失败")}finally{a(!0),te({...F,open:!1})}},ft=()=>ne?ee?h.jsxs(R,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"200px",gap:2},children:[h.jsx(U,{variant:"h6",sx:{color:"#ff69b4"},children:ee}),h.jsx(ce,{variant:"contained",onClick:()=>{I(null),q()},sx:{backgroundColor:"#ff69b4","&:hover":{backgroundColor:"#ff8dc3"}},children:"重试"})]}):P?h.jsxs(R,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"200px",gap:2},children:[h.jsx(nr,{sx:{color:"#ff69b4"}}),h.jsx(U,{variant:"h6",sx:{color:"#ff69b4"},children:"加载中..."})]}):h.jsx(R,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},gap:{xs:2,sm:2,md:3},width:"100%"},children:s.length>0?s.map(p=>h.jsx(ka,{messageId:p.id,message:u?p.original_text:p.text,originalText:p.original_text,onDelete:()=>ge(p.id,p.user_id),isOwner:u||p.user_id===f,isAdminMessage:p.user_id==="admin",onReact:w=>je(p.id,w),reactions:p.reactions||{likes:0,dislikes:0},isPinned:p.is_pinned,onTogglePin:w=>ht(p.id,w),isAdmin:u,onReply:w=>Ge(p.id,w),replies:v[p.id]||[],onDeleteReply:dt,currentUserId:f,onEditReactions:Ue},p.id)):h.jsx(R,{sx:{gridColumn:"1 / -1",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px"},children:h.jsx(U,{variant:"h6",sx:{color:"#ff69b4"},children:"暂无留言"})})}):h.jsxs(R,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"200px",gap:2},children:[h.jsx(nr,{sx:{color:"#ff69b4"}}),h.jsx(U,{variant:"h6",sx:{color:"#ff69b4"},children:"正在初始化..."})]});return h.jsx(ja,{children:h.jsx(ws,{theme:ba,children:h.jsxs(R,{sx:{minHeight:"100vh",backgroundColor:"background.default",pb:"120px"},children:[h.jsx(ys,{position:"sticky",sx:{backgroundColor:"#fff0f5",border:"4px solid #ff69b4",borderBottom:"4px solid #ff69b4",boxShadow:"4px 4px 0 rgba(255, 105, 180, 0.5)",mb:3,zIndex:1100},className:"pixel-theme-pink",children:h.jsx(er,{maxWidth:"lg",children:h.jsxs(bs,{sx:{justifyContent:"space-between"},children:[h.jsx(U,{variant:"h6",className:"pixel-title-pink",sx:{color:"#ff69b4"},children:"留言板-XR无下限"}),h.jsxs(R,{sx:{display:"flex",gap:2},children:[u&&h.jsx(ce,{color:"inherit",startIcon:h.jsx(Rr,{}),onClick:re,className:"pixel-button-pink",sx:{color:"#ff69b4"},children:"退出管理"}),h.jsx(ce,{color:"inherit",startIcon:h.jsx(xs,{}),href:"/index.html",className:"pixel-button-pink",sx:{color:"#ff69b4"},children:"返回首页"})]})]})})}),h.jsxs(er,{maxWidth:"lg",sx:{display:"flex",flexDirection:"column",gap:3,position:"relative",minHeight:"calc(100vh - 200px)"},children:[h.jsx(U,{variant:"h3",className:"pixel-title-pink",sx:{mb:4,cursor:"default",userSelect:"none"},onDoubleClick:Ve,children:"I Love Dirty Talk"}),h.jsxs(R,{sx:{display:"flex",flexDirection:"column",gap:3,width:"100%",flexGrow:1,"& > *":{width:"100%",maxWidth:"100%"}},children:[h.jsx(R,{sx:{maxWidth:{md:"800px"},mx:"auto",width:"100%"},children:h.jsx(Sa,{messages:t})}),ft()]})]}),h.jsxs(tt,{component:"form",onSubmit:ut,sx:{p:{xs:1.5,sm:2},position:"fixed",bottom:0,left:0,right:0,display:"flex",gap:{xs:1,sm:2},alignItems:"center",backgroundColor:"#fff0f5",zIndex:1e3,borderTop:"4px solid #ff69b4",boxShadow:"0 -4px 0 rgba(255, 105, 180, 0.5)",maxHeight:"120px",overflowY:"auto"},className:"pixel-theme-pink",children:[h.jsx(xt,{fullWidth:!0,multiline:!0,rows:2,value:i,onChange:p=>n(p.target.value),placeholder:"说点什么...(最多200字)",variant:"outlined",inputProps:{maxLength:200},helperText:`${i.length}/200`,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#ff69b4",borderWidth:"3px"},"&:hover fieldset":{borderColor:"#ff69b4"},"&.Mui-focused fieldset":{borderColor:"#ff69b4"}}}}),h.jsx(ce,{type:"submit",variant:"contained",endIcon:h.jsx(Cr,{}),sx:{height:"100%",minWidth:{xs:"80px",sm:"100px"},backgroundColor:"#ff69b4",color:"white","&:hover":{backgroundColor:"#ff8dc3"}},className:"pixel-button-pink",children:"发送"})]}),h.jsxs(ks,{open:F.open,onClose:()=>te({...F,open:!1}),children:[h.jsxs(Ss,{sx:{color:"#ff69b4"},children:["修改",F.type==="likes"?"点赞":"点踩","数量"]}),h.jsx(js,{children:h.jsx(xt,{autoFocus:!0,margin:"dense",label:`${F.type==="likes"?"点赞":"点踩"}数量`,type:"number",fullWidth:!0,value:Se,onChange:p=>V(parseInt(p.target.value)||0),inputProps:{min:0},sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#ff69b4"},"&:hover fieldset":{borderColor:"#ff69b4"},"&.Mui-focused fieldset":{borderColor:"#ff69b4"}}}})}),h.jsxs(Ts,{children:[h.jsx(ce,{onClick:()=>te({...F,open:!1}),sx:{color:"#ff69b4"},children:"取消"}),h.jsx(ce,{onClick:Ke,sx:{backgroundColor:"#ff69b4",color:"white","&:hover":{backgroundColor:"#ff8dc3"}},children:"确认"})]})]}),h.jsx(Es,{open:o,autoHideDuration:3e3,onClose:()=>a(!1),message:l})]})})})}$s.createRoot(document.getElementById("root")).render(h.jsx(Er.StrictMode,{children:h.jsx(Ta,{})}));

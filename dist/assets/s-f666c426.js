import{r as p,u as X,v as J,w as K,_ as v,x as V,y as Z,j as e,z as ee,E as te,F as q,G as lt,H as he,J as it,c as ct,t as oe,T as dt,B as d,A as xt,C as $e,a as pt,d as ht,b as a,e as u,f as We,I as Me,g as ut,D as ft,L as mt,h as ae,i as ne,k as le,P as I,S as Ne,l as A,m as B,n as _,o as U,q as gt,p as bt,s as jt,R as yt}from"./v4-74551561.js";import{g as Y,a as ie,d as ve,C as Ce,b as Ie,c as vt,e as Ct,f as St,G as $,F as wt,R as Rt,P as kt,h as Tt,i as $t,j as Wt,r as Mt,s as Nt,k as It,l as Ht}from"./databaseDiagnostic-80cc373d.js";import{d as He,a as De,b as Dt,M as xe}from"./Message-321b40ed.js";import{d as ze}from"./Male-954eee75.js";import{d as Oe}from"./Female-84d5811b.js";/* empty css              */const zt=p.createContext(),Ee=zt;function Ot(s){return X("MuiTable",s)}J("MuiTable",["root","stickyHeader"]);const Pt=["className","component","padding","size","stickyHeader"],At=s=>{const{classes:r,stickyHeader:c}=s;return te({root:["root",c&&"stickyHeader"]},Ot,r)},Bt=K("table",{name:"MuiTable",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:c}=s;return[r.root,c.stickyHeader&&r.stickyHeader]}})(({theme:s,ownerState:r})=>v({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":v({},s.typography.body2,{padding:s.spacing(2),color:(s.vars||s).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},r.stickyHeader&&{borderCollapse:"separate"})),Pe="table",_t=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTable"}),{className:g,component:n=Pe,padding:m="normal",size:i="medium",stickyHeader:j=!1}=x,b=Z(x,Pt),w=v({},x,{component:n,padding:m,size:i,stickyHeader:j}),D=At(w),se=p.useMemo(()=>({padding:m,size:i,stickyHeader:j}),[m,i,j]);return e.jsx(Ee.Provider,{value:se,children:e.jsx(Bt,v({as:n,role:n===Pe?null:"table",ref:c,className:ee(D.root,g),ownerState:w},b))})}),Ut=_t,Et=p.createContext(),ue=Et;function Ft(s){return X("MuiTableBody",s)}J("MuiTableBody",["root"]);const Lt=["className","component"],Gt=s=>{const{classes:r}=s;return te({root:["root"]},Ft,r)},Qt=K("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(s,r)=>r.root})({display:"table-row-group"}),Yt={variant:"body"},Ae="tbody",qt=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTableBody"}),{className:g,component:n=Ae}=x,m=Z(x,Lt),i=v({},x,{component:n}),j=Gt(i);return e.jsx(ue.Provider,{value:Yt,children:e.jsx(Qt,v({className:ee(j.root,g),as:n,ref:c,role:n===Ae?null:"rowgroup",ownerState:i},m))})}),Xt=qt;function Jt(s){return X("MuiTableCell",s)}const Kt=J("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Vt=Kt,Zt=["align","className","component","padding","scope","size","sortDirection","variant"],es=s=>{const{classes:r,variant:c,align:x,padding:g,size:n,stickyHeader:m}=s,i={root:["root",c,m&&"stickyHeader",x!=="inherit"&&`align${q(x)}`,g!=="normal"&&`padding${q(g)}`,`size${q(n)}`]};return te(i,Jt,r)},ts=K("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:c}=s;return[r.root,r[c.variant],r[`size${q(c.size)}`],c.padding!=="normal"&&r[`padding${q(c.padding)}`],c.align!=="inherit"&&r[`align${q(c.align)}`],c.stickyHeader&&r.stickyHeader]}})(({theme:s,ownerState:r})=>v({},s.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:s.vars?`1px solid ${s.vars.palette.TableCell.border}`:`1px solid
    ${s.palette.mode==="light"?lt(he(s.palette.divider,1),.88):it(he(s.palette.divider,1),.68)}`,textAlign:"left",padding:16},r.variant==="head"&&{color:(s.vars||s).palette.text.primary,lineHeight:s.typography.pxToRem(24),fontWeight:s.typography.fontWeightMedium},r.variant==="body"&&{color:(s.vars||s).palette.text.primary},r.variant==="footer"&&{color:(s.vars||s).palette.text.secondary,lineHeight:s.typography.pxToRem(21),fontSize:s.typography.pxToRem(12)},r.size==="small"&&{padding:"6px 16px",[`&.${Vt.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},r.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},r.padding==="none"&&{padding:0},r.align==="left"&&{textAlign:"left"},r.align==="center"&&{textAlign:"center"},r.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},r.align==="justify"&&{textAlign:"justify"},r.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(s.vars||s).palette.background.default})),ss=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTableCell"}),{align:g="inherit",className:n,component:m,padding:i,scope:j,size:b,sortDirection:w,variant:D}=x,se=Z(x,Zt),R=p.useContext(Ee),F=p.useContext(ue),re=F&&F.variant==="head";let z;m?z=m:z=re?"th":"td";let O=j;z==="td"?O=void 0:!O&&re&&(O="col");const ce=D||F&&F.variant,P=v({},x,{align:g,component:z,padding:i||(R&&R.padding?R.padding:"normal"),size:b||(R&&R.size?R.size:"medium"),sortDirection:w,stickyHeader:ce==="head"&&R&&R.stickyHeader,variant:ce}),fe=es(P);let M=null;return w&&(M=w==="asc"?"ascending":"descending"),e.jsx(ts,v({as:z,ref:c,className:ee(fe.root,n),"aria-sort":M,scope:O,ownerState:P},se))}),S=ss;function rs(s){return X("MuiTableContainer",s)}J("MuiTableContainer",["root"]);const os=["className","component"],as=s=>{const{classes:r}=s;return te({root:["root"]},rs,r)},ns=K("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(s,r)=>r.root})({width:"100%",overflowX:"auto"}),ls=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTableContainer"}),{className:g,component:n="div"}=x,m=Z(x,os),i=v({},x,{component:n}),j=as(i);return e.jsx(ns,v({ref:c,as:n,className:ee(j.root,g),ownerState:i},m))}),is=ls;function cs(s){return X("MuiTableHead",s)}J("MuiTableHead",["root"]);const ds=["className","component"],xs=s=>{const{classes:r}=s;return te({root:["root"]},cs,r)},ps=K("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(s,r)=>r.root})({display:"table-header-group"}),hs={variant:"head"},Be="thead",us=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTableHead"}),{className:g,component:n=Be}=x,m=Z(x,ds),i=v({},x,{component:n}),j=xs(i);return e.jsx(ue.Provider,{value:hs,children:e.jsx(ps,v({as:n,className:ee(j.root,g),ref:c,role:n===Be?null:"rowgroup",ownerState:i},m))})}),fs=us;function ms(s){return X("MuiTableRow",s)}const gs=J("MuiTableRow",["root","selected","hover","head","footer"]),_e=gs,bs=["className","component","hover","selected"],js=s=>{const{classes:r,selected:c,hover:x,head:g,footer:n}=s;return te({root:["root",c&&"selected",x&&"hover",g&&"head",n&&"footer"]},ms,r)},ys=K("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:c}=s;return[r.root,c.head&&r.head,c.footer&&r.footer]}})(({theme:s})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${_e.hover}:hover`]:{backgroundColor:(s.vars||s).palette.action.hover},[`&.${_e.selected}`]:{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.selectedOpacity})`:he(s.palette.primary.main,s.palette.action.selectedOpacity),"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.primary.mainChannel} / calc(${s.vars.palette.action.selectedOpacity} + ${s.vars.palette.action.hoverOpacity}))`:he(s.palette.primary.main,s.palette.action.selectedOpacity+s.palette.action.hoverOpacity)}}})),Ue="tr",vs=p.forwardRef(function(r,c){const x=V({props:r,name:"MuiTableRow"}),{className:g,component:n=Ue,hover:m=!1,selected:i=!1}=x,j=Z(x,bs),b=p.useContext(ue),w=v({},x,{component:n,hover:m,selected:i,head:b&&b.variant==="head",footer:b&&b.variant==="footer"}),D=js(w);return e.jsx(ys,v({as:n,ref:c,className:ee(D.root,g),role:n===Ue?null:"row",ownerState:w},j))}),E=vs,pe=["SSS","SS","S","Q","N","W"],H={"👑 性主":["🔞 强制性交","👥 多人支配","💋 命令口交","💦 命令颜射","💉 命令内射","🍑 命令肛交","🔧 使用器具调教","⚡️ 引发强制高潮","💧 引发潮吹失禁","🎭 命令自慰展示","🚫 禁止对方高潮","🔄 扩张对方阴道","⭕️ 扩张对方肛门","🔄 双阳具调教","➕ 多阳具调教","✌️ 双插掌控"],"🐕 犬主":["🔒 囚笼管理","⛓️ 使用项圈镣铐","🍽️ 喂食控制","🐾 命令爬行","👣 要求舔足","👠 踩踏调教","🎠 骑乘支配"],"🎎 玩偶主":["🎭 安排角色扮演","👔 命令制服诱惑","🎭 要求人偶装扮","💍 安装乳环","💎 安装阴环","💫 安装脐环","✂️ 命令剃毛","🔍 使用内窥镜研究","🔧 实验性工具","🎨 将对方作为艺术品","🪑 将对方作为家具","🚬 将对方作为烟灰缸","👗 将对方作为女仆","🤐 限制对方说话内容"],"🌲 野主":["🌳 野外暴露调教","⛓️ 野外奴役","🏃‍♀️ 野外流放支配","🌿 野外玩弄","🏢 公共场合暴露命令","🏛️ 公共场合调戏","🎗️ 公开场合捆绑（衣服内）","📱 公开场合使用器具（衣服内）","👀 命令露阴（向朋友）","👥 命令露阴（向生人）","🔐 使用贞操带","📿 公开场合佩戴项圈"],"🐾 兽主":["🐕 安排兽交","🐺 安排群兽轮交","🐎 安排人兽同交","🦁 支配兽虐","🐜 命令昆虫爬身"],"⚔️ 刑主":["👋 施加耳光","🤐 使用口塞","💇‍♀️ 扯头发","👢 使用皮带","🎯 使用鞭子","🎋 使用藤条","🪵 使用木板","🏏 使用棍棒","🖌️ 使用毛刷","⚡️ 虐阴调教","🔗 紧缚控制","⛓️ 吊缚调教","🔒 拘束管理","📎 使用乳夹","⚡️ 使用电击","🕯️ 滴蜡调教","📍 使用针刺","💉 穿孔设计","🔥 烙印标记","🎨 刺青设计","✂️ 切割掌控","🔥 施行火刑","💧 施行水刑","😮‍💨 窒息控制","👊 施行体罚","🧊 使用冰块"],"🚽 厕主":["👅 命令舔精","🥛 命令吞精","💧 吐唾液","💦 命令喝尿","🚿 施行尿浴","👄 命令舔阴","💦 放尿支配","🚰 施行灌肠","👅 命令舔肛","💩 命令排便","🛁 施行粪浴","🍽️ 命令吃粪","🤧 命令吃痰","🩸 命令吃经血"],"💭 心主":["🗣️ 言语羞辱","😈 人格贬低","🧠 思维操控","🌐 网络支配","📢 语言管教"],"✨ 其他":["👥 调教多奴","👑 接受多主协助","🌐 网络公开调教","🪶 瘙痒惩罚","📅 长期圈养","⏱️ 短期圈养","😴 剥夺睡眠","🌀 施行催眠","👭 安排同性性爱"]},Cs=ct({palette:{primary:{main:"#ff0000",light:"#ff5252",dark:"#c50000"},secondary:{main:"#ff4081",light:"#ff79b0",dark:"#c60055"},background:{default:"#f8f9fa",paper:"#ffffff"},text:{primary:"#ff0000",secondary:"#ff5252"}},typography:{h3:{fontWeight:700,marginBottom:"2rem",letterSpacing:"-0.5px",color:"#ff0000",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},subtitle1:{color:"text.secondary",marginBottom:"2.5rem",fontSize:"1.1rem"},h5:{fontWeight:600,marginBottom:"1.5rem",color:"#ff0000",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'}},components:{MuiPaper:{styleOverrides:{root:{transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",borderRadius:"12px","&:hover":{boxShadow:"0 12px 24px rgba(0,0,0,0.1)",transform:"translateY(-4px)"}}}},MuiSelect:{styleOverrides:{root:{backgroundColor:"#fff",borderRadius:"8px","&:hover":{backgroundColor:"#f5f5f5"}}}},MuiButton:{styleOverrides:{root:{borderRadius:"8px",textTransform:"none",fontWeight:600,padding:"8px 24px",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 12px rgba(0,0,0,0.1)"}}}}}});function Ss(){const[s,r]=p.useState({}),[c,x]=p.useState(!1),[g,n]=p.useState(!1),[m,i]=p.useState(""),[j,b]=p.useState(!1),[w,D]=p.useState(""),[se,R]=p.useState(!1),[F,re]=p.useState(!1),[z,O]=p.useState(!1),[ce,P]=p.useState(!1),[fe,M]=p.useState(!1),[Se,Fe]=p.useState(Y()),[de,Le]=p.useState([]),[W,k]=p.useState(!1),[Ge,me]=p.useState(!1),[Qe,ge]=p.useState(!1),[T,we]=p.useState(null),[Ye,qe]=p.useState(!1),L=p.useRef(null);p.useEffect(()=>{Xe(),be()},[]),p.useEffect(()=>{const t=Object.keys(s).length>0;me(t)},[s]);const Xe=async()=>{try{const t=ie(),o=await oe.getLatestTestRecord(t,"s");o&&o.ratings&&(r(o.ratings),i("已加载您的最新测试记录"),n(!0))}catch(t){console.error("加载最新测试记录失败:",t)}},be=async()=>{try{k(!0);const t=ie(),o=await oe.getUserTestRecords(t);Le(o.filter(l=>l.test_type==="s"))}catch(t){console.error("加载测试记录失败:",t),i("加载历史记录失败"),n(!0)}finally{k(!1)}},Je=async()=>{try{k(!0);const t=ie(),o=Y(),l={radarData:ke(),groupedRatings:Te(),totalItems:Object.keys(s).length,completedItems:Object.values(s).filter(h=>h!=="").length};await oe.saveTestRecord({userId:t,nickname:o,testType:"s",ratings:s,reportData:l}),me(!1),i("测试记录保存成功！"),n(!0),await be()}catch(t){console.error("保存测试记录失败:",t),t.message.includes("Could not find")||t.message.includes("column")||t.message.includes("table")?i('数据库配置有问题，请点击"数据库诊断"检查'):i("保存失败: "+t.message),n(!0)}finally{k(!1)}},Re=async()=>{try{k(!0),ge(!0);const t=await Mt();we(t)}catch(t){console.error("诊断失败:",t),i("诊断失败: "+t.message),n(!0)}finally{k(!1)}},Ke=()=>{qe(!0),i("数据库诊断功能已激活！"),n(!0)},Ve=async t=>{try{k(!0);const o=await oe.getTestRecordDetails(t);o&&o.ratings&&(r(o.ratings),P(!1),i("测试记录加载成功"),n(!0))}catch(o){console.error("加载测试记录失败:",o),i("加载记录失败: "+o.message),n(!0)}finally{k(!1)}},Ze=async t=>{try{k(!0);const o=ie();await oe.deleteTestRecord(t,o),i("记录删除成功"),n(!0),await be()}catch(o){console.error("删除测试记录失败:",o),i("删除失败: "+o.message),n(!0)}finally{k(!1)}},et=()=>{const t=Nt(Se);i("昵称更新成功: "+t),n(!0),M(!1)},tt=()=>{r({}),me(!1),i("当前测试已清空"),n(!0)},st=(t,o,l)=>{r(h=>({...h,[`${t}-${o}`]:l}))},y=(t,o)=>s[`${t}-${o}`]||"",f=t=>{switch(t){case"SSS":return"#FFD700";case"SS":return"#FFA500";case"S":return"#32CD32";case"Q":return"#228B22";case"N":return"#4169E1";case"W":return"#1E90FF";default:return"#333333"}},ke=()=>Object.entries(H).map(([t])=>{const o=H[t],h=o.map(C=>{switch(y(t,C)){case"SSS":return 6;case"SS":return 5;case"S":return 4;case"Q":return 3;case"N":return 2;case"W":return 1;default:return 0}}).reduce((C,G)=>C+G,0)/o.length;return{category:t,value:h,fullMark:6}}),Te=()=>{const t={};Object.entries(H).forEach(([h,C])=>{C.forEach(G=>{const Q=y(h,G);t[Q]||(t[Q]=[]),t[Q].push({category:h,item:G})})});const o={};return["SSS","SS","S","Q","W","N"].forEach(h=>{t[h]&&t[h].length>0&&(o[h]=t[h])}),o},rt=async()=>{if(L.current)try{const t=document.createElement("div");t.style.position="absolute",t.style.left="-9999px",t.style.width="1200px",t.style.backgroundColor="#ffffff",t.style.padding="40px",document.body.appendChild(t);const o=L.current.cloneNode(!0);t.appendChild(o);const l=document.createElement("style");l.textContent=`
          .MuiGrid-container {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 16px !important;
            width: 100% !important;
          }
          .MuiGrid-item {
            width: 100% !important;
            max-width: 100% !important;
            flex: none !important;
            padding: 0 !important;
          }
          .MuiPaper-root {
            height: 100% !important;
          }
          .MuiTypography-root {
            font-size: 16px !important;
          }
          .MuiTypography-h4 {
            font-size: 32px !important;
            margin-bottom: 32px !important;
          }
          .MuiTypography-h5 {
            font-size: 24px !important;
            margin-bottom: 16px !important;
          }
          .recharts-wrapper {
            width: 600px !important;
            height: 400px !important;
            margin: 0 auto 32px !important;
          }
        `,t.appendChild(l),await new Promise(N=>setTimeout(N,500));const h=await It(t,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",width:1200,height:t.offsetHeight,onclone:N=>{N.querySelectorAll(".recharts-wrapper").forEach(nt=>{nt.style.margin="0 auto"})}});document.body.removeChild(t);const C=await new Promise(N=>h.toBlob(N,"image/png",1));if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))try{if(navigator.share&&navigator.canShare){const ye={files:[new File([C],"S自评报告.png",{type:"image/png"})]};if(navigator.canShare(ye)){await navigator.share(ye),i("图片已准备好分享！"),n(!0);return}}}catch(N){console.error("分享失败:",N)}const Q=URL.createObjectURL(C),je=document.createElement("a");je.href=Q,je.download="S自评报告.png",je.click(),URL.revokeObjectURL(Q),i("报告已保存为高清图片！"),n(!0)}catch(t){console.error("导出图片错误:",t),i("导出图片失败，请重试"),n(!0)}},ot=async()=>{if(L.current)try{const t=L.current,o={margin:1,filename:"S自评报告.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await Ht().set(o).from(t).save(),i("报告已成功保存为PDF！"),n(!0)}catch{i("导出PDF失败，请重试"),n(!0)}},at=(t,o)=>{const l=H[t],h={...s};l.forEach(C=>{h[`${t}-${C}`]=o}),r(h),i(`已将${t}类别下所有选项设置为${o}`),n(!0)};return e.jsxs(dt,{theme:Cs,children:[e.jsxs(d,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(xt,{position:"sticky",sx:{background:"linear-gradient(135deg, #ff0000 0%, #ff5252 100%)",boxShadow:"0 4px 0 #000000",borderBottom:"4px solid #000000"},children:e.jsx($e,{maxWidth:"lg",children:e.jsxs(pt,{sx:{justifyContent:"space-between",alignItems:"center",padding:{xs:"8px 16px",md:"8px 24px"},minHeight:{xs:"56px",md:"64px"}},children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1,flex:"1 1 auto",justifyContent:"flex-start",height:"100%"},children:[e.jsx(ht,{sx:{display:"flex"}}),e.jsx(a,{variant:"h5",sx:{fontWeight:"bold",color:"white",display:"flex",alignItems:"center",margin:0,padding:0,lineHeight:1,height:"100%"},children:"M-Profile Lab"})]}),e.jsxs(d,{sx:{display:{xs:"none",md:"flex"},gap:1,flex:"1 1 auto",justifyContent:"flex-end","& .MuiButton-root":{fontSize:"0.7rem",minWidth:"auto",px:1.5,py:.5,border:"1px solid rgba(255,255,255,0.3)","&:hover":{backgroundColor:"rgba(255,255,255,0.1)"}}},children:[e.jsx(u,{color:"inherit",startIcon:e.jsx(We,{}),href:"/index.html",children:"首页"}),e.jsx(u,{color:"inherit",startIcon:e.jsx(ze,{}),href:"/male.html",children:"男版"}),e.jsx(u,{color:"inherit",startIcon:e.jsx(Oe,{}),href:"/female.html",children:"女版"}),e.jsx(u,{color:"inherit",startIcon:e.jsx(He,{}),href:"/message.html",children:"留言"}),e.jsx(u,{color:"inherit",startIcon:e.jsx(ve,{}),onClick:()=>M(!0),sx:{maxWidth:"100px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Y().length>6?Y().substring(0,6)+"...":Y()})]}),e.jsx(Me,{color:"inherit",sx:{display:{xs:"block",md:"none"}},onClick:()=>b(!0),children:e.jsx(ut,{})})]})})}),e.jsx(ft,{anchor:"right",open:j,onClose:()=>b(!1),children:e.jsx(d,{sx:{width:250,pt:2},children:e.jsxs(mt,{children:[e.jsxs(ae,{button:!0,component:"a",href:"/index.html",onClick:()=>b(!1),children:[e.jsx(ne,{children:e.jsx(We,{sx:{color:"#ff0000"}})}),e.jsx(le,{primary:"首页",sx:{color:"#ff0000"}})]}),e.jsxs(ae,{button:!0,component:"a",href:"/male.html",onClick:()=>b(!1),children:[e.jsx(ne,{children:e.jsx(ze,{sx:{color:"#ff0000"}})}),e.jsx(le,{primary:"男生版",sx:{color:"#ff0000"}})]}),e.jsxs(ae,{button:!0,component:"a",href:"/female.html",onClick:()=>b(!1),children:[e.jsx(ne,{children:e.jsx(Oe,{sx:{color:"#ff0000"}})}),e.jsx(le,{primary:"女生版",sx:{color:"#ff0000"}})]}),e.jsxs(ae,{button:!0,component:"a",href:"/message.html",onClick:()=>b(!1),children:[e.jsx(ne,{children:e.jsx(He,{sx:{color:"#ff0000"}})}),e.jsx(le,{primary:"留言板",sx:{color:"#ff0000"}})]}),e.jsxs(ae,{button:!0,onClick:()=>{M(!0),b(!1)},children:[e.jsx(ne,{children:e.jsx(ve,{sx:{color:"#ff0000"}})}),e.jsx(le,{primary:"用户设置",sx:{color:"#ff0000"}})]})]})})}),e.jsxs($e,{maxWidth:"lg",className:"pixel-theme-red",sx:{py:8,minHeight:"100vh",display:"flex",flexDirection:"column",gap:5,animation:"fadeIn 0.6s ease-in-out","@keyframes fadeIn":{from:{opacity:0,transform:"translateY(20px)"},to:{opacity:1,transform:"translateY(0)"}}},children:[e.jsx(d,{sx:{textAlign:"center",mb:4},children:e.jsx(a,{variant:"h3",component:"h1",sx:{fontWeight:"bold",color:"primary.main",cursor:"pointer",userSelect:"none","&:hover":{opacity:.8}},onDoubleClick:Ke,title:"双击激活数据库诊断功能",children:"How 'S' I Could Be?"})}),e.jsxs(I,{elevation:3,className:"pixel-card-red",sx:{p:{xs:2,md:3},borderRadius:0},children:[e.jsx(a,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1,color:"primary.main",textAlign:"center"},children:"评分等级说明"}),e.jsxs(d,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:{xs:1,md:2}},children:[e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("SSS")},children:"SSS"})," = 极度喜欢"]}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("SS")},children:"SS"})," = 喜欢"]}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("S")},children:"S"})," = 接受"]}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("Q")},children:"Q"})," = 好奇可以尝试"]}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("N")},children:"N"})," = 拒绝"]}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.9rem"},children:[e.jsx(d,{component:"span",sx:{fontWeight:"bold",color:f("W")},children:"W"})," = 未知"]})]})]}),e.jsxs(d,{sx:{mt:2,mb:2,display:"flex",flexDirection:"column",gap:2,alignItems:"center"},children:[e.jsxs(d,{sx:{display:"flex",gap:2,flexWrap:"wrap",justifyContent:"center",alignItems:"center"},children:[e.jsx(Ce,{label:`已完成: ${Object.values(s).filter(t=>t!=="").length}/${Object.keys(H).reduce((t,o)=>t+H[o].length,0)}`,color:"primary",variant:"outlined"}),Ge&&e.jsx(Ce,{label:"有未保存的更改",color:"warning",variant:"filled",icon:e.jsx(Ie,{})}),e.jsx(Ce,{label:`用户: ${vt()}`,color:"secondary",variant:"outlined",icon:e.jsx(ve,{})})]}),e.jsxs(d,{sx:{display:"flex",gap:2,flexWrap:"wrap",justifyContent:"center"},children:[e.jsx(u,{variant:"contained",size:"large",startIcon:e.jsx(Ie,{}),disabled:W||Object.keys(s).length===0,className:"pixel-button-red",onClick:Je,sx:{minWidth:150},children:W?"保存中...":"保存测试"}),e.jsx(u,{variant:"outlined",size:"large",startIcon:e.jsx(Ct,{}),onClick:()=>P(!0),className:"pixel-button-red",sx:{minWidth:150},children:"查看记录"}),e.jsx(u,{variant:"outlined",color:"primary",size:"large",onClick:()=>{const t={...s};Object.entries(H).forEach(([o,l])=>{l.forEach(h=>{const C=Math.floor(Math.random()*pe.length);t[`${o}-${h}`]=pe[C]})}),r(t),i("已完成随机选择！"),n(!0)},className:"pixel-button-red",startIcon:e.jsx(St,{}),sx:{minWidth:150},children:"随机选择"}),e.jsx(u,{variant:"outlined",size:"large",startIcon:e.jsx(De,{}),color:"error",className:"pixel-button-red",onClick:tt,sx:{minWidth:150},children:"清空测试"}),Ye&&e.jsx(u,{variant:"outlined",size:"large",startIcon:e.jsx(Dt,{}),color:"info",className:"pixel-button-red",onClick:Re,disabled:W,sx:{minWidth:150},children:"数据库诊断"})]})]}),Object.entries(H).map(([t,o])=>e.jsxs(I,{elevation:2,className:"pixel-card-red",sx:{p:{xs:3,md:4},borderRadius:0,backgroundColor:"background.paper",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 0 rgba(255, 0, 0, 0.5)"}},children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(a,{variant:"h5",sx:{mb:0},children:t}),e.jsxs(Ne,{size:"small",value:w,onChange:l=>{at(t,l.target.value),D("")},displayEmpty:!0,placeholder:"一键选择",renderValue:l=>l||"一键选择",className:"pixel-select-red",sx:{minWidth:120},children:[e.jsx(xe,{value:"",children:e.jsx("em",{children:"一键选择"})}),pe.map(l=>e.jsx(xe,{value:l,children:l},l))]})]}),e.jsx($,{container:!0,spacing:2,sx:{mt:0,width:"100%",margin:0},children:o.map(l=>e.jsx($,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:{xs:1,md:1.5},borderRadius:2,height:"100%",backgroundColor:y(t,l)?`${f(y(t,l))}20`:"background.paper",boxShadow:y(t,l)?`0 1px 4px ${f(y(t,l))}60`:"0 1px 3px rgba(0,0,0,0.1)",borderLeft:y(t,l)?`3px solid ${f(y(t,l))}`:"none",transition:"all 0.3s ease",gap:1,"&:hover":{backgroundColor:y(t,l)?`${f(y(t,l))}30`:"rgba(98, 0, 234, 0.04)",transform:"translateX(4px)",boxShadow:y(t,l)?`0 2px 8px ${f(y(t,l))}80`:"0 2px 6px rgba(0,0,0,0.15)"}},children:[e.jsx(d,{sx:{display:"flex",alignItems:"center",flexGrow:1,minWidth:0},children:e.jsx(a,{sx:{fontWeight:500,color:y(t,l)?`${f(y(t,l))}`:"text.primary",fontSize:{xs:"0.85rem",md:"1rem"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",transition:"color 0.3s ease"},children:l})}),e.jsxs(Ne,{size:"small",value:y(t,l),onChange:h=>st(t,l,h.target.value),className:"pixel-select-red",sx:{minWidth:{xs:100,md:120},".MuiSelect-select":{py:1.5,px:2}},children:[e.jsx(xe,{value:"",children:e.jsx("em",{children:"请选择"})}),pe.map(h=>e.jsx(xe,{value:h,children:h},h))]})]})},l))})]},t)),e.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mt:4,gap:4},children:[e.jsx(d,{sx:{display:"flex",gap:2,justifyContent:"center",width:"100%",mb:2},children:e.jsx(u,{variant:"contained",color:"primary",size:"large",onClick:()=>x(!0),className:"pixel-button-red",sx:{minWidth:150},children:"生成报告"})}),e.jsxs(I,{elevation:2,className:"pixel-card-red",sx:{p:3,borderRadius:0,textAlign:"center",maxWidth:300,mx:"auto",backgroundColor:"white"},children:[e.jsx(a,{variant:"subtitle1",sx:{fontWeight:"bold",color:"primary.main",mb:2},children:"扫码领取您的XP报告"}),e.jsx(d,{component:"img",src:"/qrcode.png",alt:"QR Code",sx:{width:"200px",height:"200px",display:"block",margin:"0 auto"}})]})]})]}),e.jsx(wt,{pixelStyle:!0,redStyle:!0})]}),e.jsxs(A,{open:c,onClose:()=>x(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:{xs:"95vh",md:"auto"},maxHeight:{xs:"95vh",md:"90vh"},overflowY:"auto",m:{xs:1,sm:2},width:"100%",maxWidth:{sm:"800px"},mx:"auto",backgroundColor:"#fafafa","@media print":{height:"auto",maxHeight:"none",overflow:"visible"}}},children:[e.jsx(B,{sx:{textAlign:"center",fontWeight:"bold",pt:{xs:4,md:5},mt:{xs:2,md:3},color:"primary.main",borderBottom:"2px solid #ff0000",mb:2},children:"S自评详细报告"}),e.jsx(_,{ref:L,sx:{px:4,py:3,display:"flex",flexDirection:"column",gap:4,"@media print":{overflow:"visible",height:"auto"}},children:e.jsxs(d,{ref:L,sx:{p:3},children:[e.jsx(a,{variant:"h4",gutterBottom:!0,align:"center",sx:{color:"red",mb:4},children:"S型人格测试报告"}),e.jsx(d,{sx:{display:"flex",justifyContent:"center",mb:4},children:e.jsxs(Rt,{width:600,height:400,data:ke(),children:[e.jsx(kt,{}),e.jsx(Tt,{dataKey:"category"}),e.jsx($t,{angle:30,domain:[0,6]}),e.jsx(Wt,{name:"得分",dataKey:"value",stroke:"#ff0000",fill:"#ff0000",fillOpacity:.6})]})}),Object.entries(Te()).map(([t,o])=>o.length===0?null:e.jsxs(d,{sx:{mb:4},children:[e.jsxs(a,{variant:"h5",sx:{color:f(t),borderBottom:`2px solid ${f(t)}`,pb:1,mb:2},children:[t,"级 (",o.length,"项)"]}),e.jsx($,{container:!0,spacing:2,children:o.map(({category:l,item:h},C)=>e.jsx($,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{elevation:3,sx:{p:2,display:"flex",alignItems:"center",backgroundColor:`${f(t)}22`},children:e.jsxs(a,{children:[e.jsxs("strong",{children:[l,":"]})," ",h]})})},`${l}-${h}-${C}`))})]},t)),e.jsxs(d,{sx:{mt:6,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",p:3,border:"2px solid #ff0000",borderRadius:2},children:[e.jsx(a,{variant:"h6",sx:{mb:2,color:"#ff0000"},children:"原生相机扫码领取您的XP报告"}),e.jsx(d,{component:"img",src:"/qrcode.png",alt:"QR Code",sx:{width:200,height:200,display:"block"}})]})]})}),e.jsxs(U,{sx:{justifyContent:"center",p:3,gap:2,flexWrap:"wrap"},children:[e.jsx(u,{onClick:rt,variant:"contained",color:"primary",className:"pixel-button-red",children:"保存为图片"}),e.jsx(u,{onClick:ot,variant:"contained",color:"secondary",className:"pixel-button-red",children:"保存为PDF"})]}),e.jsx(Me,{onClick:()=>x(!1),sx:{position:"absolute",right:8,top:8,color:"#ff0000"},className:"pixel-button-red",children:e.jsx(De,{})})]}),e.jsx(gt,{open:g,autoHideDuration:3e3,onClose:()=>n(!1),message:m,anchorOrigin:{vertical:"bottom",horizontal:"center"}}),e.jsxs(A,{open:se,onClose:()=>R(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(B,{children:"评分说明"}),e.jsxs(_,{children:[e.jsx(a,{variant:"body1",paragraph:!0,children:"本测试旨在帮助您了解自己的S型人格特质。请根据您对各项活动的接受程度进行评分："}),e.jsx(is,{children:e.jsxs(Ut,{children:[e.jsx(fs,{children:e.jsxs(E,{children:[e.jsx(S,{children:"评分"}),e.jsx(S,{children:"含义"})]})}),e.jsxs(Xt,{children:[e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("SSS"),color:"#fff",fontWeight:"bold"},children:"SSS"}),e.jsx(S,{children:"极度喜欢，主动寻求"})]}),e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("SS"),color:"#fff",fontWeight:"bold"},children:"SS"}),e.jsx(S,{children:"非常喜欢，乐于尝试"})]}),e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("S"),color:"#fff",fontWeight:"bold"},children:"S"}),e.jsx(S,{children:"喜欢，愿意尝试"})]}),e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("Q"),color:"#000",fontWeight:"bold"},children:"Q"}),e.jsx(S,{children:"好奇，可以接受"})]}),e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("N"),color:"#000",fontWeight:"bold"},children:"N"}),e.jsx(S,{children:"不喜欢，但可以接受"})]}),e.jsxs(E,{children:[e.jsx(S,{sx:{bgcolor:f("W"),color:"#000",fontWeight:"bold"},children:"W"}),e.jsx(S,{children:"抵触，坚决拒绝"})]})]})]})})]}),e.jsx(U,{children:e.jsx(u,{onClick:()=>R(!1),color:"primary",children:"关闭"})})]}),e.jsxs(A,{open:F,onClose:()=>re(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(B,{children:"关于"}),e.jsxs(_,{children:[e.jsx(a,{variant:"body1",paragraph:!0,children:"M-Profile Lab是一个专注于人格特质研究的实验室，我们致力于帮助人们更好地了解自己的性格特点和偏好。"}),e.jsx(a,{variant:"body1",paragraph:!0,children:"本测试工具仅供娱乐和自我探索使用，不构成任何专业的心理评估或医学建议。"}),e.jsx(a,{variant:"body1",paragraph:!0,children:"版本：1.0.0"})]}),e.jsx(U,{children:e.jsx(u,{onClick:()=>re(!1),color:"primary",children:"关闭"})})]}),e.jsxs(A,{open:z,onClose:()=>O(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(B,{children:"使用指南"}),e.jsxs(_,{children:[e.jsx(a,{variant:"body1",paragraph:!0,children:"1. 浏览各个类别下的选项，根据您的真实感受为每个选项选择一个评分。"}),e.jsx(a,{variant:"body1",paragraph:!0,children:'2. 您可以使用每个类别旁边的"一键选择"功能，快速为整个类别设置相同的评分。'}),e.jsx(a,{variant:"body1",paragraph:!0,children:'3. 完成评分后，点击"生成报告"按钮查看您的S型人格分析报告。'}),e.jsx(a,{variant:"body1",paragraph:!0,children:"4. 在报告页面，您可以将报告保存为图片或PDF格式，也可以直接分享给朋友。"}),e.jsx(a,{variant:"body1",paragraph:!0,children:"5. 所有数据仅保存在您的浏览器中，刷新页面后数据将被清除。"})]}),e.jsx(U,{children:e.jsx(u,{onClick:()=>O(!1),color:"primary",children:"关闭"})})]}),e.jsxs(A,{open:ce,onClose:()=>P(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:{xs:"80vh",md:"60vh"},maxHeight:{xs:"90vh",md:"80vh"}}},children:[e.jsx(B,{sx:{textAlign:"center",fontWeight:"bold",borderBottom:"2px dashed #ff0000",mb:2},children:"测试历史记录"}),e.jsx(_,{sx:{px:3,py:2},children:W?e.jsx(d,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(a,{children:"加载中..."})}):de.length===0?e.jsxs(d,{sx:{textAlign:"center",py:4},children:[e.jsx(a,{variant:"h6",color:"text.secondary",children:"暂无测试记录"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"完成测试并保存后，记录将显示在这里"})]}):e.jsx($,{container:!0,spacing:2,children:de.map((t,o)=>{var l,h;return e.jsx($,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(I,{elevation:2,sx:{p:2,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(a,{variant:"h6",sx:{mb:1,color:"#ff0000"},children:["测试 #",de.length-o]}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["时间: ",new Date(t.created_at).toLocaleString("zh-CN")]}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["完成度: ",((l=t.report_data)==null?void 0:l.completedItems)||0,"/",((h=t.report_data)==null?void 0:h.totalItems)||0]}),e.jsxs(d,{sx:{mt:"auto",display:"flex",gap:1},children:[e.jsx(u,{size:"small",variant:"contained",onClick:()=>Ve(t.id),disabled:W,sx:{flex:1},children:"加载"}),e.jsx(u,{size:"small",variant:"outlined",color:"error",onClick:()=>Ze(t.id),disabled:W,children:"删除"})]})]})},t.id)})})}),e.jsx(U,{sx:{justifyContent:"center",pb:2},children:e.jsx(u,{onClick:()=>P(!1),children:"关闭"})})]}),e.jsxs(A,{open:fe,onClose:()=>M(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(B,{sx:{textAlign:"center",fontWeight:"bold",borderBottom:"2px dashed #ff0000",mb:2},children:"用户设置"}),e.jsx(_,{sx:{px:3,py:2},children:e.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(bt,{label:"用户昵称",value:Se,onChange:t=>Fe(t.target.value),fullWidth:!0,helperText:"设置一个好记的昵称，方便识别您的测试记录",variant:"outlined"}),e.jsxs(d,{sx:{p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsx(a,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold"},children:"用户信息"}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["用户ID: ",ie()]}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["当前昵称: ",Y()]}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["测试记录数: ",de.length]})]})]})}),e.jsxs(U,{sx:{justifyContent:"center",pb:2,gap:2},children:[e.jsx(u,{onClick:et,variant:"contained",children:"保存昵称"}),e.jsx(u,{onClick:()=>M(!1),children:"取消"})]})]}),e.jsxs(A,{open:Qe,onClose:()=>ge(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(B,{sx:{textAlign:"center",fontWeight:"bold",borderBottom:"2px dashed #ff0000",mb:2},children:"数据库诊断报告"}),e.jsx(_,{sx:{px:3,py:2},children:W?e.jsx(d,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(a,{children:"正在诊断数据库..."})}):T?e.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(I,{elevation:1,sx:{p:2,bgcolor:"grey.50"},children:[e.jsx(a,{variant:"h6",sx:{mb:2,color:"#ff0000"},children:"诊断摘要"}),e.jsxs($,{container:!0,spacing:2,children:[e.jsxs($,{item:!0,xs:6,sm:3,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"数据库连接"}),e.jsx(a,{variant:"body1",children:T.summary.connection})]}),e.jsxs($,{item:!0,xs:6,sm:3,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"数据表"}),e.jsxs(a,{variant:"body1",children:[T.summary.tablesCount,"/",T.summary.totalTables]})]}),e.jsxs($,{item:!0,xs:6,sm:3,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"错误数量"}),e.jsx(a,{variant:"body1",color:T.summary.errorsCount>0?"error":"success.main",children:T.summary.errorsCount})]})]})]}),T.details.errors.length>0&&e.jsxs(I,{elevation:1,sx:{p:2,bgcolor:"#ffebee"},children:[e.jsx(a,{variant:"h6",sx:{mb:2,color:"error.main"},children:"发现的问题"}),T.details.errors.map((t,o)=>e.jsxs(a,{variant:"body2",sx:{mb:1,color:"error.dark"},children:["• ",t]},o))]}),e.jsxs(I,{elevation:1,sx:{p:2,bgcolor:"#e8f5e8"},children:[e.jsx(a,{variant:"h6",sx:{mb:2,color:"success.main"},children:"修复建议"}),T.recommendations.map((t,o)=>e.jsxs(a,{variant:"body2",sx:{mb:1},children:[o+1,". ",t]},o))]})]}):e.jsx(d,{sx:{textAlign:"center",py:4},children:e.jsx(a,{variant:"h6",color:"text.secondary",children:'点击"开始诊断"检查数据库状态'})})}),e.jsxs(U,{sx:{justifyContent:"center",pb:2,gap:2},children:[!T&&e.jsx(u,{onClick:Re,variant:"contained",disabled:W,children:W?"诊断中...":"开始诊断"}),e.jsx(u,{onClick:()=>{ge(!1),we(null)},children:"关闭"})]})]})]})}jt.createRoot(document.getElementById("root")).render(e.jsx(yt.StrictMode,{children:e.jsx(Ss,{})}));

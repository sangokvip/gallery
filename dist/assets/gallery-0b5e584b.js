import{a6 as ir,a7 as lr,r as n,a8 as _t,a9 as cr,aa as pt,ab as dr,y as ue,ac as ur,ad as pr,_ as F,N as $t,ae as fr,v as we,u as Ie,M as fe,j as e,w as ne,P as Pe,F as pe,J as ft,G as ht,x as Me,I as N,z as _e,E as $e,O as hr,af as zt,ag as xr,ah as gr,H as mr,ai as br,a1 as G,a2 as Q,aj as vr,V as xt,ak as yr,al as De,W as Ae,am as Le,c as Cr,R as Rt,B as w,b as J,e as T,an as X,a3 as Be,T as jr,A as Sr,C as gt,a as kr,d as ze,f as mt,g as wr,D as Ir,L as Mr,h as ge,i as me,k as be,ao as _r,ap as $r,S as zr,q as Rr,p as ve,l as Te,m as Ue,n as Ne,o as Ve,aq as Fr,s as Pr}from"./v4-74551561.js";import{d as bt,D as Dr,c as Ft,C as ye,a as vt,b as Ar}from"./Edit-bec97425.js";import{d as yt,a as Ye,M as Oe,b as Lr}from"./Message-321b40ed.js";import{d as Ct}from"./Female-84d5811b.js";import{d as jt}from"./Male-954eee75.js";function Or(t,r,s,o,a){const[l,u]=n.useState(()=>a&&s?s(t).matches:o?o(t).matches:r);return _t(()=>{let b=!0;if(!s)return;const f=s(t),d=()=>{b&&u(f.matches)};return d(),f.addListener(d),()=>{b=!1,f.removeListener(d)}},[t,s]),l}const Pt=cr["useSyncExternalStore"];function Er(t,r,s,o,a){const l=n.useCallback(()=>r,[r]),u=n.useMemo(()=>{if(a&&s)return()=>s(t).matches;if(o!==null){const{matches:h}=o(t);return()=>h}return l},[l,t,o,a,s]),[b,f]=n.useMemo(()=>{if(s===null)return[l,()=>()=>{}];const h=s(t);return[()=>h.matches,k=>(h.addListener(k),()=>{h.removeListener(k)})]},[l,s,t]);return Pt(f,b,u)}function Re(t,r={}){const s=ir(),o=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:a=!1,matchMedia:l=o?window.matchMedia:null,ssrMatchMedia:u=null,noSsr:b=!1}=lr({name:"MuiUseMediaQuery",props:r,theme:s});let f=typeof t=="function"?t(s):t;return f=f.replace(/^@media( ?)/m,""),(Pt!==void 0?Er:Or)(f,a,l,u,b)}function Br(t,r=0,s=1){return dr(t,r,s)}function Wr(t){t=t.slice(1);const r=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let s=t.match(r);return s&&s[0].length===1&&(s=s.map(o=>o+o)),s?`rgb${s.length===4?"a":""}(${s.map((o,a)=>a<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function Dt(t){if(t.type)return t;if(t.charAt(0)==="#")return Dt(Wr(t));const r=t.indexOf("("),s=t.substring(0,r);if(["rgb","rgba","hsl","hsla","color"].indexOf(s)===-1)throw new Error(pt(9,t));let o=t.substring(r+1,t.length-1),a;if(s==="color"){if(o=o.split(" "),a=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(a)===-1)throw new Error(pt(10,a))}else o=o.split(",");return o=o.map(l=>parseFloat(l)),{type:s,values:o,colorSpace:a}}function Hr(t){const{type:r,colorSpace:s}=t;let{values:o}=t;return r.indexOf("rgb")!==-1?o=o.map((a,l)=>l<3?parseInt(a,10):a):r.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),r.indexOf("color")!==-1?o=`${s} ${o.join(" ")}`:o=`${o.join(", ")}`,`${r}(${o})`}function Tr(t,r){return t=Dt(t),r=Br(r),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${r}`:t.values[3]=r,Hr(t)}const Ur=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Nr=["component","slots","slotProps"],Vr=["component"];function St(t,r){const{className:s,elementType:o,ownerState:a,externalForwardedProps:l,getSlotOwnerState:u,internalForwardedProps:b}=r,f=ue(r,Ur),{component:d,slots:h={[t]:void 0},slotProps:k={[t]:void 0}}=l,L=ue(l,Nr),O=h[t]||o,_=ur(k[t],a),A=pr(F({className:s},f,{externalForwardedProps:t==="root"?L:void 0,externalSlotProps:_})),{props:{component:P},internalRef:E}=A,x=ue(A.props,Vr),Z=$t(E,_==null?void 0:_.ref,r.ref),i=u?u(x):{},g=F({},a,i),m=t==="root"?P||d:P,p=fr(O,F({},t==="root"&&!d&&!h[t]&&b,t!=="root"&&!h[t]&&b,x,m&&{as:m},{ref:Z}),g);return Object.keys(i).forEach(C=>{delete p[C]}),[O,p]}function Yr(t){return Ie("MuiAlert",t)}const qr=we("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),kt=qr,Gr=fe(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Qr=fe(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Zr=fe(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Xr=fe(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),Jr=fe(e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Kr=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],eo=t=>{const{variant:r,color:s,severity:o,classes:a}=t,l={root:["root",`color${pe(s||o)}`,`${r}${pe(s||o)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return $e(l,Yr,a)},to=ne(Pe,{name:"MuiAlert",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:s}=t;return[r.root,r[s.variant],r[`${s.variant}${pe(s.color||s.severity)}`]]}})(({theme:t})=>{const r=t.palette.mode==="light"?ft:ht,s=t.palette.mode==="light"?ht:ft;return F({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,o])=>o.main&&o.light).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:r(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${o}StandardBg`]:s(t.palette[o].light,.9),[`& .${kt.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(([,o])=>o.main&&o.light).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:r(t.palette[o].light,.6),border:`1px solid ${(t.vars||t).palette[o].light}`,[`& .${kt.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(([,o])=>o.main&&o.dark).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:F({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${o}FilledColor`],backgroundColor:t.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)})}))]})}),ro=ne("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,r)=>r.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),oo=ne("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,r)=>r.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),wt=ne("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,r)=>r.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),It={success:e.jsx(Gr,{fontSize:"inherit"}),warning:e.jsx(Qr,{fontSize:"inherit"}),error:e.jsx(Zr,{fontSize:"inherit"}),info:e.jsx(Xr,{fontSize:"inherit"})},so=n.forwardRef(function(r,s){const o=Me({props:r,name:"MuiAlert"}),{action:a,children:l,className:u,closeText:b="Close",color:f,components:d={},componentsProps:h={},icon:k,iconMapping:L=It,onClose:O,role:_="alert",severity:A="success",slotProps:P={},slots:E={},variant:x="standard"}=o,Z=ue(o,Kr),i=F({},o,{color:f,severity:A,variant:x,colorSeverity:f||A}),g=eo(i),m={slots:F({closeButton:d.CloseButton,closeIcon:d.CloseIcon},E),slotProps:F({},h,P)},[p,C]=St("closeButton",{elementType:N,externalForwardedProps:m,ownerState:i}),[S,R]=St("closeIcon",{elementType:Jr,externalForwardedProps:m,ownerState:i});return e.jsxs(to,F({role:_,elevation:0,ownerState:i,className:_e(g.root,u),ref:s},Z,{children:[k!==!1?e.jsx(ro,{ownerState:i,className:g.icon,children:k||L[A]||It[A]}):null,e.jsx(oo,{ownerState:i,className:g.message,children:l}),a!=null?e.jsx(wt,{ownerState:i,className:g.action,children:a}):null,a==null&&O?e.jsx(wt,{ownerState:i,className:g.action,children:e.jsx(p,F({size:"small","aria-label":b,title:b,color:"inherit",onClick:O},C,{children:e.jsx(S,F({fontSize:"small"},R))}))}):null]}))}),ao=so;function no(t){return Ie("MuiCard",t)}we("MuiCard",["root"]);const io=["className","raised"],lo=t=>{const{classes:r}=t;return $e({root:["root"]},no,r)},co=ne(Pe,{name:"MuiCard",slot:"Root",overridesResolver:(t,r)=>r.root})(()=>({overflow:"hidden"})),uo=n.forwardRef(function(r,s){const o=Me({props:r,name:"MuiCard"}),{className:a,raised:l=!1}=o,u=ue(o,io),b=F({},o,{raised:l}),f=lo(b);return e.jsx(co,F({className:_e(f.root,a),elevation:l?8:void 0,ref:s,ownerState:b},u))}),po=uo;function fo(t){return Ie("PrivateSwitchBase",t)}we("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const ho=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],xo=t=>{const{classes:r,checked:s,disabled:o,edge:a}=t,l={root:["root",s&&"checked",o&&"disabled",a&&`edge${pe(a)}`],input:["input"]};return $e(l,fo,r)},go=ne(hr)(({ownerState:t})=>F({padding:9,borderRadius:"50%"},t.edge==="start"&&{marginLeft:t.size==="small"?-3:-12},t.edge==="end"&&{marginRight:t.size==="small"?-3:-12})),mo=ne("input",{shouldForwardProp:zt})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),bo=n.forwardRef(function(r,s){const{autoFocus:o,checked:a,checkedIcon:l,className:u,defaultChecked:b,disabled:f,disableFocusRipple:d=!1,edge:h=!1,icon:k,id:L,inputProps:O,inputRef:_,name:A,onBlur:P,onChange:E,onFocus:x,readOnly:Z,required:i=!1,tabIndex:g,type:m,value:p}=r,C=ue(r,ho),[S,R]=xr({controlled:a,default:!!b,name:"SwitchBase",state:"checked"}),$=gr(),ee=W=>{x&&x(W),$&&$.onFocus&&$.onFocus(W)},H=W=>{P&&P(W),$&&$.onBlur&&$.onBlur(W)},V=W=>{if(W.nativeEvent.defaultPrevented)return;const te=W.target.checked;R(te),E&&E(W,te)};let B=f;$&&typeof B>"u"&&(B=$.disabled);const se=m==="checkbox"||m==="radio",y=F({},r,{checked:S,disabled:B,disableFocusRipple:d,edge:h}),Y=xo(y);return e.jsxs(go,F({component:"span",className:_e(Y.root,u),centerRipple:!0,focusRipple:!d,disabled:B,tabIndex:null,role:void 0,onFocus:ee,onBlur:H,ownerState:y,ref:s},C,{children:[e.jsx(mo,F({autoFocus:o,checked:a,defaultChecked:b,className:Y.input,disabled:B,id:se?L:void 0,name:A,onChange:V,readOnly:Z,ref:_,required:i,ownerState:y,tabIndex:g,type:m},m==="checkbox"&&p===void 0?{}:{value:p},O)),S?l:k]}))}),vo=bo,yo=fe(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Co=fe(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),jo=fe(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function So(t){return Ie("MuiCheckbox",t)}const ko=we("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Ee=ko,wo=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Io=t=>{const{classes:r,indeterminate:s,color:o,size:a}=t,l={root:["root",s&&"indeterminate",`color${pe(o)}`,`size${pe(a)}`]},u=$e(l,So,r);return F({},r,u)},Mo=ne(vo,{shouldForwardProp:t=>zt(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:s}=t;return[r.root,s.indeterminate&&r.indeterminate,r[`size${pe(s.size)}`],s.color!=="default"&&r[`color${pe(s.color)}`]]}})(({theme:t,ownerState:r})=>F({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${r.color==="default"?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:mr(r.color==="default"?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},r.color!=="default"&&{[`&.${Ee.checked}, &.${Ee.indeterminate}`]:{color:(t.vars||t).palette[r.color].main},[`&.${Ee.disabled}`]:{color:(t.vars||t).palette.action.disabled}})),_o=e.jsx(Co,{}),$o=e.jsx(yo,{}),zo=e.jsx(jo,{}),Ro=n.forwardRef(function(r,s){var o,a;const l=Me({props:r,name:"MuiCheckbox"}),{checkedIcon:u=_o,color:b="primary",icon:f=$o,indeterminate:d=!1,indeterminateIcon:h=zo,inputProps:k,size:L="medium",className:O}=l,_=ue(l,wo),A=d?h:f,P=d?h:u,E=F({},l,{color:b,indeterminate:d,size:L}),x=Io(E);return e.jsx(Mo,F({type:"checkbox",inputProps:F({"data-indeterminate":d},k),icon:n.cloneElement(A,{fontSize:(o=A.props.fontSize)!=null?o:L}),checkedIcon:n.cloneElement(P,{fontSize:(a=P.props.fontSize)!=null?a:L}),ownerState:E,ref:s,className:_e(x.root,O)},_,{classes:x}))}),Fo=Ro,Po=(t,r)=>F({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},r&&!t.vars&&{colorScheme:t.palette.mode}),Do=t=>F({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),Ao=(t,r=!1)=>{var s;const o={};r&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([u,b])=>{var f;o[t.getColorSchemeSelector(u).replace(/\s*&/,"")]={colorScheme:(f=b.palette)==null?void 0:f.mode}});let a=F({html:Po(t,r),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:F({margin:0},Do(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},o);const l=(s=t.components)==null||(s=s.MuiCssBaseline)==null?void 0:s.styleOverrides;return l&&(a=[a,l]),a};function Lo(t){const r=Me({props:t,name:"MuiCssBaseline"}),{children:s,enableColorScheme:o=!1}=r;return e.jsxs(n.Fragment,{children:[e.jsx(br,{styles:a=>Ao(a,o)}),s]})}var qe={},Oo=Q;Object.defineProperty(qe,"__esModule",{value:!0});var Fe=qe.default=void 0,Eo=Oo(G()),Bo=e;Fe=qe.default=(0,Eo.default)((0,Bo.jsx)("path",{d:"M19 7v2.99s-1.99.01-2 0V7h-3s.01-1.99 0-2h3V2h2v3h3v2zm-3 4V8h-3V5H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8zM5 19l3-4 2 3 3-4 4 5z"}),"AddPhotoAlternate");var Ge={},Wo=Q;Object.defineProperty(Ge,"__esModule",{value:!0});var At=Ge.default=void 0,Ho=Wo(G()),To=e;At=Ge.default=(0,Ho.default)((0,To.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload");var Qe={},Uo=Q;Object.defineProperty(Qe,"__esModule",{value:!0});var Lt=Qe.default=void 0,No=Uo(G()),Mt=e;Lt=Qe.default=(0,No.default)([(0,Mt.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),(0,Mt.jsx)("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")],"ZoomIn");var Ze={},Vo=Q;Object.defineProperty(Ze,"__esModule",{value:!0});var Xe=Ze.default=void 0,Yo=Vo(G()),qo=e;Xe=Ze.default=(0,Yo.default)((0,qo.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var Je={},Go=Q;Object.defineProperty(Je,"__esModule",{value:!0});var Ot=Je.default=void 0,Qo=Go(G()),Zo=e;Ot=Je.default=(0,Qo.default)((0,Zo.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel");var Ke={},Xo=Q;Object.defineProperty(Ke,"__esModule",{value:!0});var Et=Ke.default=void 0,Jo=Xo(G()),Ko=e;Et=Ke.default=(0,Jo.default)((0,Ko.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");var et={},es=Q;Object.defineProperty(et,"__esModule",{value:!0});var Bt=et.default=void 0,ts=es(G()),rs=e;Bt=et.default=(0,ts.default)((0,rs.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var tt={},os=Q;Object.defineProperty(tt,"__esModule",{value:!0});var Wt=tt.default=void 0,ss=os(G()),as=e;Wt=tt.default=(0,ss.default)((0,as.jsx)("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8m-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91"}),"RestartAlt");var rt={},ns=Q;Object.defineProperty(rt,"__esModule",{value:!0});var Ht=rt.default=void 0,is=ns(G()),ls=e;Ht=rt.default=(0,is.default)((0,ls.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var ot={},cs=Q;Object.defineProperty(ot,"__esModule",{value:!0});var Tt=ot.default=void 0,ds=cs(G()),us=e;Tt=ot.default=(0,ds.default)((0,us.jsx)("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"CheckBoxOutlineBlank");var st={},ps=Q;Object.defineProperty(st,"__esModule",{value:!0});var Ut=st.default=void 0,fs=ps(G()),hs=e;Ut=st.default=(0,fs.default)((0,hs.jsx)("path",{d:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3zM14 5h-3l-1-1H6L5 5H2v2h12z"}),"DeleteSweep");function xs(t){return Ie("MuiMasonry",t)}we("MuiMasonry",["root"]);const gs=["children","className","component","columns","spacing","sequential","defaultColumns","defaultHeight","defaultSpacing"],de=t=>Number(t.replace("px","")),ms={flexBasis:"100%",width:0,margin:0,padding:0},bs=t=>{const{classes:r}=t;return $e({root:["root"]},xs,r)},vs=({ownerState:t,theme:r})=>{let s={width:"100%",display:"flex",flexFlow:"column wrap",alignContent:"flex-start",boxSizing:"border-box","& > *":{boxSizing:"border-box"}};const o={};if(t.isSSR){const d={},h=de(r.spacing(t.defaultSpacing));for(let k=1;k<=t.defaultColumns;k+=1)d[`&:nth-of-type(${t.defaultColumns}n+${k%t.defaultColumns})`]={order:k};return o.height=t.defaultHeight,o.margin=-(h/2),o["& > *"]=F({},s["& > *"],d,{margin:h/2,width:`calc(${(100/t.defaultColumns).toFixed(2)}% - ${h}px)`}),F({},s,o)}const a=xt({values:t.spacing,breakpoints:r.breakpoints.values}),l=yr(r);s=De(s,Ae({theme:r},a,d=>{let h;if(typeof d=="string"&&!Number.isNaN(Number(d))||typeof d=="number"){const k=Number(d);h=Le(l,k)}else h=d;return F({margin:`calc(0px - (${h} / 2))`,"& > *":{margin:`calc(${h} / 2)`}},t.maxColumnHeight&&{height:typeof h=="number"?Math.ceil(t.maxColumnHeight+de(h)):`calc(${t.maxColumnHeight}px + ${h})`})}));const b=xt({values:t.columns,breakpoints:r.breakpoints.values});return s=De(s,Ae({theme:r},b,d=>{const k=`${(100/Number(d)).toFixed(2)}%`,L=typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number"?Le(l,Number(a)):"0px";return{"& > *":{width:`calc(${k} - ${L})`}}})),typeof a=="object"&&(s=De(s,Ae({theme:r},a,(d,h)=>{if(h){const k=Number(d),L=Object.keys(b).pop(),O=Le(l,k);return{"& > *":{width:`calc(${`${(100/(typeof b=="object"?b[h]||b[L]:b)).toFixed(2)}%`} - ${O})`}}}return null}))),s},ys=ne("div",{name:"MuiMasonry",slot:"Root",overridesResolver:(t,r)=>[r.root]})(vs),Cs=n.forwardRef(function(r,s){const o=Me({props:r,name:"MuiMasonry"}),{children:a,className:l,component:u="div",columns:b=4,spacing:f=1,sequential:d=!1,defaultColumns:h,defaultHeight:k,defaultSpacing:L}=o,O=ue(o,gs),_=n.useRef(),[A,P]=n.useState(),E=!A&&k&&h!==void 0&&L!==void 0,[x,Z]=n.useState(E?h-1:0),i=F({},o,{spacing:f,columns:b,maxColumnHeight:A,defaultColumns:h,defaultHeight:k,defaultSpacing:L,isSSR:E}),g=bs(i),m=n.useCallback(S=>{if(!_.current||!S||S.length===0)return;const R=_.current,$=_.current.firstChild,ee=R.clientWidth,H=$.clientWidth;if(ee===0||H===0)return;const V=window.getComputedStyle($),B=de(V.marginLeft),se=de(V.marginRight),y=Math.round(ee/(H+B+se)),Y=new Array(y).fill(0);let W=!1,te=1;R.childNodes.forEach(U=>{if(U.nodeType!==Node.ELEMENT_NODE||U.dataset.class==="line-break"||W)return;const re=window.getComputedStyle(U),he=de(re.marginTop),ie=de(re.marginBottom),I=de(re.height)?Math.ceil(de(re.height))+he+ie:0;if(I===0){W=!0;return}for(let z=0;z<U.childNodes.length;z+=1){const M=U.childNodes[z];if(M.tagName==="IMG"&&M.clientHeight===0){W=!0;break}}if(!W)if(d)Y[te-1]+=I,U.style.order=te,te+=1,te>y&&(te=1);else{const z=Y.indexOf(Math.min(...Y));Y[z]+=I;const M=z+1;U.style.order=M}}),W||vr.flushSync(()=>{P(Math.max(...Y)),Z(y>0?y-1:0)})},[d]);_t(()=>{if(typeof ResizeObserver>"u")return;let S;const R=new ResizeObserver(()=>{S=requestAnimationFrame(m)});return _.current&&_.current.childNodes.forEach($=>{R.observe($)}),()=>{S&&window.cancelAnimationFrame(S),R&&R.disconnect()}},[b,f,a,m]);const p=$t(s,_),C=new Array(x).fill("").map((S,R)=>e.jsx("span",{"data-class":"line-break",style:F({},ms,{order:R+1})},R));return e.jsxs(ys,F({as:u,className:_e(g.root,l),ref:p,ownerState:i},O,{children:[a,C]}))}),js=Cs;var at={},Ss=Q;Object.defineProperty(at,"__esModule",{value:!0});var Nt=at.default=void 0,ks=Ss(G()),ws=e;Nt=at.default=(0,ks.default)((0,ws.jsx)("path",{d:"M1 21h4V9H1zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73z"}),"ThumbUp");var nt={},Is=Q;Object.defineProperty(nt,"__esModule",{value:!0});var Vt=nt.default=void 0,Ms=Is(G()),_s=e;Vt=nt.default=(0,Ms.default)((0,_s.jsx)("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2m4 0v12h4V3z"}),"ThumbDown");var it={},$s=Q;Object.defineProperty(it,"__esModule",{value:!0});var We=it.default=void 0,zs=$s(G()),Rs=e;We=it.default=(0,zs.default)((0,Rs.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");var lt={},Fs=Q;Object.defineProperty(lt,"__esModule",{value:!0});var He=lt.default=void 0,Ps=Fs(G()),Ds=e;He=lt.default=(0,Ps.default)((0,Ds.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward");var ct={},As=Q;Object.defineProperty(ct,"__esModule",{value:!0});var Yt=ct.default=void 0,Ls=As(G()),Os=e;Yt=ct.default=(0,Ls.default)((0,Os.jsx)("path",{d:"M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2m2 10H3v4c0 1.1.9 2 2 2h4v-2H5zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2"}),"CropFree");const ke=Cr({palette:{primary:{main:"#f97316",light:"#fb923c",dark:"#ea580c"},secondary:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},background:{default:"#fffbf5",paper:"#ffffff"},text:{primary:"#111827",secondary:"#4b5563"},accent:{pink:"#ec4899",green:"#10b981",yellow:"#f59e0b",red:"#ef4444"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},info:{main:"#f97316",light:"#fb923c",dark:"#ea580c"},success:{main:"#10b981",light:"#34d399",dark:"#059669"}},typography:{fontFamily:'"Inter", "SF Pro Display", "Roboto", "Helvetica", "Arial", sans-serif',h1:{fontWeight:700,letterSpacing:"-0.025em"},h2:{fontWeight:700,letterSpacing:"-0.025em"},h3:{fontWeight:600,letterSpacing:"-0.025em"},h4:{fontWeight:600,letterSpacing:"-0.025em"},h5:{fontWeight:600,letterSpacing:"-0.025em"},h6:{fontWeight:600,letterSpacing:"-0.025em"},button:{fontWeight:500,textTransform:"none"},body1:{fontSize:"1rem",lineHeight:1.5},body2:{fontSize:"0.875rem",lineHeight:1.5}},shape:{borderRadius:12},shadows:["none","0 1px 2px 0 rgba(0, 0, 0, 0.05)","0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)","0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)","0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)","0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)"],components:{MuiPaper:{styleOverrides:{root:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out","&:hover":{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"}}}},MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 16px",transition:"all 0.2s ease",fontWeight:500},contained:{boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)","&:hover":{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transform:"translateY(-1px)"},"&:active":{boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",transform:"translateY(1px)"}},outlined:{borderWidth:"1.5px","&:hover":{borderWidth:"1.5px",transform:"translateY(-1px)"}}}},MuiCard:{styleOverrides:{root:{overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"}}}},MuiIconButton:{styleOverrides:{root:{borderRadius:8,transition:"all 0.2s ease","&:hover":{backgroundColor:Tr("#2563eb",.08),transform:"translateY(-1px)"}}}},MuiDialog:{styleOverrides:{paper:{borderRadius:16,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",overflow:"hidden"}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8,transition:"all 0.2s ease","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#60a5fa"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderWidth:2}}}}},MuiAppBar:{styleOverrides:{root:{boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)"}}},MuiChip:{styleOverrides:{root:{borderRadius:8,fontWeight:500}}},MuiAlert:{styleOverrides:{root:{borderRadius:8}}},MuiLink:{styleOverrides:{root:{textDecoration:"none",transition:"color 0.2s ease",fontWeight:500,"&:hover":{textDecoration:"underline"}}}}}}),Es=`
  @keyframes titleGlow {
    0% {
      text-shadow: 0 0 5px rgba(37, 99, 235, 0.5),
                   0 0 10px rgba(37, 99, 235, 0.3),
                   0 0 15px rgba(37, 99, 235, 0.2);
    }
    50% {
      text-shadow: 0 0 10px rgba(37, 99, 235, 0.8),
                   0 0 20px rgba(37, 99, 235, 0.5),
                   0 0 30px rgba(37, 99, 235, 0.3);
    }
    100% {
      text-shadow: 0 0 5px rgba(37, 99, 235, 0.5),
                   0 0 10px rgba(37, 99, 235, 0.3),
                   0 0 15px rgba(37, 99, 235, 0.2);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes pulse {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.9;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  .main-title {
    position: relative;
    display: inline-block;
    background: linear-gradient(45deg, #2563eb, #8b5cf6);
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
    animation: titleGlow 3s ease-in-out infinite;
    letter-spacing: -0.025em;
  }

  .fade-in {
    animation: fadeIn 0.5s ease-out forwards;
  }
  
  .image-loading {
    opacity: 0;
    transform: scale(0.98);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }
  
  .image-loaded {
    opacity: 1;
    transform: scale(1);
  }
  
  .hover-scale {
    transition: transform 0.3s ease;
  }
  
  .hover-scale:hover {
    transform: scale(1.03);
  }
  
  .pulse-animation {
    animation: pulse 2s infinite;
  }
`,dt=document.createElement("style");dt.type="text/css";dt.innerText=Es;document.head.appendChild(dt);const Bs=({image:t,onView:r,onDelete:s,onEdit:o,isAdmin:a,isSelected:l,isSelectionMode:u,onSelect:b,userId:f})=>{const[d,h]=n.useState(null),[k,L]=n.useState(!1),[O,_]=n.useState(!1);n.useState(!1);const[A,P]=n.useState(t.likes_count||0),[E,x]=n.useState(t.dislikes_count||0),[Z,i]=n.useState(!1),[g,m]=n.useState({width:0,height:0}),[p,C]=n.useState(!1),[S,R]=n.useState(!1),[$,ee]=n.useState(!1),[H,V]=n.useState(!1),B=t.image_url||(t.image_path?X.storage.from("gallery").getPublicUrl(t.image_path).data.publicUrl:""),se=t.user_id===f;n.useEffect(()=>{f&&(async()=>{try{const z=await X.getImageVoteStatus(t.id,f);z!==null&&h(z)}catch(z){console.error("获取投票状态失败:",z)}})()},[t.id,f]);const y=async I=>{if(I.stopPropagation(),!p)try{C(!0);const z=await X.updateImageLikes(t.id,f,!0);z.action==="added"?(P(M=>M+1),h(!0)):z.action==="removed"?(P(M=>M-1),h(null)):z.action==="changed"&&(P(M=>M+1),x(M=>M-1),h(!0))}catch(z){console.error("点赞失败:",z)}finally{C(!1)}},Y=async I=>{if(I.stopPropagation(),!p)try{C(!0);const z=await X.updateImageLikes(t.id,f,!1);z.action==="added"?(x(M=>M+1),h(!1)):z.action==="removed"?(x(M=>M-1),h(null)):z.action==="changed"&&(x(M=>M+1),P(M=>M-1),h(!1))}catch(z){console.error("点踩失败:",z)}finally{C(!1)}},W=async()=>{try{C(!0),await X.adminUpdateVotes(t.id,A,E),P(A),x(E),R(!1),setSnackbarMessage("点赞数量已更新"),setSnackbarSeverity("success"),setSnackbarOpen(!0)}catch(I){console.error("更新点赞数量失败:",I),setSnackbarMessage(I.message),setSnackbarSeverity("error"),setSnackbarOpen(!0)}finally{C(!1)}};a||t.user_id;const te=I=>{const z=I.target,{naturalWidth:M,naturalHeight:le}=z;m({width:M,height:le}),i(le>M*1.5),L(!0),_(!1)},U=async I=>{I.stopPropagation();try{C(!0);const z=await X.pinImage(t.id);z.success&&o({...t,is_pinned:z.is_pinned})}catch(z){console.error("置顶操作失败:",z)}finally{C(!1)}},re=()=>{V(!0)},he=()=>{V(!1)},ie=I=>{const z=new Date,M=new Date(I),le=Math.floor((z-M)/1e3);if(le<60)return`${le}秒前`;const Ce=Math.floor(le/60);if(Ce<60)return`${Ce}分钟前`;const je=Math.floor(Ce/60);if(je<24)return`${je}小时前`;const xe=Math.floor(je/24);if(xe<30)return`${xe}天前`;const Se=Math.floor(xe/30);return Se<12?`${Se}个月前`:`${Math.floor(Se/12)}年前`};return e.jsxs(po,{sx:{display:"flex",flexDirection:"column",width:"100%",borderRadius:"16px",overflow:"hidden",boxShadow:l?"0 0 0 3px #2563eb, 0 10px 15px -3px rgba(0, 0, 0, 0.1)":"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",opacity:u&&!l?.7:1,backgroundColor:"background.paper",transition:"all 0.3s ease",position:"relative",transform:H&&!u?"translateY(-8px)":"translateY(0)","&:hover":{boxShadow:l?"0 0 0 3px #2563eb, 0 20px 25px -5px rgba(0, 0, 0, 0.1)":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}},onMouseEnter:re,onMouseLeave:he,children:[se&&e.jsx(w,{sx:{position:"absolute",top:"12px",left:"12px",backgroundColor:"primary.main",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.75rem",fontWeight:"600",zIndex:2,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",border:"1.5px solid rgba(255,255,255,0.8)",animation:"pulse 2s infinite"},children:"我的图片"}),e.jsx(w,{sx:{position:"absolute",bottom:"12px",left:"12px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.7rem",fontWeight:"500",zIndex:2,opacity:H?1:0,transform:H?"translateY(0)":"translateY(8px)",transition:"all 0.3s ease"},children:ie(t.created_at)}),e.jsxs(w,{sx:{position:"relative",width:"100%",paddingTop:Z?"140%":"100%",backgroundColor:"rgba(0, 0, 0, 0.05)",borderRadius:"12px 12px 0 0",overflow:"hidden",cursor:u?"default":"pointer"},onClick:()=>!u&&r(t),children:[!k&&!O&&e.jsx(w,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.03)"},children:e.jsx(ye,{size:30,sx:{color:"primary.main"}})}),e.jsx(w,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:S?"none":"auto"},children:e.jsx("img",{src:B,alt:t.title||"图片",onLoad:te,onError:()=>_(!0),className:k?"image-loaded":"image-loading",style:{width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.5s ease-out",transform:H&&!u?"scale(1.05)":"scale(1)"}})}),e.jsx(w,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:H?"linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0.3) 30%, rgba(0,0,0,0) 60%)":"linear-gradient(0deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0) 40%)",opacity:1,transition:"all 0.3s ease"}}),e.jsx(w,{sx:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"16px",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:2},children:a&&S?e.jsxs(w,{sx:{display:"flex",gap:1,width:"100%"},children:[e.jsx(ve,{size:"small",type:"number",value:A,onChange:I=>P(Math.max(0,parseInt(I.target.value)||0)),sx:{width:"70px","& .MuiInputBase-input":{color:"white",fontSize:"0.875rem",padding:"8px 12px"},"& .MuiOutlinedInput-root":{backgroundColor:"rgba(0, 0, 0, 0.4)","& fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused fieldset":{borderColor:"primary.main"}}}}),e.jsx(ve,{size:"small",type:"number",value:E,onChange:I=>x(Math.max(0,parseInt(I.target.value)||0)),sx:{width:"70px","& .MuiInputBase-input":{color:"white",fontSize:"0.875rem",padding:"8px 12px"},"& .MuiOutlinedInput-root":{backgroundColor:"rgba(0, 0, 0, 0.4)","& fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused fieldset":{borderColor:"primary.main"}}}}),e.jsx(N,{size:"small",onClick:I=>{I.stopPropagation(),W()},disabled:p,sx:{color:"success.main",bgcolor:"rgba(0, 0, 0, 0.4)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.6)"}},children:e.jsx(Xe,{})}),e.jsx(N,{size:"small",onClick:I=>{I.stopPropagation(),R(!1),P(t.likes_count||0),x(t.dislikes_count||0)},sx:{color:"error.main",bgcolor:"rgba(0, 0, 0, 0.4)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.6)"}},children:e.jsx(Ot,{})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(N,{size:"small",onClick:y,disabled:p,sx:{color:d===!0?"primary.light":"white",backgroundColor:d===!0?"rgba(37, 99, 235, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:d===!0?"rgba(37, 99, 235, 0.3)":"rgba(0, 0, 0, 0.5)"},width:36,height:36},children:e.jsx(Nt,{sx:{fontSize:"1.2rem"}})}),e.jsx(J,{variant:"caption",sx:{color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:A})]}),e.jsxs(w,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(N,{size:"small",onClick:Y,disabled:p,sx:{color:d===!1?"error.light":"white",backgroundColor:d===!1?"rgba(239, 68, 68, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:d===!1?"rgba(239, 68, 68, 0.3)":"rgba(0, 0, 0, 0.5)"},width:36,height:36},children:e.jsx(Vt,{sx:{fontSize:"1.2rem"}})}),e.jsx(J,{variant:"caption",sx:{color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:E})]})]}),e.jsxs(w,{sx:{display:"flex",gap:1},children:[a&&e.jsx(N,{size:"small",onClick:I=>{I.stopPropagation(),R(!0)},sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"},width:36,height:36,display:{xs:"flex",sm:"flex"}},children:e.jsx(vt,{sx:{fontSize:"1.2rem"}})}),a&&e.jsx(N,{size:"small",onClick:U,disabled:p,sx:{color:t.is_pinned?"warning.light":"white",backgroundColor:t.is_pinned?"rgba(245, 158, 11, 0.2)":"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:t.is_pinned?"rgba(245, 158, 11, 0.3)":"rgba(0, 0, 0, 0.6)"},width:36,height:36},children:e.jsx(Ar,{sx:{fontSize:"1.2rem"}})})]})]})}),a&&!t.is_approved&&e.jsx(w,{sx:{position:"absolute",top:"12px",right:"12px",backgroundColor:"error.main",color:"white",padding:"4px 8px",borderRadius:"8px",fontSize:"0.75rem",fontWeight:"600",zIndex:2,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"待审核"}),u&&e.jsx(Fo,{checked:l,onChange:I=>b(t.id),sx:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",padding:"4px",zIndex:3,"&.Mui-checked":{color:"primary.main"},"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"}}}),H&&!u&&(se||a)&&e.jsxs(w,{sx:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:1,zIndex:3},children:[e.jsx(N,{size:"small",onClick:I=>{I.stopPropagation(),o(t)},sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",color:"text.primary","&:hover":{backgroundColor:"white"},width:36,height:36,boxShadow:2,display:{xs:"flex",sm:"none"}},children:e.jsx(vt,{fontSize:"small"})}),e.jsx(N,{size:"small",onClick:I=>{I.stopPropagation(),ee(!0)},sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",color:"error.main","&:hover":{backgroundColor:"white",color:"error.dark"},width:36,height:36,boxShadow:2},children:e.jsx(Ft,{fontSize:"small"})})]}),e.jsxs(Te,{open:$,onClose:()=>ee(!1),PaperProps:{sx:{borderRadius:3,p:1,boxShadow:3,maxWidth:"400px",width:"90%"}},children:[e.jsx(Ue,{sx:{pb:1,fontWeight:600},children:"确认删除"}),e.jsx(Ne,{children:e.jsx(J,{variant:"body1",children:"确定要删除这张图片吗？此操作无法撤销。"})}),e.jsxs(Ve,{sx:{p:2,pt:1},children:[e.jsx(T,{onClick:()=>ee(!1),variant:"outlined",size:"medium",children:"取消"}),e.jsx(T,{onClick:()=>{ee(!1),s(t.id)},variant:"contained",color:"error",size:"medium",sx:{ml:1},children:"删除"})]})]})]})]})},Ws=({open:t,image:r,onClose:s,images:o,currentIndex:a,onPrevious:l,onNext:u})=>{const[b,f]=n.useState(1),[d,h]=n.useState(!0),[k,L]=n.useState(!0);n.useState(window.innerWidth<=768);const[O,_]=n.useState(null),[A,P]=n.useState(0),[E,x]=n.useState(!1),Z=n.useRef(null),{canShowPrevious:i,canShowNext:g}=n.useMemo(()=>({canShowPrevious:a>0,canShowNext:Array.isArray(o)&&a<o.length-1}),[a,o]),m=()=>{h(!1)},p=()=>{f(y=>Math.min(y+.2,3))},C=()=>{f(y=>Math.max(y-.2,.5))},S=()=>{f(1)},R=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),x(!1)):(document.documentElement.requestFullscreen().catch(y=>{console.error(`Error attempting to enable full-screen mode: ${y.message}`)}),x(!0))},$=y=>{P(y.touches[0].clientX)},ee=y=>{if(!A)return;const Y=y.touches[0].clientX,W=A-Y;W>50?_("left"):W<-50?_("right"):_(null)},H=()=>{O==="left"&&g?u==null||u():O==="right"&&i&&(l==null||l()),P(0),_(null)},V=n.useCallback(y=>{y.key==="ArrowLeft"?l==null||l():y.key==="ArrowRight"?u==null||u():y.key==="Escape"?s==null||s():y.key==="+"||y.key==="="?p():y.key==="-"?C():y.key==="0"?S():y.key==="f"&&R()},[l,u,s]);if(n.useEffect(()=>{if(t)return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[t,V]),n.useEffect(()=>{t&&(f(1),h(!0),x(!1))},[t,r]),n.useEffect(()=>{const y=()=>{x(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",y),()=>document.removeEventListener("fullscreenchange",y)},[]),!t||!r)return null;const B=(r==null?void 0:r.image_url)||(r!=null&&r.image_path?X.storage.from("gallery").getPublicUrl(r.image_path).data.publicUrl:null);if(!B)return null;const se=y=>{if(!y)return"";const Y=new Date(y);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(Y)};return e.jsx(Fr,{open:t,onClose:s,closeAfterTransition:!0,sx:{display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(5px)"},children:e.jsxs(w,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:1300,display:"flex",flexDirection:"column",overflow:"hidden"},onMouseMove:()=>L(!0),onMouseLeave:()=>setTimeout(()=>L(!1),2e3),onClick:()=>L(!0),onTouchStart:$,onTouchMove:ee,onTouchEnd:H,children:[e.jsxs(w,{sx:{position:"absolute",top:0,left:0,right:0,padding:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(10px)",zIndex:5,transform:k?"translateY(0)":"translateY(-100%)",transition:"transform 0.3s ease"},children:[e.jsxs(J,{variant:"subtitle1",sx:{color:"white",fontWeight:600,fontSize:{xs:"0.9rem",sm:"1rem"},opacity:.9},children:[a+1," / ",(o==null?void 0:o.length)||1]}),e.jsxs(w,{sx:{display:"flex",gap:1},children:[e.jsx(N,{onClick:R,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:E?e.jsx(Yt,{}):e.jsx(Lt,{})}),e.jsx(N,{onClick:s,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Ye,{})})]})]}),e.jsxs(w,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},children:[e.jsx(w,{sx:{position:"absolute",top:0,bottom:0,left:0,width:"80px",display:"flex",alignItems:"center",justifyContent:"center",opacity:k&&i?1:0,transition:"opacity 0.3s ease",zIndex:4,cursor:i?"pointer":"default"},onClick:y=>{y.stopPropagation(),i&&(l==null||l())},children:i&&e.jsx(N,{sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)",transform:"scale(1.1)"},width:48,height:48,transition:"all 0.2s ease"},children:e.jsx(We,{fontSize:"large"})})}),e.jsx(w,{sx:{position:"absolute",top:0,bottom:0,right:0,width:"80px",display:"flex",alignItems:"center",justifyContent:"center",opacity:k&&g?1:0,transition:"opacity 0.3s ease",zIndex:4,cursor:g?"pointer":"default"},onClick:y=>{y.stopPropagation(),g&&(u==null||u())},children:g&&e.jsx(N,{sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(8px)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)",transform:"scale(1.1)"},width:48,height:48,transition:"all 0.2s ease"},children:e.jsx(He,{fontSize:"large"})})}),d&&e.jsx(w,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:3},children:e.jsx(ye,{sx:{color:"primary.main"},size:40})}),e.jsx(w,{ref:Z,sx:{width:"100%",height:"100%",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center",padding:2},children:e.jsx("img",{src:B,alt:r.description||"",onLoad:m,style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",objectFit:"contain",transform:`scale(${b})`,transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:d?"none":"block"}})}),O&&e.jsx(w,{sx:{position:"absolute",top:"50%",left:O==="right"?"10%":"auto",right:O==="left"?"10%":"auto",transform:"translateY(-50%)",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)",borderRadius:"50%",width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center",zIndex:3},children:O==="left"?e.jsx(He,{sx:{color:"white",fontSize:30}}):e.jsx(We,{sx:{color:"white",fontSize:30}})})]}),e.jsxs(w,{sx:{position:"absolute",bottom:0,left:0,right:0,padding:"16px",backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(10px)",display:"flex",flexDirection:"column",gap:1,transform:k?"translateY(0)":"translateY(100%)",transition:"transform 0.3s ease",zIndex:5},children:[e.jsxs(J,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.8)",fontSize:"0.8rem"},children:["上传于 ",se(r.created_at)]}),r.description&&e.jsx(J,{variant:"body2",sx:{color:"white",opacity:.9,fontSize:"0.9rem",maxHeight:"60px",overflow:"auto"},children:r.description}),e.jsxs(w,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:2,mt:1},children:[e.jsx(N,{onClick:C,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Et,{})}),e.jsxs(J,{variant:"caption",sx:{color:"white",fontSize:"0.85rem",minWidth:"60px",textAlign:"center"},children:[Math.round(b*100),"%"]}),e.jsx(N,{onClick:p,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Bt,{})}),e.jsx(N,{onClick:S,sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:e.jsx(Wt,{})})]})]})]})})},Hs=({open:t,image:r,onClose:s,onSave:o})=>{const[a,l]=n.useState(""),[u,b]=n.useState("");n.useEffect(()=>{r&&(l(r.title||""),b(r.description||""))},[r]);const f=()=>{o({id:r==null?void 0:r.id,title:a,description:u})};return e.jsxs(Te,{open:t,onClose:s,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Ue,{children:"编辑图片信息"}),e.jsxs(Ne,{children:[e.jsx(ve,{autoFocus:!0,margin:"dense",label:"标题",type:"text",fullWidth:!0,value:a,onChange:d=>l(d.target.value),variant:"outlined",sx:{mb:2}}),e.jsx(ve,{label:"描述",multiline:!0,rows:4,value:u,onChange:d=>b(d.target.value),fullWidth:!0,variant:"outlined"})]}),e.jsxs(Ve,{children:[e.jsx(T,{onClick:s,color:"primary",children:"取消"}),e.jsx(T,{onClick:f,color:"primary",children:"保存"})]})]})},Ts=({open:t,onClose:r,onUpload:s,isAdmin:o})=>{const[a,l]=n.useState([]),[u,b]=n.useState(!1),[f,d]=n.useState({}),[h,k]=n.useState(0),L=n.useRef(null),O=()=>{l([]),d({}),b(!1),k(0)},_=()=>{u||(O(),r())},A=i=>{const m=Array.from(i.target.files).map(p=>({file:p,id:Be(),title:p.name,description:"",preview:null}));m.forEach(p=>{const C=new FileReader;C.onloadend=()=>{l(S=>S.map(R=>R.id===p.id?{...R,preview:C.result}:R))},C.readAsDataURL(p.file)}),l(p=>[...p,...m])},P=i=>{l(g=>g.filter(m=>m.id!==i)),d(g=>{const m={...g};return delete m[i],m})},E=(i,g)=>{l(m=>m.map(p=>p.id===i?{...p,title:g}:p))},x=(i,g)=>{l(m=>m.map(p=>p.id===i?{...p,description:g}:p))},Z=async()=>{if(a.length!==0){b(!0),k(0),a.length;try{if(o&&a.length>1){const i=a.map(C=>C.file),g=a.map(C=>({title:C.title,description:C.description})),m=await s(i,g,(C,S)=>{if(S!==void 0){const R=a[S].id;d($=>({...$,[R]:{status:"uploading",progress:C}})),C===100&&k($=>$+1)}});m.forEach((C,S)=>{const R=a[S].id;C.success?d($=>({...$,[R]:{status:"success",progress:100}})):d($=>({...$,[R]:{status:"error",error:C.error}}))}),m.filter(C=>C.success).length===a.length&&setTimeout(()=>{_()},1e3)}else for(const i of a)try{d(g=>({...g,[i.id]:{status:"uploading",progress:0}})),await s(i.file,{title:i.title,description:i.description},g=>{d(m=>({...m,[i.id]:{status:"uploading",progress:g}}))}),d(g=>({...g,[i.id]:{status:"success",progress:100}})),k(g=>g+1),setTimeout(()=>{_()},1e3)}catch(g){console.error("上传失败:",g),d(m=>({...m,[i.id]:{status:"error",error:g.message}}))}}catch(i){console.error("批量上传失败:",i),a.forEach(g=>{d(m=>({...m,[g.id]:{status:"error",error:i.message}}))})}finally{b(!1)}}};return e.jsxs(Te,{open:t,onClose:_,fullWidth:!0,maxWidth:o?"md":"sm",PaperProps:{sx:{bgcolor:"background.paper",backgroundImage:"none",border:"4px solid #2196f3",boxShadow:"8px 8px 0 rgba(33, 150, 243, 0.3)",borderRadius:0}},children:[e.jsx(Ue,{sx:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"1rem",color:"#2196f3"},children:o?"批量上传测评报告图片":"上传测评报告图片"}),e.jsxs(Ne,{children:[e.jsx(w,{sx:{mb:2,mt:1},children:e.jsxs(T,{variant:"outlined",component:"label",startIcon:e.jsx(Fe,{className:"pixel-icon"}),disabled:u,fullWidth:!0,className:"pixel-button",children:[o?"选择多张图片":"选择图片",e.jsx("input",{ref:L,type:"file",hidden:!0,accept:"image/*",multiple:o,onChange:A,disabled:u})]})}),a.length>0&&e.jsx(w,{sx:{display:"grid",gridTemplateColumns:o?"repeat(auto-fill, minmax(200px, 1fr))":"1fr",gap:2,mb:2},children:a.map(i=>{var g,m,p;return e.jsxs(Pe,{sx:{p:2,position:"relative",bgcolor:"background.paper",backgroundImage:"none",border:"2px solid #2196f3",borderRadius:0,transition:"all 0.3s ease","&:hover":{borderColor:"#64b5f6",transform:"translateY(-2px)"}},children:[i.preview&&e.jsxs(w,{sx:{width:"100%",height:150,mb:1,position:"relative",borderRadius:1,overflow:"hidden"},children:[e.jsx("img",{src:i.preview,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover"}}),f[i.id]&&e.jsxs(w,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},children:[f[i.id].status==="uploading"&&e.jsx(ye,{variant:"determinate",value:f[i.id].progress,size:40}),f[i.id].status==="success"&&e.jsx(Xe,{color:"success",sx:{fontSize:40}}),f[i.id].status==="error"&&e.jsx(Ht,{color:"error",sx:{fontSize:40}})]})]}),e.jsx(ve,{size:"small",label:"标题",value:i.title,onChange:C=>E(i.id,C.target.value),fullWidth:!0,sx:{mb:1,"& .MuiInputLabel-root":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.7rem"},"& .MuiInputBase-input":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.8rem"}},disabled:u||((g=f[i.id])==null?void 0:g.status)==="success"}),e.jsx(ve,{size:"small",label:"描述",value:i.description,onChange:C=>x(i.id,C.target.value),fullWidth:!0,multiline:!0,rows:2,sx:{"& .MuiInputLabel-root":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.7rem"},"& .MuiInputBase-input":{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:"0.8rem"}},disabled:u||((m=f[i.id])==null?void 0:m.status)==="success"}),!u&&((p=f[i.id])==null?void 0:p.status)!=="success"&&e.jsx(N,{size:"small",onClick:()=>P(i.id),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.5)","&:hover":{bgcolor:"rgba(0,0,0,0.7)",animation:"pixelHover 0.5s infinite"}},children:e.jsx(Ye,{sx:{fontSize:"1rem",color:"white"},className:"pixel-icon"})})]},i.id)})})]}),e.jsxs(Ve,{children:[e.jsx(T,{onClick:_,disabled:u,className:"pixel-button",children:"取消"}),e.jsx(T,{onClick:Z,disabled:a.length===0||u||a.every(i=>{var g;return((g=f[i.id])==null?void 0:g.status)==="success"}),variant:"contained",startIcon:u?e.jsx(ye,{size:20}):e.jsx(At,{className:"pixel-icon"}),className:"pixel-button",children:u?`上传中 (${h}/${a.length})`:"上传"})]})]})};class Us extends Rt.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,s){console.error("GalleryApp错误:",r),console.error("错误详情:",s),this.setState({error:r,errorInfo:s})}render(){var r;return this.state.hasError?e.jsxs(w,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#1a1a1a",padding:3,color:"#fff"},children:[e.jsx(J,{variant:"h6",sx:{color:"#ff69b4",marginBottom:2},children:"页面加载出错了"}),e.jsxs(J,{variant:"body1",sx:{marginBottom:2,maxWidth:600,textAlign:"center"},children:["错误信息: ",((r=this.state.error)==null?void 0:r.message)||"未知错误"]}),e.jsx(T,{variant:"contained",onClick:()=>window.location.reload(),sx:{backgroundColor:"#ff69b4","&:hover":{backgroundColor:"#ff8dc3"}},children:"刷新页面"}),!1]}):this.props.children}}function Ns(){const[t,r]=n.useState([]),[s,o]=n.useState(0),[a,l]=n.useState(0),[u]=n.useState(20),[b,f]=n.useState(!0),[d,h]=n.useState(!0);n.useState(null);const[k,L]=n.useState(null),[O,_]=n.useState(!1);n.useState(!1);const[A,P]=n.useState(!1),[E,x]=n.useState(!1),[Z,i]=n.useState(""),[g,m]=n.useState("info"),[p,C]=n.useState(null),[S,R]=n.useState(()=>localStorage.getItem("isAdmin")==="true"),[$,ee]=n.useState("all"),[H,V]=n.useState(new Set),[B,se]=n.useState(!1),[y,Y]=n.useState(!1),[W,te]=n.useState(!1),[U,re]=n.useState(-1),[he,ie]=n.useState(null),I=n.useRef(),z=n.useCallback(c=>{b||y||(I.current&&I.current.disconnect(),I.current=new IntersectionObserver(v=>{v[0].isIntersecting&&d&&l(j=>j+1)}),c&&I.current.observe(c))},[b,y,d]),M=n.useRef(null),le=Re(ke.breakpoints.only("xs")),Ce=Re(ke.breakpoints.only("sm")),je=Re(ke.breakpoints.only("md")),xe=Re(ke.breakpoints.only("lg")),Se=()=>le?1:Ce?2:je?3:xe?4:xe&&window.innerWidth>=1440?5:6,ce=n.useCallback(async(c=!1)=>{if(!p){console.log("等待用户ID初始化...");return}c?Y(!0):(f(!0),r([]));try{const v=a*u;console.log("开始获取图片列表:",{page:a,limit:u,offset:v,filter:$,userId:p});const{data:j,count:D,hasMore:oe}=await X.getImages(u,v);if(!j){console.log("没有获取到图片数据"),c||(r([]),o(0)),h(!1);return}console.log("获取到原始图片数据:",{count:D,dataLength:j==null?void 0:j.length});let K=j||[];$==="approved"?K=K.filter(q=>q.is_approved):$==="pending"&&(K=K.filter(q=>!q.is_approved)),K=K.map(q=>({...q,current_user_id:p})),K.sort((q,ae)=>q.is_pinned&&!ae.is_pinned?-1:!q.is_pinned&&ae.is_pinned?1:q.user_id===p&&ae.user_id!==p?-1:q.user_id!==p&&ae.user_id===p?1:new Date(ae.created_at)-new Date(q.created_at)),console.log("过滤并排序后的图片数据:",{filteredCount:K.length,filter:$,firstImage:K[0]}),r(q=>c?[...q,...K]:K),o(D),h(oe)}catch(v){console.error("获取图片失败:",v),i(`获取图片失败: ${v.message||"未知错误"}`),m("error"),x(!0),c||(r([]),o(0))}finally{c?Y(!1):f(!1)}},[p,a,u,$]);n.useEffect(()=>{M.current=ce},[ce]),n.useEffect(()=>{p&&(l(0),h(!0),ce(!1))},[p,$]),n.useEffect(()=>{a>0&&ce(!0)},[a]);const qt=()=>{const c=prompt("请输入管理员密码：");c==="Sangok#3"?(R(!0),localStorage.setItem("isAdmin","true"),i("管理员登录成功！"),x(!0)):c!==null&&(i("密码错误！"),x(!0))},ut=()=>{R(!1),localStorage.removeItem("isAdmin"),i("已退出管理员模式！"),x(!0)};n.useEffect(()=>{var c;try{console.log("开始初始化用户ID...");let v=(c=document.cookie.match(/userId=([^;]+)/))==null?void 0:c[1],j;const D=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;if(v){let oe=v;oe.startsWith("user_")&&(console.log("移除 'user_' 前缀:",oe),oe=oe.substring(5)),D.test(oe)?(j=oe,console.log("使用cookie中的有效UUID:",j)):(console.log("Cookie中的UUID格式无效，生成新的UUID"),j=Be())}else console.log("Cookie中未找到UUID，生成新的UUID"),j=Be();document.cookie=`userId=${j};path=/;max-age=31536000;SameSite=Lax`,console.log("设置用户ID:",j),C(j)}catch(v){console.error("初始化用户ID失败:",v),i("初始化用户ID失败，请刷新页面重试"),x(!0)}},[]),n.useCallback(async(c,v)=>{try{await X.approveImage(c,v),i(`图片已${v?"通过审核":"取消审核"}`),x(!0),M.current&&M.current()}catch(j){console.error("审核图片失败:",j),i(`审核失败: ${j.message}`),x(!0)}},[]);const Gt=n.useCallback(async(c,v,j)=>{try{if(S&&Array.isArray(c)){console.log("开始批量上传:",{fileCount:c.length,metadata:v});const D=await X.uploadImages(c,p,v,j);console.log("批量上传结果:",D);const oe=D.filter(ae=>ae.success).length,K=D.length-oe;let q;return K>0?(q=`上传完成：${oe}张成功，${K}张失败`,console.error("部分图片上传失败:",D.filter(ae=>!ae.success))):q="所有图片上传成功！",i(q),x(!0),M.current&&M.current(),D}else{const D=await X.uploadImage(c,p,v,j);return i("图片上传成功！"),x(!0),M.current&&M.current(),D}}catch(D){throw console.error("上传图片失败:",D),i(`上传失败: ${D.message}`),x(!0),D}},[S,p]),Qt=n.useCallback(async c=>{if(window.confirm("确定要删除这张图片吗？此操作无法撤销。"))try{await X.deleteImage(c,p,S),i("图片已删除"),x(!0),window.location.reload()}catch(v){console.error("删除图片失败:",v),i(`删除失败: ${v.message}`),x(!0)}},[p,S]),Zt=c=>{if(!(c!=null&&c.id)||!(t!=null&&t.length))return;const v=t.findIndex(j=>j.id===c.id);console.log("Opening image:",{imageId:c.id,index:v,totalImages:t.length,imagesArray:t.map(j=>j.id)}),v!==-1&&(re(v),ie(c))},Xt=c=>{if("is_pinned"in c){r(v=>v.map(j=>j.id===c.id?{...j,is_pinned:c.is_pinned}:j)),i(c.is_pinned?"已置顶":"已取消置顶"),m("success"),x(!0),ce();return}L(c),P(!0)},Jt=n.useCallback(async c=>{try{const{id:v,title:j,description:D}=c;await X.updateImageInfo(v,p,{title:j,description:D},S),i("图片信息已更新"),x(!0),P(!1),M.current&&M.current()}catch(v){console.error("更新图片信息失败:",v),i(`更新失败: ${v.message}`),x(!0)}},[p,S]),Kt=n.useCallback(c=>{V(v=>{const j=new Set(v);return j.has(c)?j.delete(c):j.add(c),j})},[]),er=n.useCallback(()=>{H.size===t.length?V(new Set):V(new Set(t.map(c=>c.id)))},[t,H.size]),tr=async()=>{const c=Array.from(H);if(c.length===0){i("请先选择要删除的图片"),m("warning"),x(!0);return}f(!0);try{const{successful:v,failed:j}=await X.deleteImages(c,p);let D="";v>0&&j===0?(D=`成功删除 ${v} 张图片`,m("success")):v>0&&j>0?(D=`${v} 张图片删除成功，${j} 张删除失败`,m("warning")):(D="删除失败",m("error")),i(D),x(!0),V(new Set),window.location.reload()}catch(v){console.error("批量删除失败:",v),i("批量删除失败: "+(v.message||"未知错误")),m("error"),x(!0)}finally{f(!1)}},rr=n.useCallback(async()=>{if(window.confirm("确定要清空所有图片吗？此操作无法撤销。"))try{f(!0);const c=await Promise.allSettled(t.map(D=>X.deleteImage(D.id,p,S))),v=c.filter(D=>D.status==="fulfilled").length,j=c.filter(D=>D.status==="rejected").length;i(`清空完成：${v}张成功，${j}张失败`),x(!0),window.location.reload()}catch(c){console.error("清空图片失败:",c),i(`清空图片失败: ${c.message}`),x(!0)}finally{f(!1)}},[t,p,S]),or=n.useCallback(()=>{if(t!=null&&t.length&&U>0){const c=U-1;console.log("Moving to previous image:",{newIndex:c,currentIndex:U,totalImages:t.length}),re(c),ie(t[c])}},[U,t]),sr=n.useCallback(()=>{if(t!=null&&t.length&&U<t.length-1){const c=U+1;console.log("Moving to next image:",{newIndex:c,currentIndex:U,totalImages:t.length}),re(c),ie(t[c])}},[U,t]),ar=n.useCallback(()=>{ie(null),re(-1)},[]),nr=n.useCallback(()=>{_(!1),l(0),ce(!1)},[ce]);return e.jsx(Us,{children:e.jsxs(jr,{theme:ke,children:[e.jsx(Lo,{}),e.jsxs(w,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(Sr,{position:"sticky",sx:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(8px)",borderBottom:"1px solid rgba(229, 231, 235, 0.8)",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.05)",marginBottom:"2rem"},elevation:0,children:e.jsx(gt,{maxWidth:"lg",children:e.jsxs(kr,{sx:{justifyContent:"space-between",py:1},children:[e.jsxs(w,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ze,{sx:{color:"primary.main",mr:1.5,fontSize:{xs:24,sm:28}}}),e.jsx(J,{variant:"h6",sx:{color:"text.primary",fontWeight:700,fontSize:{xs:"1.1rem",sm:"1.3rem"},backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"M-Profile Lab"})]}),e.jsxs(w,{sx:{display:{xs:"none",md:"flex"},gap:1.5,"& .MuiButton-root":{borderRadius:"8px",minWidth:"auto",px:2,py:.75,transition:"all 0.2s ease"}},children:[S&&e.jsx(T,{color:"error",variant:"outlined",startIcon:e.jsx(bt,{}),onClick:ut,size:"small",sx:{fontWeight:500},children:"退出管理"}),e.jsx(T,{color:"primary",variant:"text",startIcon:e.jsx(Ct,{}),href:"./female.html",size:"small",children:"女M版"}),e.jsx(T,{color:"primary",variant:"text",startIcon:e.jsx(jt,{}),href:"./male.html",size:"small",children:"男M版"}),e.jsx(T,{color:"primary",variant:"text",startIcon:e.jsx(ze,{}),href:"./s.html",size:"small",children:"S版"}),e.jsx(T,{color:"primary",variant:"text",startIcon:e.jsx(yt,{}),href:"./message.html",size:"small",children:"留言板"}),e.jsx(T,{color:"primary",variant:"contained",startIcon:e.jsx(mt,{}),href:"./index.html",size:"small",sx:{boxShadow:1,"&:hover":{boxShadow:2}},children:"返回首页"})]}),e.jsx(N,{sx:{display:{xs:"flex",md:"none"},color:"primary.main",backgroundColor:"rgba(249, 115, 22, 0.05)","&:hover":{backgroundColor:"rgba(249, 115, 22, 0.1)"},width:40,height:40},onClick:()=>te(!0),children:e.jsx(wr,{})})]})})}),e.jsxs(Ir,{anchor:"right",open:W,onClose:()=>te(!1),PaperProps:{sx:{backgroundColor:"#ffffff",width:280,boxShadow:"-4px 0 15px rgba(0, 0, 0, 0.05)",pt:2,"& .MuiListItem-root":{borderRadius:1.5,mx:2,mb:1}}},children:[e.jsxs(w,{sx:{px:3,pb:2,display:"flex",alignItems:"center"},children:[e.jsx(ze,{sx:{color:"primary.main",mr:1.5}}),e.jsx(J,{variant:"h6",sx:{fontWeight:700,backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"M-Profile Lab"})]}),e.jsx(Dr,{sx:{mb:2}}),e.jsxs(Mr,{children:[S&&e.jsxs(ge,{button:!0,onClick:ut,sx:{backgroundColor:"rgba(239, 68, 68, 0.08)","&:hover":{backgroundColor:"rgba(239, 68, 68, 0.15)"}},children:[e.jsx(me,{children:e.jsx(bt,{sx:{color:"error.main"}})}),e.jsx(be,{primary:"退出管理",primaryTypographyProps:{fontWeight:500,color:"error.main"}})]}),e.jsxs(ge,{button:!0,component:"a",href:"./female.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(me,{children:e.jsx(Ct,{sx:{color:"primary.main"}})}),e.jsx(be,{primary:"女M版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(ge,{button:!0,component:"a",href:"./male.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(me,{children:e.jsx(jt,{sx:{color:"primary.main"}})}),e.jsx(be,{primary:"男M版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(ge,{button:!0,component:"a",href:"./s.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(me,{children:e.jsx(ze,{sx:{color:"primary.main"}})}),e.jsx(be,{primary:"S版",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(ge,{button:!0,component:"a",href:"./message.html",sx:{"&:hover":{backgroundColor:"rgba(249, 115, 22, 0.08)"}},children:[e.jsx(me,{children:e.jsx(yt,{sx:{color:"primary.main"}})}),e.jsx(be,{primary:"留言板",primaryTypographyProps:{fontWeight:500}})]}),e.jsxs(ge,{button:!0,component:"a",href:"./index.html",sx:{backgroundColor:"rgba(249, 115, 22, 0.08)","&:hover":{backgroundColor:"rgba(249, 115, 22, 0.15)"},mt:2},children:[e.jsx(me,{children:e.jsx(mt,{sx:{color:"primary.main"}})}),e.jsx(be,{primary:"返回首页",primaryTypographyProps:{fontWeight:500}})]})]})]}),e.jsxs(gt,{maxWidth:"xl",sx:{px:{xs:2,sm:3,md:4},pt:4},children:[e.jsxs(w,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",mb:6},className:"fade-in",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
                  .force-orange-title {
                    color: #f97316 !important;
                    text-shadow: 0 0 15px rgba(249, 115, 22, 0.5), 2px 2px 0 rgba(249, 115, 22, 0.3) !important;
                    font-weight: 800 !important;
                    animation: float-title 3s ease-in-out infinite !important;
                  }
                  
                  @keyframes float-title {
                    0% { transform: translateY(0); }
                    50% { transform: translateY(-10px); }
                    100% { transform: translateY(0); }
                  }
                `}}),e.jsx(J,{variant:"h2",component:"h1",className:"pixel-title-orange force-orange-title",sx:{fontSize:{xs:"2rem",sm:"2.5rem",md:"3rem"},textAlign:"center",mb:2,color:"#f97316 !important",textShadow:"0 0 15px rgba(249, 115, 22, 0.5), 2px 2px 0 rgba(249, 115, 22, 0.3)",background:"transparent",WebkitTextFillColor:"#f97316",filter:"drop-shadow(0 0 8px rgba(249, 115, 22, 0.5))",position:"relative",animation:"float 3s ease-in-out infinite","@keyframes float":{"0%":{transform:"translateY(0)"},"50%":{transform:"translateY(-10px)"},"100%":{transform:"translateY(0)"}}},onDoubleClick:qt,children:"Report Gallery"}),e.jsx(J,{variant:"body1",color:"text.secondary",sx:{maxWidth:"600px",textAlign:"center",mb:4,fontSize:{xs:"0.9rem",sm:"1rem"}},children:"浏览、分享和点评各种测评报告，记录你的测评经历"}),e.jsxs(w,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:2,mb:4,width:"100%",maxWidth:"800px"},children:[e.jsx(T,{variant:"contained",startIcon:e.jsx(Fe,{}),onClick:()=>_(!0),size:"large",sx:{px:3,py:1.5,fontSize:"1rem",fontWeight:600,boxShadow:3,"&:hover":{boxShadow:4},backgroundImage:"linear-gradient(45deg, #f97316, #f59e0b)"},children:"上传图片"}),S&&e.jsx(T,{variant:B?"contained":"outlined",color:B?"secondary":"primary",startIcon:B?e.jsx(Ye,{}):e.jsx(Tt,{}),onClick:()=>{se(!B),V(new Set)},size:"large",sx:{px:3,py:1.5,fontSize:"1rem",backgroundColor:B?"rgba(245, 158, 11, 0.9)":"transparent"},children:B?"退出选择":"选择图片"})]}),S&&B&&e.jsxs(w,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:2,mb:4,className:"fade-in"},children:[e.jsx(T,{variant:"outlined",color:"primary",onClick:er,size:"medium",children:H.size===t.length?"取消全选":"全选"}),e.jsxs(T,{variant:"contained",color:"error",startIcon:e.jsx(Ft,{}),onClick:tr,disabled:H.size===0,size:"medium",children:["删除选中 (",H.size,")"]}),e.jsx(T,{variant:"outlined",color:"error",startIcon:e.jsx(Ut,{}),onClick:rr,size:"medium",children:"清空图片"})]}),S&&e.jsxs(_r,{size:"small",sx:{width:{xs:"100%",sm:"auto"},minWidth:150,mt:B?0:2,"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"background.paper",boxShadow:1,borderColor:"primary.main"}},children:[e.jsx($r,{children:"筛选图片"}),e.jsxs(zr,{value:$,label:"筛选图片",onChange:c=>ee(c.target.value),children:[e.jsx(Oe,{value:"all",children:"全部图片"}),e.jsx(Oe,{value:"approved",children:"已审核"}),e.jsx(Oe,{value:"pending",children:"待审核"})]})]})]}),b?e.jsx(w,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(ye,{color:"primary"})}):t&&t.length>0?e.jsx(w,{sx:{width:"100%",minHeight:400},children:e.jsx(js,{columns:Se(),spacing:3,sx:{width:"auto"},children:t.map((c,v)=>e.jsx("div",{ref:v===t.length-1?z:null,children:e.jsx(Bs,{image:c,onView:Zt,onDelete:Qt,onEdit:Xt,isAdmin:S,isSelected:H.has(c.id),isSelectionMode:B,onSelect:()=>Kt(c.id),userId:p})},c.id))})}):e.jsxs(Pe,{sx:{p:4,textAlign:"center",backgroundColor:"background.paper",borderRadius:2},children:[e.jsx(Lr,{sx:{fontSize:40,color:"primary.main",mb:2}}),e.jsx(J,{variant:"h6",sx:{mb:2},children:"暂无图片"}),e.jsx(J,{variant:"body1",sx:{mb:3,color:"text.secondary"},children:$!=="all"?"当前筛选条件下没有找到图片":"目前还没有上传的测评报告图片，快来分享你的测评结果吧！"}),e.jsx(T,{variant:"contained",startIcon:e.jsx(Fe,{}),onClick:()=>_(!0),color:"primary",children:"上传图片"})]}),y&&e.jsx(w,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(ye,{color:"primary"})}),e.jsx(Ts,{open:O,onClose:nr,onUpload:Gt,isAdmin:S}),e.jsx(Ws,{open:!!he,image:he,onClose:ar,images:t,currentIndex:U,onPrevious:or,onNext:sr}),e.jsx(Hs,{open:A,image:k,onClose:()=>P(!1),onSave:Jt}),e.jsx(Rr,{open:E,autoHideDuration:5e3,onClose:()=>x(!1),children:e.jsx(ao,{onClose:()=>x(!1),severity:g,variant:"filled",children:Z})})]})]})]})})}Pr.createRoot(document.getElementById("root")).render(e.jsx(Rt.StrictMode,{children:e.jsx(Ns,{})}));
